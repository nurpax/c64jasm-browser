{"version":3,"sources":["Disasm.module.css","CloseButton.module.css","App.module.css","Editor.module.css","../node_modules/import-fresh sync","Editor.tsx","editing.ts","Disasm.tsx","DiagnosticsList.tsx","CloseButton.tsx","Help.tsx","App.tsx","index.tsx","Help.module.css","DiagnosticsList.module.css"],"names":["module","exports","heading","layoutContainer","disasmContainer","buttonContainer","close","navContainer","appTitle","editorContainer","textarea","textareaHighlightOverlay","textareaHighlightRow","textareaHighlightRowCurrent","highlightError","gutter","gutterRow","gutterRowSelected","webpackEmptyContext","req","e","Error","code","keys","resolve","id","tabLength","computeColumn","line","charIndex","col","i","length","ErrorSpans","props","lineLength","text","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","undefined","_step2","_iterator2","Symbol","iterator","next","done","value","err","buf","Array","fill","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","errors","start","column","end","x","rled","values","cur","out","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","v","push","count","groupSame","spans","span","react_default","a","createElement","key","style","display","className","styles","repeat","react","Highlighter","React","forwardRef","ref","rows","startRow","numRows","selected","currentLine","lineToErrors","get","textLines","cn","Gutter","str","concat","numStr","numTextRows","padStart","_default","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","editorLineHeight","numEditorCharRows","textareaRef","createRef","gutterRef","highlighterRef","handleScroll","scrollTop","nativeEvent","target","setState","handleSourceChanged","onSourceChanged","split","updateCursorState","current","r","selectionStart","selectionEnd","loc","source","charOffset","lines","offset","findLine","handleSelect","handleKeyDown","handleKeyUp","handleMouseDown","yoffs","offsetY","state","Math","min","floor","cssVarLineHeight","getComputedStyle","document","documentElement","getPropertyValue","match","_wrapRegExp","height","exec","parseInt","groups","cssNumLines","indentTextarea","watch","spellcheck","focus","prevProps","prevState","errorCharOffset","setSelectionRange","vscroll","lineToErrorsMap","Map","diagnostics","forEach","_ref2","lst","has","set","startCharRow","textContainer","onMouseDown","wrap","onKeyUp","onKeyDown","onSelect","onScroll","onChange","Component","disassembly","join","Diagnostic","itemRef","snapshot","scrollIntoView","behavior","block","_this2","_this$props$error","error","msg","selectedClass","diagItem","onClick","onClickItem","index","DiagnosticsList","handleOnClickItem","idx","_this3","_this4","diags","diagnosticsBox","map","d","DiagnosticsList_Diagnostic","JSON","stringify","selectedIndex","CloseButton","title","href","preventDefault","onClose","modalRoot","getElementById","Modal","el","appendChild","removeChild","ReactDOM","createPortal","children","AsmBlock","asm","s","trim","slice","trimLineFeeds","HelpContents","helpContents","maxWidth","headingContainer","closeButtonContainer","HelpModal","visible","Help_Modal","helpModalContainer","hidden","circleReveal","Help_HelpContents","config","useWebWorkers","Emoji","aria-label","role","emoji","App","assemblerWorker","sourceCode","diagnosticsIndex","helpVisible","handleWorkerMessage","data","shiftKey","max","handleOnClickDiagnostic","debouncedCompile","fn","delay","timeoutID","_len","arguments","args","_key","clearTimeout","window","setTimeout","apply","debounce","asmArgs","postMessage","handleSetSource","options","readFileSync","fname","res","assemble","disassemble","prg","handleClearDiagnosticsSelectionOnKey","handleClearDiagnosticsSelectionOnMouse","handleClickHelp","handleCloseHelp","addEventListener","Worker","editorErrorLoc","findCharOffset","onMouseUp","Editor_default","Disasm_default","DiagnosticsList_DiagnosticsList","Help","render","src_App","emph","circle"],"mappings":"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","file":"static/js/main.d25d520f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"Disasm_heading__2ZRjL\",\"layoutContainer\":\"Disasm_layoutContainer__36ehI\",\"disasmContainer\":\"Disasm_disasmContainer__2QplX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttonContainer\":\"CloseButton_buttonContainer__28ZWo\",\"close\":\"CloseButton_close__1cumB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navContainer\":\"App_navContainer__32B3M\",\"appTitle\":\"App_appTitle__2SEQk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"Editor_heading__3jsuC\",\"layoutContainer\":\"Editor_layoutContainer__2bFri\",\"editorContainer\":\"Editor_editorContainer__1wXnR\",\"textarea\":\"Editor_textarea__28EdL\",\"textareaHighlightOverlay\":\"Editor_textareaHighlightOverlay__1opTU\",\"textareaHighlightRow\":\"Editor_textareaHighlightRow__1R6Ia\",\"textareaHighlightRowCurrent\":\"Editor_textareaHighlightRowCurrent__25KL2\",\"highlightError\":\"Editor_highlightError__1YeA5\",\"gutter\":\"Editor_gutter__3CDcX\",\"gutterRow\":\"Editor_gutterRow__1DNMN\",\"gutterRowSelected\":\"Editor_gutterRowSelected__3GiGf\"};","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 51;","\nimport React, { Fragment } from 'react';\nimport indentTextarea from 'indent-textarea';\nimport cn from 'classnames';\n\nimport { findLine } from './editing';\nimport { SourceLoc } from 'c64jasm';\nimport styles from './Editor.module.css';\n\nconst tabLength = 4;\n\n// RLE compress a list of T's\nfunction groupSame<T>(values: T[]): { count: number, code: T }[] {\n  let cur = undefined;\n  let out = [];\n\n  for (let v of values) {\n      // Start new run\n      if (cur !== v) {\n          cur = v;\n          out.push({code: cur, count: 1});\n      } else {\n          // Keep growing current group\n          out[out.length-1].count++;\n      }\n  }\n  return out;\n}\n\n// Count the actual screen char column offset\n// based on a character index and the source code\n// line contents.\nfunction computeColumn(line: string, charIndex: number) {\n  let col = 0;\n  for (let i = 0; i < charIndex; i++) {\n    if (line.length < i) {\n      return undefined;\n    }\n    if (line[i] === '\\t') {\n      col += tabLength;\n    } else {\n      col++;\n    }\n  }\n  return col;\n}\n\n// This function can return null if it can't find the diagnostic\n// column from the source code.  This can happen if the\n// diagnostics are matched on a different version of diagnostics\n// vs. source code.  This can happen as the compiler\n// runs in a separate thread while text editing happens\n// in the main thread without syncing to compiler\n// results.\nfunction ErrorSpans(props: {\n  text: string,\n  errors: SourceLoc[]\n}) {\n  let lineLength = 0;\n  if (!props.text) {\n    return null;\n  }\n  for (let c of props.text) {\n    if (c === '\\t') {\n      lineLength += tabLength;\n    } else {\n      lineLength++;\n    }\n  }\n  const buf: boolean[] = Array(lineLength).fill(false);\n\n  for (const err of props.errors) {\n    const start = computeColumn(props.text, err.start.column - 1);\n    if (start === undefined) {\n      return null;\n    }\n    const end = err.start.line === err.end.line ? computeColumn(props.text, err.end.column - 1) : start + 1;\n    if (end === undefined) {\n      return null;\n    }\n    for (let x = start; x < end; x++) {\n      buf[x] = true;\n    }\n  }\n  const rled = groupSame(buf);\n  const spans = [];\n  for (let i = 0; i < rled.length; i++) {\n    const span = rled[i];\n    if (!span.code) {\n      spans.push(<pre key={i} style={{display: 'inline-block'}}>{' '.repeat(span.count)}</pre>);\n    } else {\n      spans.push(<pre key={i} style={{display: 'inline-block'}} className={styles.highlightError}>{' '.repeat(span.count)}</pre>);\n    }\n  }\n  return <Fragment>{spans}</Fragment>;\n}\n\ninterface HighlighterProps {\n  startRow: number;\n  numRows: number;\n  currentLine: number | undefined;\n  textLines: string[];\n  lineToErrors: Map<number, SourceLoc[]>;\n}\n\nconst Highlighter = React.forwardRef((props: HighlighterProps, ref: React.Ref<HTMLDivElement>) => {\n  const rows = [];\n  // Pad rows is required for smooth scrolling (so that there is overflow-y to scroll)\n  const padRows = 2;\n  for (let i = props.startRow; i < props.startRow + props.numRows + padRows; i++) {\n    const selected = i === props.currentLine && styles.textareaHighlightRowCurrent;\n    const errors = props.lineToErrors.get(i);\n    if (errors) {\n      const text = props.textLines[i];\n      rows.push(<div className={cn(styles.textareaHighlightRow, selected)} key={i}><ErrorSpans text={text} errors={errors} /></div>);\n    } else {\n      rows.push(<div className={cn(styles.textareaHighlightRow, selected)} key={i}></div>);\n    }\n  }\n  return (\n    <div ref={ref} className={styles.textareaHighlightOverlay}>\n      {rows}\n    </div>\n  );\n})\n\ninterface GutterProps {\n  startRow: number;\n  numRows: number;\n  numTextRows: number;\n  currentLine: number | undefined;\n}\n\nconst Gutter = React.forwardRef((props: GutterProps, ref: React.Ref<HTMLDivElement>) => {\n  const rows = [];\n  const padRows = 2;\n  for (let i = props.startRow; i < props.startRow + props.numRows + padRows; i++) {\n    const str = `${i+1}`;\n    const selected = i === props.currentLine && styles.gutterRowSelected;\n    const numStr = (i >= 0 && i < props.numTextRows) ? str.padStart(4, ' ') : '';\n    rows.push(<div className={cn(styles.gutterRow, selected)} key={i}>{numStr}</div>);\n  }\n  return (\n    <div ref={ref} className={styles.gutter}>\n      {rows}\n    </div>\n  );\n});\n\ninterface EditorProps {\n  onSourceChanged: (text: string) => void;\n  diagnostics: { loc: SourceLoc, msg: string }[];\n  errorCharOffset: number | undefined;\n}\n\ninterface EditorState {\n  scrollTop: number;\n  currentLine: number | undefined;\n  textLines: string[];\n}\n\nexport default class extends React.Component<EditorProps, EditorState> {\n\n  private editorLineHeight = 0;\n  private numEditorCharRows = 0;\n\n  constructor (props: EditorProps) {\n    super(props);\n\n    this.state = {\n      scrollTop: 0,\n      currentLine: undefined,\n      textLines: []\n    }\n\n    const cssVarLineHeight = getComputedStyle(document.documentElement).getPropertyValue('--code-window-line-height');\n    let match = /^[ ]*(?<height>[0-9]+)px$/.exec(cssVarLineHeight);\n    if (!match) {\n      throw new Error('failed querying css var --code-window-line-height' + cssVarLineHeight);\n    }\n    this.editorLineHeight = parseInt((match as any).groups.height);\n    const cssNumLines = getComputedStyle(document.documentElement).getPropertyValue('--code-window-num-lines');\n    match = /^[ ]*(?<lines>[0-9]+)$/.exec(cssNumLines);\n    if (!match) {\n      throw new Error('failed querying css var --code-window-num-lines');\n    }\n    this.numEditorCharRows = parseInt((match as any).groups.lines);\n  }\n\n  textareaRef = React.createRef<HTMLTextAreaElement>();\n  gutterRef = React.createRef<HTMLDivElement>();\n  highlighterRef = React.createRef<HTMLDivElement>();\n\n  handleScroll = (e: React.UIEvent<HTMLTextAreaElement>) => {\n    const { scrollTop } = e.nativeEvent.target as any;\n    this.setState({ scrollTop })\n  }\n\n  handleSourceChanged = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.props.onSourceChanged(e.target.value);\n    this.setState({\n      textLines: e.target.value.split('\\n')\n    })\n  }\n\n  updateCursorState = () => {\n    if (this.textareaRef && this.textareaRef.current) {\n      const r = this.textareaRef.current;\n      if (r.selectionStart === r.selectionEnd) {\n        const loc = r.selectionStart;\n        const line = findLine(this.textareaRef.current.value, loc);\n        this.setState({ currentLine: line });\n      } else {\n        this.setState({ currentLine: undefined });\n      }\n    }\n  }\n\n  // Update cursor position when keys are pressed or selection changes on mouse click\n  handleSelect = (e: React.SyntheticEvent<HTMLTextAreaElement>) => {\n    this.updateCursorState();\n  }\n  handleKeyDown = (e: React.KeyboardEvent) => {\n    this.updateCursorState();\n  }\n  handleKeyUp = (e: React.KeyboardEvent) => {\n    this.updateCursorState();\n  }\n\n  componentDidMount () {\n    if (this.textareaRef && this.textareaRef.current) {\n      indentTextarea.watch(this.textareaRef.current);\n      this.textareaRef.current.spellcheck = false;\n      this.textareaRef.current.focus();\n    }\n  }\n\n  componentDidUpdate (prevProps: EditorProps, prevState: EditorState) {\n    if (this.textareaRef && this.textareaRef.current) {\n      if (this.props.errorCharOffset !== undefined) {\n        this.textareaRef.current.focus();\n        this.textareaRef.current.setSelectionRange(this.props.errorCharOffset, this.props.errorCharOffset);\n      }\n    }\n\n    if (prevState.scrollTop !== this.state.scrollTop) {\n      const scrollTop = this.state.scrollTop;\n      const vscroll = scrollTop % this.editorLineHeight;\n      if (this.gutterRef && this.gutterRef.current) {\n        this.gutterRef.current.scrollTop = vscroll;\n      }\n      if (this.highlighterRef && this.highlighterRef.current) {\n        this.highlighterRef.current.scrollTop = vscroll;\n      }\n    }\n  }\n\n  handleMouseDown = (e: React.MouseEvent) => {\n    if (this.textareaRef && this.textareaRef.current) {\n      const yoffs = e.nativeEvent.offsetY + this.state.scrollTop;\n      this.setState({\n        currentLine: Math.min(this.state.textLines.length - 1, Math.floor(yoffs / this.editorLineHeight))\n      });\n    }\n  }\n\n  render () {\n    const lineToErrorsMap = new Map<number, SourceLoc[]>();\n    this.props.diagnostics.forEach(({loc}) => {\n      const line = loc.start.line - 1;\n      const lst = lineToErrorsMap.has(line) ? lineToErrorsMap.get(line)! : [];\n      lst.push(loc);\n      lineToErrorsMap.set(line, lst);\n    })\n    const startCharRow = Math.floor(this.state.scrollTop / this.editorLineHeight);\n    return (\n      <div className={styles.layoutContainer}>\n        <div className={styles.heading}>Assembly</div>\n        <div className={styles.editorContainer}>\n          <Gutter\n            ref={this.gutterRef}\n            startRow={startCharRow}\n            numRows={this.numEditorCharRows}\n            numTextRows={this.state.textLines.length}\n            currentLine={this.state.currentLine}\n          />\n          <div className={styles.textContainer} onMouseDown={this.handleMouseDown}>\n            <Highlighter\n              ref={this.highlighterRef}\n              startRow={startCharRow}\n              numRows={this.numEditorCharRows}\n              currentLine={this.state.currentLine}\n              textLines={this.state.textLines}\n              lineToErrors={lineToErrorsMap}\n            />\n            <textarea\n              wrap='off'\n              onKeyUp={this.handleKeyUp}\n              onKeyDown={this.handleKeyDown}\n              onSelect={this.handleSelect}\n              onScroll={this.handleScroll}\n              ref={this.textareaRef}\n              onChange={this.handleSourceChanged} className={styles.textarea}></textarea>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","\nimport { SourceLoc } from 'c64jasm';\n\nexport function findCharOffset(source: string, loc: SourceLoc) {\n  const lines = source.split('\\n');\n  let offset = 0;\n  for (let i = 0; i < loc.start.line - 1; i++) {\n    offset += lines[i].length + 1;\n  }\n  return offset + loc.start.column - 1;\n}\n\nexport function findLine(source: string, charOffset: number) {\n  const lines = source.split('\\n');\n  let offset = 0;\n  for (let i = 0; i < lines.length; i++) {\n    offset += lines[i].length + 1;\n    if (charOffset < offset) {\n        return i;\n    }\n  }\n  return undefined;\n}\n","\nimport React from 'react';\n\nimport styles from './Disasm.module.css'\n\ninterface DisasmProps {\n  disassembly: string[];\n}\n\nexport default class extends React.Component<DisasmProps> {\n  render () {\n    return (\n      <div className={styles.layoutContainer}>\n        <div className={styles.heading}>Disassembly</div>\n        <div className={styles.disasmContainer}>\n            <pre>{this.props.disassembly.join('\\n')}</pre>\n        </div>\n      </div>\n    )\n  }\n}\n","\nimport React from 'react'\n\nimport { SourceLoc } from 'c64jasm';\n\nimport { Diag } from './types'\n\nimport styles from './DiagnosticsList.module.css'\n\ninterface DiagnosticProps {\n  error: { loc: SourceLoc, msg: string };\n  index: number;\n  selected: boolean;\n  onClickItem: (idx: number) => void;\n}\n\nclass Diagnostic extends React.Component<DiagnosticProps> {\n  itemRef = React.createRef<HTMLDivElement>();\n\n  componentDidUpdate (prevProps: DiagnosticProps, prevState: {}, snapshot: DiagnosticProps) {\n    if (this.itemRef && this.itemRef.current && this.props.selected) {\n      this.itemRef.current.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center'\n      })\n    }\n  }\n\n  render() {\n    const { loc, msg } = this.props.error;\n    const selectedClass = this.props.selected ? ` ${styles.selected}` : '';\n    return (\n      <div\n        ref={this.itemRef}\n        className={`${styles.diagItem}${selectedClass}`}\n        onClick={() => this.props.onClickItem(this.props.index)}\n      >\n        <span className={`${styles.error}${selectedClass}`}>main.asm:{loc.start.line}:{loc.start.column}: error:</span> {msg}\n      </div>\n    )\n  }\n}\n\ninterface DiagnosticsListProps {\n  diagnostics: Diag[];\n  selectedIndex: number | undefined;\n  onClickItem: (idx: number) => void;\n}\n\nexport default class DiagnosticsList extends React.Component<DiagnosticsListProps> {\n  handleOnClickItem = (idx: number) => {\n    this.props.onClickItem(idx);\n  }\n\n  render() {\n    const diags = this.props.diagnostics;\n    return (\n      <div className={styles.layoutContainer}>\n        <div className={styles.heading}>Diagnostics</div>\n        <div className={styles.diagnostics}>\n          <div className={styles.diagnosticsBox}>\n            {diags.map((d: Diag, idx) => {\n              return (\n                <Diagnostic\n                  key={JSON.stringify(d.loc)}\n                  index={idx}\n                  error={d} selected={idx === this.props.selectedIndex}\n                  onClickItem={this.handleOnClickItem}\n                />\n              )\n            })}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","import React from 'react';\n\nimport styles from './CloseButton.module.css';\n\nexport default function CloseButton(props: { onClose: () => void}) {\n  return (\n    <div className={styles.buttonContainer}>\n      <a title='Close Help' href='/' target='_blank' className={styles.close} onClick={e => {\n          e.preventDefault();\n          props.onClose();\n        }}>\n      </a>\n    </div>\n  );\n}\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport cn from 'classnames';\n\nimport CloseButton from './CloseButton'\nimport styles from './Help.module.css';\n\nconst modalRoot = document.getElementById('modal-root')!;\n\ninterface ModalProps {\n  children: JSX.Element;\n}\n\nclass Modal extends React.Component {\n  private el: HTMLDivElement;\n\n  constructor(props: ModalProps) {\n    super(props);\n    this.el = document.createElement('div');\n  }\n\n  componentDidMount() {\n    // The portal element is inserted in the DOM tree after\n    // the Modal's children are mounted, meaning that children\n    // will be mounted on a detached DOM node. If a child\n    // component requires to be attached to the DOM tree\n    // immediately when mounted, for example to measure a\n    // DOM node, or uses 'autoFocus' in a descendant, add\n    // state to Modal and only render the children when Modal\n    // is inserted in the DOM tree.\n    modalRoot.appendChild(this.el);\n  }\n\n  componentWillUnmount() {\n    modalRoot.removeChild(this.el);\n  }\n\n  render() {\n    return ReactDOM.createPortal(\n      this.props.children,\n      this.el,\n    );\n  }\n}\n\n// Remove leading and trailing line feeds from a string.\n// This is to prevent unnecessary line feeds in\n// assembly code written in string literals.\nfunction trimLineFeeds(str: string): string {\n  const lines = str.split('\\n');\n  let s;\n  for (s = 0; s < lines.length; s++) {\n    const line = lines[s].trim();\n    if (line.length !== 0) {\n      break;\n    }\n  }\n  let e;\n  for (e = lines.length - 1; e >= 0; e--) {\n    const line = lines[e].trim();\n    if (line.length !== 0) {\n      break;\n    }\n  }\n  return lines.slice(s, e + 1).join('\\n');\n}\n\nfunction AsmBlock(props: { text: string }) {\n  return (\n    <pre className={styles.asm}>{trimLineFeeds(props.text)}</pre>\n  )\n}\nclass HelpContents extends React.Component<{onClose: () => void}> {\n  render () {\n    return (\n      <div className={cn(styles.helpContents, styles.maxWidth)}>\n        <div className={styles.headingContainer}>\n          <div className={styles.closeButtonContainer}>\n            <CloseButton onClose={this.props.onClose} />\n          </div>\n          <h1>c64jasm online </h1>\n        </div>\n        <p>\n          <a href='https://nurpax.github.io/c64jasm/'>c64jasm</a> is a 6502 assembler written in JavaScript.\n          You can run it either on the command line using Node or link it into a web app.\n        </p>\n        <p>\n          <a href='https://nurpax.github.io/c64jasm-browser/'>c64jasm online</a> is an interactive assembler demo site\n          where you can write 6502 assembly with live error reporting and disassembly.\n        </p>\n\n        <h3>Examples</h3>\n\n        <p>Simple instructions and expressions:</p>\n        <AsmBlock text={`\n    lda #2+2  ; expression in an immediate field\n    sta $d020 ; set border color\n        `} />\n\n        <p>Labels:</p>\n        <AsmBlock text={`\nentry: {\n    jsr func\n\n    ldx #8\nloop: ; label local to 'entry' scope\n    dex\n    bpl loop\n}\n\nfunc: {\n    ldx #7\nloop: ; label local to 'func' scope\n    sta buf, x   ; store to buf\n    dex\n    bpl loop\n    rts\n\nbuf: !fill 8, 0    ; 8 byte array\n}\n        `} />\n\n        <p>Declaring and using variables:</p>\n        <AsmBlock text={`\n!let num_sprites = 4\n!let sprite_mask = (1<<num_sprites)-1\n\n    lda #sprite_mask\n    sta $d015 ; enable sprites 0-3\n        `} />\n\n        <p>Conditional compilation and repetition:</p>\n        <AsmBlock text={`\n!let num_sprites = 4\n    lda #13  ; ptr to sprite data 1 (==address/64)\n    lda #14  ; ptr to sprite data 2\n\n!for i in range(num_sprites) {\n    !if (i < 2) {\n        sta $07f8+i   ; sprite data 1 from A\n    } else {\n        stx $07f8+i   ; sprite data 2 from X\n    }\n}\n        `} />\n\n        <p>Define and use macro macro:</p>\n        <AsmBlock text={`\n!macro set_border(color) {\n    lda #color\n    sta $d020\n}\n\n+set_border(13)  ; expand\n        `} />\n\n      </div>\n    )\n  }\n}\n\ninterface HelpProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nclass HelpModal extends React.Component<HelpProps> {\n  render () {\n    const { visible } = this.props;\n    return (\n      <Modal>\n        <div className={cn(visible ? styles.helpModalContainer : styles.hidden)}>\n          <div className={styles.circleReveal}>\n            <HelpContents onClose={this.props.onClose}/>\n          </div>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default HelpModal;\n","import React from 'react';\n\nimport { assemble, disassemble } from 'c64jasm';\n\nimport { Diag } from './types'\nimport { findCharOffset }  from './editing'\n\nimport Editor from './Editor';\nimport Disasm from './Disasm';\nimport DiagnosticsList from './DiagnosticsList';\nimport Help from './Help'\n\nimport styles from './App.module.css';\n\nexport function debounce<F extends (...params: any[]) => void>(fn: F, delay: number) {\n  let timeoutID: number|undefined = undefined;\n  return function(this: any, ...args: any[]) {\n    clearTimeout(timeoutID);\n    timeoutID = window.setTimeout(() => fn.apply(this, args), delay);\n  } as F;\n}\n\nconst config = { useWebWorkers: true };\n\nfunction Emoji(props: {emoji: string}) {\n  return <span aria-label='emoji' role='img'>{props.emoji}</span>\n}\n\ninterface AppState {\n  sourceCode: string;\n  disassembly: string[];\n  diagnosticsIndex: number | undefined;\n  diagnostics: Diag[];\n  helpVisible: boolean;\n};\n\nclass App extends React.Component<{}, AppState> {\n\n  assemblerWorker: Worker | undefined = undefined;\n\n  state = {\n    sourceCode: '',\n    disassembly: [],\n    diagnosticsIndex: 0,\n    diagnostics: [],\n    helpVisible: false\n  }\n\n  componentDidMount () {\n    document.addEventListener('keydown', this.handleKeyDown);\n\n    this.assemblerWorker = new Worker('worker.js');\n    if (this.assemblerWorker !== null) {\n      this.assemblerWorker.addEventListener('message', (msg: MessageEvent) => {\n        this.handleWorkerMessage(msg);\n      });\n    }\n  }\n\n  handleWorkerMessage = (e: any) => {\n    if (e.data.diagnostics.length === 0) {\n      this.setState({\n        disassembly: e.data.disassembly,\n        diagnostics: e.data.diagnostics,\n      });\n    } else {\n      this.setState({\n        diagnostics: e.data.diagnostics,\n      });\n    }\n  };\n\n  handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'F4') {\n      this.setState((prevState) => {\n        if (prevState.diagnostics.length === 0) {\n          return { diagnosticsIndex: 0 };\n        }\n        if (prevState.diagnosticsIndex === undefined) {\n          return { diagnosticsIndex: 0 };\n        }\n        if (e.shiftKey) {\n          return {\n            diagnosticsIndex: Math.max(0, prevState.diagnosticsIndex - 1)\n          }\n        } else {\n          return {\n            diagnosticsIndex: Math.min(prevState.diagnostics.length - 1, prevState.diagnosticsIndex + 1)\n          }\n        }\n      })\n      e.preventDefault();\n    }\n    if (e.key === 'Escape') {\n      // Clear focus from diagnostics list and\n      // exit help if it happens to be visible.\n      this.setState({\n        diagnosticsIndex: undefined,\n        helpVisible: false\n      });\n      e.preventDefault();\n    }\n  }\n\n  handleOnClickDiagnostic = (idx: number) => {\n    this.setState({\n      diagnosticsIndex: idx\n    })\n  }\n\n  debouncedCompile = debounce((asmArgs: any) => {\n    if (config.useWebWorkers && this.assemblerWorker) {\n      this.assemblerWorker.postMessage(asmArgs);\n    }\n  }, 250);\n\n  handleSetSource = (text: string) => {\n    if (config.useWebWorkers && this.assemblerWorker) {\n      //this.assemblerWorker.postMessage({ source: text });\n      this.debouncedCompile({ source: text });\n      this.setState({\n        sourceCode: text,\n        diagnosticsIndex: undefined\n      })\n    } else {\n      const options = {\n        readFileSync: (fname: string) => text\n      }\n      const res = assemble(\"foo.asm\", options);\n      if (res.errors.length === 0) {\n        this.setState({\n          sourceCode: text,\n          disassembly: disassemble(res.prg),\n          diagnostics: [],\n          diagnosticsIndex: undefined\n        });\n      } else {\n        this.setState({\n          sourceCode: text,\n          diagnostics: res.errors,\n          diagnosticsIndex: undefined\n        })\n      }\n    }\n  }\n\n  // If typing in the editor, clear any diagnostics selection\n  handleClearDiagnosticsSelectionOnKey = (e: React.KeyboardEvent) => {\n    if (e.key === 'F4' || e.key === 'Shift') {\n      return;\n    }\n    if (this.state.diagnosticsIndex !== undefined) {\n      this.setState({ diagnosticsIndex: undefined });\n    }\n  }\n\n  // If typing in the editor, clear any diagnostics selection\n  handleClearDiagnosticsSelectionOnMouse = (e: React.MouseEvent) => {\n    if (this.state.diagnosticsIndex !== undefined) {\n      this.setState({ diagnosticsIndex: undefined });\n    }\n  }\n\n  handleClickHelp = (e: React.MouseEvent) => {\n    e.preventDefault();\n    this.setState({ helpVisible: true });\n  }\n\n  handleCloseHelp = () => {\n    this.setState({ helpVisible: false });\n  }\n\n  render () {\n    const diags: Diag[] = this.state.diagnostics;\n    let editorErrorLoc = undefined;\n    if (diags.length !== 0 && this.state.diagnosticsIndex !== undefined) {\n      const d = diags[this.state.diagnosticsIndex];\n      editorErrorLoc = findCharOffset(this.state.sourceCode, d.loc);\n    }\n    return (\n      <div id='root'>\n        <nav id=\"mainNav\">\n          <div className={styles.navContainer}>\n            <div className={styles.appTitle}><a href='https://nurpax.github.io/c64jasm/'>c64jasm</a> online</div>\n            <p>A little experimental 6502 assembler for the C64</p>\n            <p><Emoji emoji='ðŸ‘‰' /> <a onClick={this.handleClickHelp} href='/' target='_blank'>help</a></p>\n            <p><Emoji emoji='ðŸ‘‰' /> <a href='https://github.com/nurpax/c64jasm-browser'>source code</a></p>\n          </div>\n        </nav>\n        <div\n          onKeyDown={this.handleClearDiagnosticsSelectionOnKey}\n          onMouseDown={this.handleClearDiagnosticsSelectionOnMouse}\n          onMouseUp={this.handleClearDiagnosticsSelectionOnMouse}\n          id=\"mainCode\"\n        >\n          <Editor\n            onSourceChanged={this.handleSetSource}\n            diagnostics={this.state.diagnostics}\n            errorCharOffset={editorErrorLoc}\n          />\n        </div>\n        <div id=\"siteDisasm\">\n          <Disasm disassembly={this.state.disassembly} />\n        </div>\n        <div id=\"mainDiag\">\n          <DiagnosticsList\n            onClickItem={this.handleOnClickDiagnostic}\n            diagnostics={this.state.diagnostics}\n            selectedIndex={this.state.diagnosticsIndex} />\n        </div>\n        <Help visible={this.state.helpVisible} onClose={this.handleCloseHelp} />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('viewport_root'));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"helpModalContainer\":\"Help_helpModalContainer__10bLm\",\"helpContents\":\"Help_helpContents__3Cbr8\",\"headingContainer\":\"Help_headingContainer__jN87w\",\"emph\":\"Help_emph__29_7I\",\"hidden\":\"Help_hidden__2fGZK\",\"circleReveal\":\"Help_circleReveal__2igbG\",\"circle\":\"Help_circle__2jpkq\",\"maxWidth\":\"Help_maxWidth__3MUy2\",\"closeButtonContainer\":\"Help_closeButtonContainer__1TIMT\",\"asm\":\"Help_asm__1yYjY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layoutContainer\":\"DiagnosticsList_layoutContainer__3Yxfa\",\"diagnostics\":\"DiagnosticsList_diagnostics__U_t5K\",\"heading\":\"DiagnosticsList_heading__f0lgX\",\"diagnosticsBox\":\"DiagnosticsList_diagnosticsBox__NbaZi\",\"diagItem\":\"DiagnosticsList_diagItem__3otDW\",\"selected\":\"DiagnosticsList_selected__jbDsD\",\"error\":\"DiagnosticsList_error__1cDSO\"};"],"sourceRoot":""}