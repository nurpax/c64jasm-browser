!function(t){var n={};function r(e){if(n[e])return n[e].exports;var l=n[e]={i:e,l:!1,exports:{}};return t[e].call(l.exports,l,l.exports,r),l.l=!0,l.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var l in t)r.d(e,l,function(n){return t[n]}.bind(null,l));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=8)}([function(t,n,r){(function(t){function r(t,n){for(var r=0,e=t.length-1;e>=0;e--){var l=t[e];"."===l?t.splice(e,1):".."===l?(t.splice(e,1),r++):r&&(t.splice(e,1),r--)}if(n)for(;r--;r)t.unshift("..");return t}function e(t,n){if(t.filter)return t.filter(n);for(var r=[],e=0;e<t.length;e++)n(t[e],e,t)&&r.push(t[e]);return r}n.resolve=function(){for(var n="",l=!1,i=arguments.length-1;i>=-1&&!l;i--){var o=i>=0?arguments[i]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(n=o+"/"+n,l="/"===o.charAt(0))}return(l?"/":"")+(n=r(e(n.split("/"),function(t){return!!t}),!l).join("/"))||"."},n.normalize=function(t){var i=n.isAbsolute(t),o="/"===l(t,-1);return(t=r(e(t.split("/"),function(t){return!!t}),!i).join("/"))||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(e(t,function(t,n){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,r){function e(t){for(var n=0;n<t.length&&""===t[n];n++);for(var r=t.length-1;r>=0&&""===t[r];r--);return n>r?[]:t.slice(n,r-n+1)}t=n.resolve(t).substr(1),r=n.resolve(r).substr(1);for(var l=e(t.split("/")),i=e(r.split("/")),o=Math.min(l.length,i.length),s=o,u=0;u<o;u++)if(l[u]!==i[u]){s=u;break}var a=[];for(u=s;u<l.length;u++)a.push("..");return(a=a.concat(i.slice(s))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var n=t.charCodeAt(0),r=47===n,e=-1,l=!0,i=t.length-1;i>=1;--i)if(47===(n=t.charCodeAt(i))){if(!l){e=i;break}}else l=!1;return-1===e?r?"/":".":r&&1===e?"/":t.slice(0,e)},n.basename=function(t,n){var r=function(t){"string"!=typeof t&&(t+="");var n,r=0,e=-1,l=!0;for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!l){r=n+1;break}}else-1===e&&(l=!1,e=n+1);return-1===e?"":t.slice(r,e)}(t);return n&&r.substr(-1*n.length)===n&&(r=r.substr(0,r.length-n.length)),r},n.extname=function(t){"string"!=typeof t&&(t+="");for(var n=-1,r=0,e=-1,l=!0,i=0,o=t.length-1;o>=0;--o){var s=t.charCodeAt(o);if(47!==s)-1===e&&(l=!1,e=o+1),46===s?-1===n?n=o:1!==i&&(i=1):-1!==n&&(i=-1);else if(!l){r=o+1;break}}return-1===n||-1===e||0===i||1===i&&n===e-1&&n===r+1?"":t.slice(n,e)};var l="b"==="ab".substr(-1)?function(t,n,r){return t.substr(n,r)}:function(t,n,r){return n<0&&(n=t.length+n),t.substr(n,r)}}).call(this,r(3))},function(t,n,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var e=r(10),l=r(11),i=r(12);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,n){if(o()<n)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=u.prototype:(null===t&&(t=new u(n)),t.length=n),t}function u(t,n,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,n,r);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return a(this,t,n,r)}function a(t,n,r,e){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?function(t,n,r,e){if(n.byteLength,r<0||n.byteLength<r)throw new RangeError("'offset' is out of bounds");if(n.byteLength<r+(e||0))throw new RangeError("'length' is out of bounds");n=void 0===r&&void 0===e?new Uint8Array(n):void 0===e?new Uint8Array(n,r):new Uint8Array(n,r,e);u.TYPED_ARRAY_SUPPORT?(t=n).__proto__=u.prototype:t=f(t,n);return t}(t,n,r,e):"string"==typeof n?function(t,n,r){"string"==typeof r&&""!==r||(r="utf8");if(!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var e=0|p(n,r),l=(t=s(t,e)).write(n,r);l!==e&&(t=t.slice(0,l));return t}(t,n,r):function(t,n){if(u.isBuffer(n)){var r=0|d(n.length);return 0===(t=s(t,r)).length?t:(n.copy(t,0,0,r),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||(e=n.length)!=e?s(t,0):f(t,n);if("Buffer"===n.type&&i(n.data))return f(t,n.data)}var e;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,n)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,n){if(c(n),t=s(t,n<0?0:0|d(n)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<n;++r)t[r]=0;return t}function f(t,n){var r=n.length<0?0:0|d(n.length);t=s(t,r);for(var e=0;e<r;e+=1)t[e]=255&n[e];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,n){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var e=!1;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return z(t).length;default:if(e)return Y(t).length;n=(""+n).toLowerCase(),e=!0}}function m(t,n,r){var e=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(n>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return B(this,n,r);case"utf8":case"utf-8":return P(this,n,r);case"ascii":return T(this,n,r);case"latin1":case"binary":return $(this,n,r);case"base64":return C(this,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,n,r);default:if(e)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),e=!0}}function g(t,n,r){var e=t[n];t[n]=t[r],t[r]=e}function y(t,n,r,e,l){if(0===t.length)return-1;if("string"==typeof r?(e=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=l?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(l)return-1;r=t.length-1}else if(r<0){if(!l)return-1;r=0}if("string"==typeof n&&(n=u.from(n,e)),u.isBuffer(n))return 0===n.length?-1:v(t,n,r,e,l);if("number"==typeof n)return n&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?l?Uint8Array.prototype.indexOf.call(t,n,r):Uint8Array.prototype.lastIndexOf.call(t,n,r):v(t,[n],r,e,l);throw new TypeError("val must be string, number or Buffer")}function v(t,n,r,e,l){var i,o=1,s=t.length,u=n.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(t.length<2||n.length<2)return-1;o=2,s/=2,u/=2,r/=2}function a(t,n){return 1===o?t[n]:t.readUInt16BE(n*o)}if(l){var c=-1;for(i=r;i<s;i++)if(a(t,i)===a(n,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===u)return c*o}else-1!==c&&(i-=i-c),c=-1}else for(r+u>s&&(r=s-u),i=r;i>=0;i--){for(var h=!0,f=0;f<u;f++)if(a(t,i+f)!==a(n,f)){h=!1;break}if(h)return i}return-1}function b(t,n,r,e){r=Number(r)||0;var l=t.length-r;e?(e=Number(e))>l&&(e=l):e=l;var i=n.length;if(i%2!=0)throw new TypeError("Invalid hex string");e>i/2&&(e=i/2);for(var o=0;o<e;++o){var s=parseInt(n.substr(2*o,2),16);if(isNaN(s))return o;t[r+o]=s}return o}function w(t,n,r,e){return N(Y(n,t.length-r),t,r,e)}function A(t,n,r,e){return N(function(t){for(var n=[],r=0;r<t.length;++r)n.push(255&t.charCodeAt(r));return n}(n),t,r,e)}function S(t,n,r,e){return A(t,n,r,e)}function E(t,n,r,e){return N(z(n),t,r,e)}function k(t,n,r,e){return N(function(t,n){for(var r,e,l,i=[],o=0;o<t.length&&!((n-=2)<0);++o)r=t.charCodeAt(o),e=r>>8,l=r%256,i.push(l),i.push(e);return i}(n,t.length-r),t,r,e)}function C(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function P(t,n,r){r=Math.min(t.length,r);for(var e=[],l=n;l<r;){var i,o,s,u,a=t[l],c=null,h=a>239?4:a>223?3:a>191?2:1;if(l+h<=r)switch(h){case 1:a<128&&(c=a);break;case 2:128==(192&(i=t[l+1]))&&(u=(31&a)<<6|63&i)>127&&(c=u);break;case 3:i=t[l+1],o=t[l+2],128==(192&i)&&128==(192&o)&&(u=(15&a)<<12|(63&i)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:i=t[l+1],o=t[l+2],s=t[l+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&(u=(15&a)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,e.push(c>>>10&1023|55296),c=56320|1023&c),e.push(c),l+=h}return function(t){var n=t.length;if(n<=x)return String.fromCharCode.apply(String,t);var r="",e=0;for(;e<n;)r+=String.fromCharCode.apply(String,t.slice(e,e+=x));return r}(e)}n.Buffer=u,n.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},n.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),n.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,n,r){return a(null,t,n,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,n,r){return function(t,n,r,e){return c(n),n<=0?s(t,n):void 0!==r?"string"==typeof e?s(t,n).fill(r,e):s(t,n).fill(r):s(t,n)}(null,t,n,r)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,n){if(!u.isBuffer(t)||!u.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var r=t.length,e=n.length,l=0,i=Math.min(r,e);l<i;++l)if(t[l]!==n[l]){r=t[l],e=n[l];break}return r<e?-1:e<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,n){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var r;if(void 0===n)for(n=0,r=0;r<t.length;++r)n+=t[r].length;var e=u.allocUnsafe(n),l=0;for(r=0;r<t.length;++r){var o=t[r];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(e,l),l+=o.length}return e},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)g(this,n,n+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)g(this,n,n+3),g(this,n+1,n+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)g(this,n,n+7),g(this,n+1,n+6),g(this,n+2,n+5),g(this,n+3,n+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",r=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,n,r,e,l){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===r&&(r=t?t.length:0),void 0===e&&(e=0),void 0===l&&(l=this.length),n<0||r>t.length||e<0||l>this.length)throw new RangeError("out of range index");if(e>=l&&n>=r)return 0;if(e>=l)return-1;if(n>=r)return 1;if(this===t)return 0;for(var i=(l>>>=0)-(e>>>=0),o=(r>>>=0)-(n>>>=0),s=Math.min(i,o),a=this.slice(e,l),c=t.slice(n,r),h=0;h<s;++h)if(a[h]!==c[h]){i=a[h],o=c[h];break}return i<o?-1:o<i?1:0},u.prototype.includes=function(t,n,r){return-1!==this.indexOf(t,n,r)},u.prototype.indexOf=function(t,n,r){return y(this,t,n,r,!0)},u.prototype.lastIndexOf=function(t,n,r){return y(this,t,n,r,!1)},u.prototype.write=function(t,n,r,e){if(void 0===n)e="utf8",r=this.length,n=0;else if(void 0===r&&"string"==typeof n)e=n,r=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(r)?(r|=0,void 0===e&&(e="utf8")):(e=r,r=void 0)}var l=this.length-n;if((void 0===r||r>l)&&(r=l),t.length>0&&(r<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");e||(e="utf8");for(var i=!1;;)switch(e){case"hex":return b(this,t,n,r);case"utf8":case"utf-8":return w(this,t,n,r);case"ascii":return A(this,t,n,r);case"latin1":case"binary":return S(this,t,n,r);case"base64":return E(this,t,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function T(t,n,r){var e="";r=Math.min(t.length,r);for(var l=n;l<r;++l)e+=String.fromCharCode(127&t[l]);return e}function $(t,n,r){var e="";r=Math.min(t.length,r);for(var l=n;l<r;++l)e+=String.fromCharCode(t[l]);return e}function B(t,n,r){var e=t.length;(!n||n<0)&&(n=0),(!r||r<0||r>e)&&(r=e);for(var l="",i=n;i<r;++i)l+=D(t[i]);return l}function L(t,n,r){for(var e=t.slice(n,r),l="",i=0;i<e.length;i+=2)l+=String.fromCharCode(e[i]+256*e[i+1]);return l}function _(t,n,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+n>r)throw new RangeError("Trying to access beyond buffer length")}function I(t,n,r,e,l,i){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>l||n<i)throw new RangeError('"value" argument is out of bounds');if(r+e>t.length)throw new RangeError("Index out of range")}function R(t,n,r,e){n<0&&(n=65535+n+1);for(var l=0,i=Math.min(t.length-r,2);l<i;++l)t[r+l]=(n&255<<8*(e?l:1-l))>>>8*(e?l:1-l)}function O(t,n,r,e){n<0&&(n=4294967295+n+1);for(var l=0,i=Math.min(t.length-r,4);l<i;++l)t[r+l]=n>>>8*(e?l:3-l)&255}function M(t,n,r,e,l,i){if(r+e>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(t,n,r,e,i){return i||M(t,0,r,4),l.write(t,n,r,e,23,4),r+4}function U(t,n,r,e,i){return i||M(t,0,r,8),l.write(t,n,r,e,52,8),r+8}u.prototype.slice=function(t,n){var r,e=this.length;if((t=~~t)<0?(t+=e)<0&&(t=0):t>e&&(t=e),(n=void 0===n?e:~~n)<0?(n+=e)<0&&(n=0):n>e&&(n=e),n<t&&(n=t),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,n)).__proto__=u.prototype;else{var l=n-t;r=new u(l,void 0);for(var i=0;i<l;++i)r[i]=this[i+t]}return r},u.prototype.readUIntLE=function(t,n,r){t|=0,n|=0,r||_(t,n,this.length);for(var e=this[t],l=1,i=0;++i<n&&(l*=256);)e+=this[t+i]*l;return e},u.prototype.readUIntBE=function(t,n,r){t|=0,n|=0,r||_(t,n,this.length);for(var e=this[t+--n],l=1;n>0&&(l*=256);)e+=this[t+--n]*l;return e},u.prototype.readUInt8=function(t,n){return n||_(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,n){return n||_(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,n){return n||_(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,n){return n||_(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,n){return n||_(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,n,r){t|=0,n|=0,r||_(t,n,this.length);for(var e=this[t],l=1,i=0;++i<n&&(l*=256);)e+=this[t+i]*l;return e>=(l*=128)&&(e-=Math.pow(2,8*n)),e},u.prototype.readIntBE=function(t,n,r){t|=0,n|=0,r||_(t,n,this.length);for(var e=n,l=1,i=this[t+--e];e>0&&(l*=256);)i+=this[t+--e]*l;return i>=(l*=128)&&(i-=Math.pow(2,8*n)),i},u.prototype.readInt8=function(t,n){return n||_(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,n){n||_(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,n){n||_(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,n){return n||_(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,n){return n||_(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,n){return n||_(t,4,this.length),l.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,n){return n||_(t,4,this.length),l.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,n){return n||_(t,8,this.length),l.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,n){return n||_(t,8,this.length),l.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,n,r,e){(t=+t,n|=0,r|=0,e)||I(this,t,n,r,Math.pow(2,8*r)-1,0);var l=1,i=0;for(this[n]=255&t;++i<r&&(l*=256);)this[n+i]=t/l&255;return n+r},u.prototype.writeUIntBE=function(t,n,r,e){(t=+t,n|=0,r|=0,e)||I(this,t,n,r,Math.pow(2,8*r)-1,0);var l=r-1,i=1;for(this[n+l]=255&t;--l>=0&&(i*=256);)this[n+l]=t/i&255;return n+r},u.prototype.writeUInt8=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},u.prototype.writeUInt16LE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):R(this,t,n,!0),n+2},u.prototype.writeUInt16BE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):R(this,t,n,!1),n+2},u.prototype.writeUInt32LE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):O(this,t,n,!0),n+4},u.prototype.writeUInt32BE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):O(this,t,n,!1),n+4},u.prototype.writeIntLE=function(t,n,r,e){if(t=+t,n|=0,!e){var l=Math.pow(2,8*r-1);I(this,t,n,r,l-1,-l)}var i=0,o=1,s=0;for(this[n]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[n+i-1]&&(s=1),this[n+i]=(t/o>>0)-s&255;return n+r},u.prototype.writeIntBE=function(t,n,r,e){if(t=+t,n|=0,!e){var l=Math.pow(2,8*r-1);I(this,t,n,r,l-1,-l)}var i=r-1,o=1,s=0;for(this[n+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[n+i+1]&&(s=1),this[n+i]=(t/o>>0)-s&255;return n+r},u.prototype.writeInt8=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},u.prototype.writeInt16LE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):R(this,t,n,!0),n+2},u.prototype.writeInt16BE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):R(this,t,n,!1),n+2},u.prototype.writeInt32LE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):O(this,t,n,!0),n+4},u.prototype.writeInt32BE=function(t,n,r){return t=+t,n|=0,r||I(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):O(this,t,n,!1),n+4},u.prototype.writeFloatLE=function(t,n,r){return F(this,t,n,!0,r)},u.prototype.writeFloatBE=function(t,n,r){return F(this,t,n,!1,r)},u.prototype.writeDoubleLE=function(t,n,r){return U(this,t,n,!0,r)},u.prototype.writeDoubleBE=function(t,n,r){return U(this,t,n,!1,r)},u.prototype.copy=function(t,n,r,e){if(r||(r=0),e||0===e||(e=this.length),n>=t.length&&(n=t.length),n||(n=0),e>0&&e<r&&(e=r),e===r)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),t.length-n<e-r&&(e=t.length-n+r);var l,i=e-r;if(this===t&&r<n&&n<e)for(l=i-1;l>=0;--l)t[l+n]=this[l+r];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(l=0;l<i;++l)t[l+n]=this[l+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),n);return i},u.prototype.fill=function(t,n,r,e){if("string"==typeof t){if("string"==typeof n?(e=n,n=0,r=this.length):"string"==typeof r&&(e=r,r=this.length),1===t.length){var l=t.charCodeAt(0);l<256&&(t=l)}if(void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<r)throw new RangeError("Out of range index");if(r<=n)return this;var i;if(n>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=n;i<r;++i)this[i]=t;else{var o=u.isBuffer(t)?t:Y(new u(t,e).toString()),s=o.length;for(i=0;i<r-n;++i)this[i+n]=o[i%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function D(t){return t<16?"0"+t.toString(16):t.toString(16)}function Y(t,n){var r;n=n||1/0;for(var e=t.length,l=null,i=[],o=0;o<e;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!l){if(r>56319){(n-=3)>-1&&i.push(239,191,189);continue}if(o+1===e){(n-=3)>-1&&i.push(239,191,189);continue}l=r;continue}if(r<56320){(n-=3)>-1&&i.push(239,191,189),l=r;continue}r=65536+(l-55296<<10|r-56320)}else l&&(n-=3)>-1&&i.push(239,191,189);if(l=null,r<128){if((n-=1)<0)break;i.push(r)}else if(r<2048){if((n-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((n-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function z(t){return e.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function N(t,n,r,e){for(var l=0;l<e&&!(l+r>=n.length||l>=t.length);++l)n[l+r]=t[l];return l}}).call(this,r(9))},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.disassemble=n.platformC64=n.assemble=void 0;var e=r(13);Object.defineProperty(n,"assemble",{enumerable:!0,get:function(){return e.assemble}}),Object.defineProperty(n,"platformC64",{enumerable:!0,get:function(){return e.platformC64}});var l=r(25);Object.defineProperty(n,"disassemble",{enumerable:!0,get:function(){return l.disassemble}})},function(t,n){var r,e,l=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var u,a=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?a=u.concat(a):h=-1,a.length&&d())}function d(){if(!c){var t=s(f);c=!0;for(var n=a.length;n;){for(u=a,a=[];++h<n;)u&&u[h].run();h=-1,n=a.length}u=null,c=!1,function(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function m(){}l.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];a.push(new p(t,n)),1!==a.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=m,l.addListener=m,l.once=m,l.off=m,l.removeListener=m,l.removeAllListeners=m,l.emit=m,l.prependListener=m,l.prependOnceListener=m,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=16384,l=32768;function i(t,n){return t|n<<8}function o(t,n){return t|n<<8|e}function s(t,n){return t|n<<8|e|l}const u={ADC:[i(105,2),i(101,3),i(117,4),null,i(109,4),o(125,4),o(121,4),null,i(97,6),o(113,5),null,null],AND:[i(41,2),i(37,3),i(53,4),null,i(45,4),o(61,4),o(57,4),null,i(33,6),o(49,5),null,null],ASL:[null,i(6,5),i(22,6),null,i(14,6),i(30,7),null,null,null,null,i(10,2),null],BIT:[null,i(36,3),null,null,i(44,4),null,null,null,null,null,null,null],BPL:[null,null,null,null,null,null,null,null,null,null,null,s(16,2)],BMI:[null,null,null,null,null,null,null,null,null,null,null,s(48,2)],BVC:[null,null,null,null,null,null,null,null,null,null,null,s(80,2)],BVS:[null,null,null,null,null,null,null,null,null,null,null,s(112,2)],BCC:[null,null,null,null,null,null,null,null,null,null,null,s(144,2)],BCS:[null,null,null,null,null,null,null,null,null,null,null,s(176,2)],BNE:[null,null,null,null,null,null,null,null,null,null,null,s(208,2)],BEQ:[null,null,null,null,null,null,null,null,null,null,null,s(240,2)],BRK:[null,null,null,null,null,null,null,null,null,null,i(0,7),null],CMP:[i(201,2),i(197,3),i(213,4),null,i(205,4),o(221,4),o(217,4),null,i(193,6),o(209,5),null,null],CPX:[i(224,2),i(228,3),null,null,i(236,4),null,null,null,null,null,null,null],CPY:[i(192,2),i(196,3),null,null,i(204,4),null,null,null,null,null,null,null],DEC:[null,i(198,5),i(214,6),null,i(206,6),i(222,7),null,null,null,null,null,null],EOR:[i(73,2),i(69,3),i(85,4),null,i(77,4),o(93,4),o(89,4),null,i(65,6),o(81,5),null,null],CLC:[null,null,null,null,null,null,null,null,null,null,i(24,2),null],SEC:[null,null,null,null,null,null,null,null,null,null,i(56,2),null],CLI:[null,null,null,null,null,null,null,null,null,null,i(88,2),null],SEI:[null,null,null,null,null,null,null,null,null,null,i(120,2),null],CLV:[null,null,null,null,null,null,null,null,null,null,i(184,2),null],CLD:[null,null,null,null,null,null,null,null,null,null,i(216,2),null],SED:[null,null,null,null,null,null,null,null,null,null,i(248,2),null],INC:[null,i(230,5),i(246,6),null,i(238,6),i(254,7),null,null,null,null,null,null],JMP:[null,null,null,null,i(76,3),null,null,i(108,5),null,null,null,null],JSR:[null,null,null,null,i(32,6),null,null,null,null,null,null,null],LDA:[i(169,2),i(165,3),i(181,4),null,i(173,4),o(189,4),o(185,4),null,i(161,6),o(177,5),null,null],LDX:[i(162,2),i(166,3),null,i(182,4),i(174,4),null,o(190,4),null,null,null,null,null],LDY:[i(160,2),i(164,3),i(180,4),null,i(172,4),o(188,4),null,null,null,null,null,null],LSR:[null,i(70,5),i(86,6),null,i(78,6),i(94,7),null,null,null,null,i(74,2),null],NOP:[null,null,null,null,null,null,null,null,null,null,i(234,2),null],ORA:[i(9,2),i(5,3),i(21,4),null,i(13,4),o(29,4),o(25,4),null,i(1,6),o(17,5),null,null],TAX:[null,null,null,null,null,null,null,null,null,null,i(170,2),null],TXA:[null,null,null,null,null,null,null,null,null,null,i(138,2),null],DEX:[null,null,null,null,null,null,null,null,null,null,i(202,2),null],INX:[null,null,null,null,null,null,null,null,null,null,i(232,2),null],TAY:[null,null,null,null,null,null,null,null,null,null,i(168,2),null],TYA:[null,null,null,null,null,null,null,null,null,null,i(152,2),null],DEY:[null,null,null,null,null,null,null,null,null,null,i(136,2),null],INY:[null,null,null,null,null,null,null,null,null,null,i(200,2),null],ROR:[null,i(102,5),i(118,6),null,i(110,6),i(126,7),null,null,null,null,i(106,2),null],ROL:[null,i(38,5),i(54,6),null,i(46,6),i(62,7),null,null,null,null,i(42,2),null],RTI:[null,null,null,null,null,null,null,null,null,null,i(64,6),null],RTS:[null,null,null,null,null,null,null,null,null,null,i(96,6),null],SBC:[i(233,2),i(229,3),i(245,4),null,i(237,4),o(253,4),o(249,4),null,i(225,6),o(241,5),null,null],STA:[null,i(133,3),i(149,4),null,i(141,4),i(157,5),i(153,5),null,i(129,6),i(145,6),null,null],TXS:[null,null,null,null,null,null,null,null,null,null,i(154,2),null],TSX:[null,null,null,null,null,null,null,null,null,null,i(186,2),null],PHA:[null,null,null,null,null,null,null,null,null,null,i(72,3),null],PLA:[null,null,null,null,null,null,null,null,null,null,i(104,4),null],PHP:[null,null,null,null,null,null,null,null,null,null,i(8,3),null],PLP:[null,null,null,null,null,null,null,null,null,null,i(40,4),null],STX:[null,i(134,3),null,i(150,4),i(142,4),null,null,null,null,null,null,null],STY:[null,i(132,3),i(148,4),null,i(140,4),null,null,null,null,null,null,null],SLO:[null,i(7,5),i(23,6),null,i(15,6),i(31,7),i(27,7),null,i(3,8),i(19,8),null,null],ANC:[i(11,2),null,null,null,null,null,null,null,null,null,null,null],RLA:[null,i(39,5),i(55,6),null,i(47,6),i(63,7),i(59,7),null,i(35,8),i(51,8),null,null],SRE:[null,i(71,5),i(87,6),null,i(79,6),i(95,7),i(91,7),null,i(67,8),i(83,8),null,null],RRA:[null,i(103,5),i(119,6),null,i(111,6),i(127,7),i(123,7),null,i(99,8),i(115,8),null,null],SAX:[null,i(135,3),null,i(151,4),i(143,4),null,null,null,i(131,6),null,null,null],AHX:[null,null,null,null,null,null,i(159,5),null,null,i(147,6),null,null],XAA:[i(139,2),null,null,null,null,null,null,null,null,null,null,null],TAS:[null,null,null,null,null,null,i(155,5),null,null,null,null,null],SHY:[null,null,null,null,null,i(156,5),null,null,null,null,null,null],SHX:[null,null,null,null,null,null,i(158,5),null,null,null,null,null],LAX:[i(171,2),i(167,3),null,i(183,4),i(175,4),null,i(191,4),null,i(163,6),i(179,5),null,null],LAS:[null,null,null,null,null,null,i(187,4),null,null,null,null,null],DCP:[null,i(199,5),i(215,6),null,i(207,6),i(223,7),i(219,7),null,i(195,8),i(211,8),null,null],ISC:[null,i(231,5),i(247,6),null,i(239,6),i(255,7),i(251,7),null,i(227,8),i(243,8),null,null],ALR:[i(75,2),null,null,null,null,null,null,null,null,null,null,null],AXS:[i(203,2),null,null,null,null,null,null,null,null,null,null,null],ARR:[i(107,2),null,null,null,null,null,null,null,null,null,null,null],"---":[null,null,null,null,null,null,null,null,null,null,null,null]};n.default=u},function(t,n){},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toHex16=void 0,n.toHex16=function(t){return t.toString(16).padStart(4,"0")}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.mkAsmLine=n.mkUseSegment=n.mkDeclareSegment=n.mkFilescope=n.mkLoadPlugin=n.mkStmtExpr=n.mkAssign=n.mkLet=n.mkCallMacro=n.mkMacro=n.mkMacroArg=n.mkFor=n.mkIfElse=n.mkBinary=n.mkError=n.mkInclude=n.mkAlign=n.mkFill=n.mkData=n.mkSetPC=n.mkInsn=n.mkLabel=n.DataSize=n.mkMember=n.mkGetCurPC=n.mkCallFunc=n.mkExprObject=n.mkExprArray=n.mkBinaryOp=n.mkUnary=n.mkKwarg=n.mkIdent=n.mkScopeQualifiedIdent=n.mkLiteral=void 0,n.mkLiteral=function(t,n){return{type:"literal",lit:t,loc:n}},n.mkScopeQualifiedIdent=function(t,n,r){return{type:"qualified-ident",path:t,absolute:n,loc:r}},n.mkIdent=function(t,n){return{type:"ident",name:t,loc:n}},n.mkKwarg=function(t,n,r){return{type:"kwarg",name:t,value:n,loc:r}},n.mkUnary=function(t,n,r){return{type:"unary",op:t,expr:n,loc:r}},n.mkBinaryOp=function(t,n,r,e){return{type:"binary",op:t,left:n,right:r,loc:e}},n.mkExprArray=function(t,n){return{type:"array",list:t,loc:n}},n.mkExprObject=function(t,n){return{type:"object",props:t,loc:n}},n.mkCallFunc=function(t,n,r){return{type:"callfunc",callee:t,args:null==n?[]:n,loc:r}},n.mkGetCurPC=function(t){return{type:"getcurpc",loc:t}},n.mkMember=function(t,n,r,e){return{type:"member",object:t,property:n,computed:r,loc:e}},function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"}(n.DataSize||(n.DataSize={})),n.mkLabel=function(t,n){return{name:t,loc:n}},n.mkInsn=function(t,n){return{type:"insn",insn:t,loc:n}},n.mkSetPC=function(t,n){return{type:"setpc",pc:t,loc:n}},n.mkData=function(t,n,r){return{type:"data",values:n,dataSize:t,loc:r}},n.mkFill=function(t,n,r){return{type:"fill",numBytes:t,fillValue:n,loc:r}},n.mkAlign=function(t,n){return{type:"align",alignBytes:t,loc:n}},n.mkInclude=function(t,n){return{type:"include",filename:t,loc:n}},n.mkError=function(t,n){return{type:"error",error:t,loc:n}},n.mkBinary=function(t,n){return{type:"binary",kwargs:t,loc:n}},n.mkIfElse=function(t,n,r){return{type:"if",cases:t,elseBranch:null!==n?n:[],loc:r}},n.mkFor=function(t,n,r,e){return{type:"for",index:t,list:n,body:r,loc:e}},n.mkMacroArg=function(t){return{ident:t}},n.mkMacro=function(t,n,r,e){return{type:"macro",name:t,args:null==n?[]:n,body:r,loc:e}},n.mkCallMacro=function(t,n,r){return{type:"callmacro",name:t,args:null==n?[]:n,loc:r}},n.mkLet=function(t,n,r){return{type:"let",name:t,value:n,loc:r}},n.mkAssign=function(t,n,r){return{type:"assign",name:t,value:n,loc:r}},n.mkStmtExpr=function(t,n){return{type:"statement-expr",expr:t,loc:n}},n.mkLoadPlugin=function(t,n,r){return{type:"load-plugin",filename:t,moduleName:n,loc:r}},n.mkFilescope=function(t,n){return{type:"filescope",name:t,loc:n}},n.mkDeclareSegment=function(t,n,r){return{type:"declare-segment",name:t,kwargs:n,loc:r}},n.mkUseSegment=function(t,n){return{type:"use-segment",name:t,loc:n}},n.mkAsmLine=function(t,n,r,e){return{label:t,stmt:n,scopedStmts:r,loc:e}}},function(t,n,r){"use strict";r.r(n),function(t){var n=r(2);onmessage=function(r){postMessage(function(r){var e=r.sourceFileMap,l={readFileSync:function(n){if(n in e)return t.from(e[n]);throw new Error("File not found "+n)}},i=n.assemble("main.asm",l);if(0===i.errors.length){var o={showLabels:!0,showCycles:!0,isInstruction:i.debugInfo.info().isInstruction};return{prg:i.prg,disassembly:n.disassemble(i.prg,i.labels,o),diagnostics:i.errors}}return{prg:void 0,diagnostics:i.errors}}(r.data))}}.call(this,r(1).Buffer)},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){"use strict";n.byteLength=function(t){var n=a(t),r=n[0],e=n[1];return 3*(r+e)/4-e},n.toByteArray=function(t){for(var n,r=a(t),e=r[0],o=r[1],s=new i(function(t,n,r){return 3*(n+r)/4-r}(0,e,o)),u=0,c=o>0?e-4:e,h=0;h<c;h+=4)n=l[t.charCodeAt(h)]<<18|l[t.charCodeAt(h+1)]<<12|l[t.charCodeAt(h+2)]<<6|l[t.charCodeAt(h+3)],s[u++]=n>>16&255,s[u++]=n>>8&255,s[u++]=255&n;2===o&&(n=l[t.charCodeAt(h)]<<2|l[t.charCodeAt(h+1)]>>4,s[u++]=255&n);1===o&&(n=l[t.charCodeAt(h)]<<10|l[t.charCodeAt(h+1)]<<4|l[t.charCodeAt(h+2)]>>2,s[u++]=n>>8&255,s[u++]=255&n);return s},n.fromByteArray=function(t){for(var n,r=t.length,l=r%3,i=[],o=0,s=r-l;o<s;o+=16383)i.push(c(t,o,o+16383>s?s:o+16383));1===l?(n=t[r-1],i.push(e[n>>2]+e[n<<4&63]+"==")):2===l&&(n=(t[r-2]<<8)+t[r-1],i.push(e[n>>10]+e[n>>4&63]+e[n<<2&63]+"="));return i.join("")};for(var e=[],l=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)e[s]=o[s],l[o.charCodeAt(s)]=s;function a(t){var n=t.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=n),[r,r===n?0:4-r%4]}function c(t,n,r){for(var l,i,o=[],s=n;s<r;s+=3)l=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(e[(i=l)>>18&63]+e[i>>12&63]+e[i>>6&63]+e[63&i]);return o.join("")}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},function(t,n){n.read=function(t,n,r,e,l){var i,o,s=8*l-e-1,u=(1<<s)-1,a=u>>1,c=-7,h=r?l-1:0,f=r?-1:1,d=t[n+h];for(h+=f,i=d&(1<<-c)-1,d>>=-c,c+=s;c>0;i=256*i+t[n+h],h+=f,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=e;c>0;o=256*o+t[n+h],h+=f,c-=8);if(0===i)i=1-a;else{if(i===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,e),i-=a}return(d?-1:1)*o*Math.pow(2,i-e)},n.write=function(t,n,r,e,l,i){var o,s,u,a=8*i-l-1,c=(1<<a)-1,h=c>>1,f=23===l?Math.pow(2,-24)-Math.pow(2,-77):0,d=e?0:i-1,p=e?1:-1,m=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(s=isNaN(n)?1:0,o=c):(o=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-o))<1&&(o--,u*=2),(n+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(n*u-1)*Math.pow(2,l),o+=h):(s=n*Math.pow(2,h-1)*Math.pow(2,l),o=0));l>=8;t[r+d]=255&s,d+=p,s/=256,l-=8);for(o=o<<l|s,a+=l;a>0;t[r+d]=255&o,d+=p,o/=256,a-=8);t[r+d-p]|=128*m}},function(t,n){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,n,r){"use strict";(function(t,e){Object.defineProperty(n,"__esModule",{value:!0}),n.assemble=n.platformC64=void 0;const l=r(4),i=r(0),o=r(14),s=r(5),u=r(6),a=r(7),c=r(20),h=r(21),f=r(23);function d(t){return{value:t,errors:!0,completeFirstPass:!1}}function p(t,n){return{value:t,errors:!1,completeFirstPass:n}}function m(...t){return t.some(t=>void 0!==t&&t.errors)}function g(...t){return t.every(t=>void 0!==t&&t.completeFirstPass)}n.platformC64={name:"c64",defaultStartPC:2049};class y{constructor(t,n){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=t,this.name=n}newScope(t,n){const r=this.children.get(t);if(void 0!==r)return r;const e=new y(n,t);return this.children.set(t,e),e}findSymbol(t){for(let n=this;null!==n;n=n.parent){const r=n.syms.get(t);if(void 0!==r)return r}}findSymbolPath(t){if(1==t.length)return this.findSymbol(t[0]);let n=this;for(;null==n.children.get(t[0]);)if(null==(n=n.parent))return;for(let r=0;r<t.length-1;r++)if(null==(n=n.children.get(t[r])))return;return n.syms.get(t[t.length-1])}addSymbol(t,n,r){this.syms.set(t,Object.assign(Object.assign({},n),{seen:r}))}updateSymbol(t,n,r){for(let e=this;null!==e;e=e.parent){if(void 0!==e.syms.get(t))return void e.syms.set(t,Object.assign(Object.assign({},n),{seen:r}))}}}class v{constructor(){this.passCount=0,this.root=new y(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(t){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=t}withAnonScope(t,n){const r=`__anon_scope_${this.anonScopeCount}`;this.anonScopeCount++,this.withLabelScope(r,t,n)}withLabelScope(t,n,r){const e=this.curSymtab;this.curSymtab=this.curSymtab.newScope(t,r||e),n(),this.curSymtab=e}findPath(t,n){return n?this.root.findSymbolPath(t):this.curSymtab.findSymbolPath(t)}findQualifiedSym(t,n){return this.findPath(t,n)}symbolSeen(t){const n=this.curSymtab.syms.get(t);return void 0!==n&&n.seen==this.passCount}declareLabelSymbol(t,n){const{name:r,loc:e}=t,l=this.curSymtab.syms.get(r);if(void 0===l){const t={type:"label",data:p({addr:n,loc:e},!1)};return this.curSymtab.addSymbol(r,t,this.passCount),!1}if("label"!==l.type)throw new Error("ICE: declareLabelSymbol should be called only on labels");if(l.data.value.addr!==n){const t={type:"label",data:Object.assign(Object.assign({},l.data),{value:Object.assign(Object.assign({},l.data.value),{addr:n})})};return this.curSymtab.updateSymbol(r,t,this.passCount),!0}return this.curSymtab.updateSymbol(r,l,this.passCount),!1}declareVar(t,n){this.curSymtab.addSymbol(t,{type:"var",data:n},this.passCount)}updateVar(t,n){const r={type:"var",data:n};this.curSymtab.updateSymbol(t,r,this.passCount)}declareSegment(t,n){this.curSymtab.addSymbol(t,{type:"segment",data:n},this.passCount)}findMacro(t,n){const r=this.findPath(t,n);if(void 0!==r&&"macro"==r.type)return r}declareMacro(t,n){this.curSymtab.addSymbol(t,{type:"macro",macro:n,declaredIn:this.curSymtab},this.passCount)}dumpLabels(t){const n=[],r=(t,r)=>{if(void 0!==t){const e=[...t,r.name];n.push({path:e,sym:r})}else n.push({path:[],sym:r})};r(void 0,this.root);const e=[];for(;n.length>0;){const t=n.pop();for(let[n,r]of t.sym.syms)"label"==r.type&&e.push({path:[...t.path,n],addr:r.data.value.addr,size:0});for(let[n,e]of t.sym.children)r(t.path,e)}const l=e.sort((t,n)=>t.addr-n.addr),i=l.length;if(i>0){for(let t=1;t<i;t++)l[t-1].size=l[t].addr-l[t-1].addr;const n=l[i-1];n.size=t-n.addr}return l.map(({path:t,addr:n,size:r})=>({name:t.join("::"),addr:n,size:r}))}}function b(t){return{source:t,start:{offset:0,line:0,column:0},end:{offset:0,line:0,column:0}}}function w(t){const n=typeof t;return"object"===n&&t instanceof Array?"array":n}function A(t){return`${t.absolute?"::":""}${t.path.join("::")}`}const S=(t,n,r)=>{const e=r(t.value,n.value),l=g(t,n);return p("boolean"==typeof e?e?1:0:e,l)},E=(t,n)=>{if(m(t))return d(0);const r=n(t.value);return p("boolean"==typeof r?r?1:0:r,t.completeFirstPass)},k=void 0!==t&&null!=t.versions&&null!=t.versions.node;class C{constructor(t){this.parseCache=new h.default,this.pluginCache=new Map,this.includeStack=[],this.curSegment=new c.Segment(0,0,!1),this.pass=0,this.needPass=!1,this.scopes=new v,this.segments=[],this.errorList=[],this.warningList=[],this.outOfRangeBranches=[],this.debugInfo=new f.DebugInfoTracker,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning"),this.readFileSyncFunc=t.readFileSync,this.platform=t.platformOptions||n.platformC64}readFileSync(t,n){return this.readFileSyncFunc(t,n)}prg(){const{startPC:t,binary:n}=c.mergeSegments(this.segments),r=255&t,l=t>>8&255;return e.concat([e.from([r,l]),n])}parse(t,n){const r=null==n?b(t):n;return this.parseCache.parse(t,n,(t,n)=>this.guardedReadFileSync(t,r))}requirePlugin(t,n){const r=this.pluginCache.get(t);if(void 0!==r)return r;const e=this.makeSourceRelativePath(t);try{let r=void 0;if(k)r=o(i.resolve(e));else{const t=this.guardedReadFileSync(`${e}.js`,n);void 0!==t&&(r=function(t){let n={exports:{}};return Function("module",t.toString())(n),n.exports}(t))}if(void 0===r)return d(0);const l=p(r,!0);return this.pluginCache.set(t,l),l}catch(t){return this.addError(`Plugin load failed: ${e}.js: ${t.message}`,n),d(0)}}peekSourceStack(){const t=this.includeStack.length;return this.includeStack[t-1]}pushSource(t){this.includeStack.push(t)}popSource(){this.includeStack.pop()}anyErrors(){return 0!==this.errorList.length}formatErrors(t,n){return[...new Set(t.map(t=>JSON.stringify(t)))].map(t=>{const{loc:r,msg:e}=JSON.parse(t);let l=`<unknown>:1:1: ${n}: ${e}`;return r&&(l=`${r.source}:${r.start.line}:${r.start.column}: ${n}: ${e}`),{loc:r,msg:e,formatted:l}})}addError(t,n){this.errorList.push({msg:t,loc:n})}addWarning(t,n){this.warningList.push({msg:t,loc:n})}startPass(t){this.pass=t,this.needPass=!1,this.errorList=[],this.scopes.startPass(t),this.outOfRangeBranches=[],this.debugInfo=new f.DebugInfoTracker,this.segments=[],this.curSegment=this.newSegment("default",this.platform.defaultStartPC,void 0,!0),this.scopes.declareSegment("default",this.curSegment)}newSegment(t,n,r,e){const l=new c.Segment(n,r,e);for(let n=1;n<this.segments.length;n++){const[r,e]=this.segments[n];this.segments[n][1].overlaps(l)&&this.addError(`Segment '${t}' (range: ${l.formatRange()} overlaps with an earlier segment '${r}' (range: ${e.formatRange()})`,this.lineLoc)}return this.segments.push([t,l]),l}getPC(){return this.curSegment.currentPC()}emitBasicHeader(){this.emit(12),this.emit(8),this.emit(0),this.emit(0),this.emit(158);[1e4,1e3,100,10,1].forEach(t=>{2061>=t&&this.emit(48+2061/t%10)}),this.emit(0),this.emit(0),this.emit(0)}emitBinary(t){const{kwargs:n}=t,[r,e]=this.evalKwargToString(n,"file",t.loc);let[l,i]=this.evalKwargToIntMaybe(n,"size",t.loc);const[o,s]=this.evalKwargToIntMaybe(n,"offset",t.loc),u=l,a=null!=o?o:p(0,!0),c=this.validateKwargs(n,["file","size","offset"]);if(m(r,a,null!=u?u:void 0)||!c)return;a.completeFirstPass||this.addError("!binary 'offset' must evaluate to a value in the first pass",s),null===u||u.completeFirstPass||this.addError("!binary 'size' must evaluate to a value in the first pass",i);const h=this.makeSourceRelativePath(r.value),f=this.guardedReadFileSync(h,t.loc);if(void 0===f)return;const d=null!==u?u.value:f.byteLength,g=f.slice(a.value,a.value+d);for(const t of g)this.emit(t)}evalExprType(t,n,r){const e=this.evalExpr(t),{errors:l,value:i,completeFirstPass:o}=e;return l||typeof i===n?e:(this.addError(`Expecting ${r} to be '${n}' type, got '${w(i)}'`,t.loc),{errors:!0,completeFirstPass:o,value:i})}evalKwargType(t,n,r,e){for(const e of t)if(e.name.name===n){return[this.evalExprType(e.value,r,`keyword arg '${n}'`),e.loc]}return this.addError(`Missing required keyword arg '${n}'`,e),[d(0),e]}evalKwargTypeMaybe(t,n,r,e){for(const e of t)if(e.name.name===n){return[this.evalExprType(e.value,r,`keyword arg '${n}'`),e.loc]}return[null,e]}validateKwargs(t,n){let r=!0;const e={};for(const n of t){const t=n.name.name;void 0===e[t]?e[t]=1:e[t]+=1,e[t]>1&&(this.addError(`Duplicate keyword arg '${t}'`,n.loc),r=!1)}for(const e of t)n.indexOf(e.name.name)<0&&(this.addError(`Unexpected keyword arg '${e.name.name}'`,e.loc),r=!1);return r}evalExprToInt(t,n){return this.evalExprType(t,"number",n)}evalExprToString(t,n){return this.evalExprType(t,"string",n)}evalKwargToInt(t,n,r){return this.evalKwargType(t,n,"number",r)}evalKwargToString(t,n,r){return this.evalKwargType(t,n,"string",r)}evalKwargToIntMaybe(t,n,r){return this.evalKwargTypeMaybe(t,n,"number",r)}evalExpr(t){switch(t.type){case"binary":{const n=this.evalExpr(t.left),r=this.evalExpr(t.right);if(m(n,r))return d(0);if(typeof n.value!=typeof r.value)return this.addError(`Binary expression operands are expected to be of the same type.  Got: '${w(n.value)}' (left), '${w(r.value)}' (right)`,t.loc),d(0);if("string"!=typeof n.value&&"number"!=typeof n.value)return this.addError(`Binary expression operands can only operator on numbers or strings.  Got: '${w(n.value)}'`,t.loc),d(0);if("string"==typeof n.value){const n=["+","==","<","<=",">",">="];if(n.indexOf(t.op)<0)return this.addError(`'${t.op}' operator is not supported for strings.  Valid operators for strings are: ${n.join(", ")}`,t.loc),d(0)}switch(t.op){case"+":return S(n,r,(t,n)=>t+n);case"-":return S(n,r,(t,n)=>t-n);case"*":return S(n,r,(t,n)=>t*n);case"/":return S(n,r,(t,n)=>t/n);case"%":return S(n,r,(t,n)=>t%n);case"&":return S(n,r,(t,n)=>t&n);case"|":return S(n,r,(t,n)=>t|n);case"^":return S(n,r,(t,n)=>t^n);case"<<":return S(n,r,(t,n)=>t<<n);case">>":return S(n,r,(t,n)=>t>>n);case"==":return S(n,r,(t,n)=>t==n);case"!=":return S(n,r,(t,n)=>t!=n);case"<":return S(n,r,(t,n)=>t<n);case"<=":return S(n,r,(t,n)=>t<=n);case">":return S(n,r,(t,n)=>t>n);case">=":return S(n,r,(t,n)=>t>=n);case"&&":return S(n,r,(t,n)=>t&&n);case"||":return S(n,r,(t,n)=>t||n);default:throw new Error(`Unhandled binary operator ${t.op}`)}}case"unary":{const n=this.evalExprToInt(t.expr,"operand");if(n.errors)return n;switch(t.op){case"+":return E(n,t=>+t);case"-":return E(n,t=>-t);case"~":return E(n,t=>~t);default:throw new Error(`Unhandled unary operator ${t.op}`)}}case"literal":return p(t.lit,!0);case"array":{const n=t.list.map(t=>this.evalExpr(t));return{value:n.map(t=>t.value),errors:m(...n),completeFirstPass:g(...n)}}case"object":{const n=t.props.map(t=>{const n=this.evalExpr(t.val);return["literal"===t.key.type?t.key.lit:t.key.name,n]});return{value:n.reduce((t,[n,r])=>Object.assign(Object.assign({},t),{[n]:r.value}),{}),errors:m(...n.map(([t,n])=>n)),completeFirstPass:g(...n.map(([t,n])=>n))}}case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{const n=this.scopes.findQualifiedSym(t.path,t.absolute);if(null==n)return this.pass>=1?(this.addError(`Undefined symbol '${A(t)}'`,t.loc),d(0)):(this.needPass=!0,p(0,!1));switch(n.type){case"label":return{errors:n.data.errors,value:n.data.value.addr,completeFirstPass:n.seen==this.pass};case"var":return n.seen<this.pass&&this.addError(`Undeclared variable '${A(t)}'`,t.loc),n.data;case"macro":return this.addError("Must have a label or a variable identifier here, got macro name",t.loc),d(0)}break}case"member":{const n=this.evalExpr(t.object);if(m(n))return d(0);const{value:r}=n;if(null==r)return this.addError("Cannot access properties of an undefined object",t.loc),d(0);const e=(t,n)=>t in r||(this.addError(`Property '${t}' does not exist in object`,n),!1),l=(t,l)=>{if("ident"!==t.property.type)this.addError(`${l} property must be a string, got ${w(t.property.type)}`,t.loc);else if(e(t.property.name,t.property.loc))return p(r[t.property.name],n.completeFirstPass);return d(0)};if(r instanceof Array){if(!t.computed)return l(t,"Array");const{errors:e,value:i,completeFirstPass:o}=this.evalExprToInt(t.property,"array index");return e?d(0):i in r?p(r[i],n.completeFirstPass&&o):(this.addError(`Out of bounds array index ${i}`,t.property.loc),d(0))}if("object"==typeof r){if(t.computed){let{errors:l,value:i,completeFirstPass:o}=this.evalExpr(t.property);return l?d(0):"string"!=typeof i&&"number"!=typeof i?(this.addError(`Object property must be a string or an integer, got ${w(i)}`,t.loc),d(0)):e(i,t.property.loc)?p(r[i],o&&n.completeFirstPass):d(0)}return l(t,"Object")}return 0!==this.pass?(n.errors||(t.computed?this.addError("Cannot use []-operator on non-array/object values",t.loc):this.addError("Cannot use the dot-operator on non-object values",t.loc)),d(0)):p(0,!1)}case"callfunc":{const n=this.evalExpr(t.callee),r=t.args.map(t=>this.evalExpr(t));if(n.errors)return d(0);if("function"!=typeof n.value)return this.addError(`Callee must be a function type.  Got '${w(n)}'`,t.loc),d(0);if(m(...r))return d(0);try{const e=n.completeFirstPass&&g(...r);return p(n.value(...r.map(t=>t.value)),e)}catch(n){return"qualified-ident"==t.callee.type?this.addError(`Call to '${A(t.callee)}' failed with an error: ${n.message}`,t.loc):this.addError(`Plugin call failed with an error: ${n.message}`,t.loc),d(0)}}case"getcurpc":return p(this.getPC(),!0)}throw new Error("should be unreachable?")}topLevelSourceLoc(){return b(this.includeStack[0])}emit(t){const n=this.curSegment.emit(t);void 0!==n&&this.addError(n,this.lineLoc)}emit16(t){this.emit(255&t),this.emit(t>>8&255)}checkSingle(t){return null!==t&&(this.emit(t),!0)}checkImm(t,n){if(null===n||null===t)return!1;const r=this.evalExprToInt(t,"immediate");return m(r)||(this.emit(n),this.emit(r.value)),!0}checkAbs(t,n,r){if(null===n||null===t)return!1;const e=this.evalExprToInt(t,"absolute address");if(m(e))return!0;const{value:l}=e;if(8===r){if(l<0||l>=1<<r)return!1;this.emit(n),this.emit(l)}else this.emit(n),this.emit16(l);return!0}checkBranch(t,n){if(null===n||null===t)return!1;const r=this.evalExpr(t);if(m(r))return!0;if("number"!=typeof r.value)return this.addError(`Expecting branch label to evaluate to integer, got ${w(r.value)}`,t.loc),!0;const{value:e}=r,l=e-this.getPC()-2;return this.emit(n),(l>127||l<-128)&&this.outOfRangeBranches.push({loc:t.loc,offset:l}),this.emit(255&l),!0}handleSetPC(t){const n=this.evalExprToInt(t,"pc");if(!m(n)){const{value:r,completeFirstPass:e}=n;if(!e)return void this.addError("Value for new program counter must evaluate to a value in the first pass",t.loc);!this.curSegment.empty()&&this.curSegment.currentPC()>r&&this.addError(`Cannot set program counter to a smaller value than current (current: $${u.toHex16(this.curSegment.currentPC())}, trying to set $${u.toHex16(r)})`,t.loc);const l=this.curSegment.setCurrentPC(r);void 0!==l&&this.addError(l,t.loc)}}guardedReadFileSync(t,n){try{return this.readFileSync(t)}catch(r){return void this.addError(`Couldn't open file '${t}'`,n)}}fileInclude(t){const n=this.evalExprToString(t.filename,"!include filename");if(m(n))return;const r=n.value,e=this.makeSourceRelativePath(r);this.pushSource(e),this.assemble(e,t.loc),this.popSource()}fillBytes(t){const n=this.evalExprToInt(t.numBytes,"!fill num_bytes"),r=this.evalExprToInt(t.fillValue,"!fill value");if(m(n,r))return;const{value:e}=r;if(e<0||e>=256)return void this.addError(`!fill value to repeat must be in 8-bit range, '${e}' given`,t.fillValue.loc);const l=n.value;if(l<0)this.addError(`!fill repeat count must be >= 0, got ${l}`,t.numBytes.loc);else for(let t=0;t<l;t++)this.emit(e)}alignBytes(t){const n=this.evalExprToInt(t.alignBytes,"alignment");if(m(n))return;const{value:r}=n;if(r<1)this.addError(`Alignment must be a positive integer, ${r} given`,t.alignBytes.loc);else if(0==(r&r-1))for(;0!=(this.getPC()&r-1);)this.emit(0);else this.addError(`Alignment must be a power of two, ${r} given`,t.loc)}withAnonScope(t,n,r){if(null!==t)return this.withLabelScope(t,n,r);this.scopes.withAnonScope(n,r)}withLabelScope(t,n,r){this.scopes.withLabelScope(t,n)}emit8or16(t,n){8!=n?this.emit16(t):this.emit(t)}emitData(t,n){for(let r=0;r<t.length;r++){const e=this.evalExpr(t[r]);if(m(e))continue;const{value:l}=e;if("number"==typeof l)this.emit8or16(l,n);else if(l instanceof Array){let e=-1;for(let t=0;t<l.length;t++){const r="number"==typeof l[t]?l[t]:0;e="number"!=typeof l[t]&&-1===e?t:e,this.emit8or16(r,n)}-1!=e&&this.addError(`Cannot emit non-numeric values.  First non-number at index ${e}`,t[r].loc)}else this.addError(`Only literal (int constants) or array types can be emitted.  Got ${w(l)}`,t[r].loc)}}makeFunction(t,n){return(...n)=>{return t.apply(null,[{readFileSync:t=>this.readFileSync(t),resolveRelative:t=>this.makeSourceRelativePath(t)},...n])}}bindFunction(t,n,r){this.scopes.declareVar(t.name,p(this.makeFunction(n,r),!0))}bindPlugin(t,n){const r=t.moduleName;if(m(n))return void this.scopes.declareVar(r.name,d(0));const e=n.value;if("function"==typeof e&&this.bindFunction(r,e,t.loc),"object"==typeof e){const n={},l=Object.keys(e);for(let r in l){const i=l[r],o=e[i];n[i]="function"==typeof o?this.makeFunction(o,t.loc):o}this.scopes.declareVar(r.name,p(n,!0))}}checkDirectives(t,n){switch(t.type){case"data":this.emitData(t.values,t.dataSize===a.DataSize.Byte?8:16);break;case"fill":this.fillBytes(t);break;case"align":this.alignBytes(t);break;case"setpc":this.handleSetPC(t.pc);break;case"binary":this.emitBinary(t);break;case"include":this.fileInclude(t);break;case"error":{const n=this.evalExprToString(t.error,"error message");if(!m(n))return void this.addError(n.value,t.loc);break}case"if":{const{cases:e,elseBranch:l}=t;for(let t in e){const[l,i]=e[t],o=this.evalExpr(l);if(!m(o)&&(!0===(r=o.value)||0!=r))return this.withAnonScope(n,()=>{this.assembleLines(i)})}return this.withAnonScope(n,()=>{this.assembleLines(l)})}case"for":{const{index:r,list:e,body:l,loc:i}=t,o=this.evalExpr(e);if(m(o))return;const{value:s}=o;if(!(s instanceof Array))return void this.addError("for-loop range must be an array expression (e.g., a range() or an array)",e.loc);for(let t=0;t<s.length;t++){let e=null;null!==n&&(e=`${n}__${t}`),this.withAnonScope(e,()=>(this.scopes.declareVar(r.name,p(s[t],o.completeFirstPass)),this.assembleLines(l)))}break}case"macro":{const{name:n,args:r,body:e}=t;if(void 0!==this.scopes.findQualifiedSym([n.name],!1)&&this.scopes.symbolSeen(n.name))return void this.addError(`Symbol '${n.name}' already defined`,n.loc);this.scopes.declareMacro(n.name,t);break}case"callmacro":{const{name:r,args:e}=t,l=this.scopes.findMacro(r.path,r.absolute),i=e.map(t=>this.evalExpr(t));if(null==l||l.seen<this.pass)return void this.addError(`Undefined macro '${A(r)}'`,r.loc);const{macro:o,declaredIn:s}=l;if(o.args.length!==e.length)return void this.addError(`Macro '${A(r)}' declared with ${o.args.length} args but called here with ${e.length}`,r.loc);this.withAnonScope(n,()=>{for(let t=0;t<i.length;t++){const n=o.args[t].ident.name;this.scopes.declareVar(n,i[t])}this.assembleLines(o.body)},s);break}case"let":{const n=t.name,r=this.scopes.findQualifiedSym([n.name],!1),e=this.evalExpr(t.value);if(void 0!==r&&this.scopes.symbolSeen(n.name))return void this.addError(`Variable '${n.name}' already defined`,t.loc);this.scopes.declareVar(n.name,e);break}case"assign":{const n=t.name;if(1!==t.name.path.length||t.name.absolute)return void this.addError("Only symbol names in the current (or owning) scopes are allowed for assignment",t.loc);const r=this.scopes.findQualifiedSym(t.name.path,t.name.absolute);if(null==r)return void this.addError(`Assignment to undeclared variable '${A(n)}'`,t.loc);if("var"!==r.type)return void this.addError(`Assignment to symbol '${A(n)}' that is not a variable.  Its type is '${r.type}'`,t.loc);const e=this.evalExpr(t.value);this.scopes.updateVar(n.path[0],e);break}case"statement-expr":this.evalExpr(t.expr);break;case"load-plugin":{const n=this.evalExprToString(t.filename,"plugin filename");if(m(n))return;const r=this.requirePlugin(n.value,t.loc);this.bindPlugin(t,r);break}case"filescope":return void this.addError("The !filescope directive is only allowed as the first directive in a source file",t.loc);case"declare-segment":{const{name:n,kwargs:r,loc:e}=t,l=this.scopes.findQualifiedSym([n.name],!1),[i,o]=this.evalKwargToInt(r,"start",e),[s,u]=this.evalKwargToInt(r,"end",e);if(void 0!==l&&this.scopes.symbolSeen(n.name))return void this.addError(`Segment '${n.name}' already defined`,t.loc);const a=this.validateKwargs(r,["start","end"]);if(m(i)||m(s)||!a)return;let c=!1;if(i.completeFirstPass||(this.addError("!segment 'start' must evaluate to a value in the first pass",o),c=!0),s.completeFirstPass||(this.addError("!segment 'end' must evaluate to a value in the first pass",u),c=!0),c)return;const h=this.newSegment(n.name,i.value,s.value,!1);return void this.scopes.declareSegment(n.name,h)}case"use-segment":{const{name:n,loc:r}=t,e=this.scopes.findQualifiedSym(n.path,n.absolute);if(void 0===e)return void this.addError(`Use of undeclared segment '${A(n)}'`,r);if("segment"!==e.type)return void this.addError(`Use of segment '${A(n)}' that is not a declared segment.  Its type is '${e.type}'`,r);this.curSegment=e.data;break}default:return void this.addError(`unknown directive ${t.type}`,t.loc)}var r}assembleLines(t){if(null===t||0==t.length)return;if(0==t.length)return;const n=t=>{for(let n=0;n<t.length;n++)this.debugInfo.startLine(t[n].loc,this.getPC()),this.assembleLine(t[n]),this.debugInfo.endLine(this.getPC())};let r=0;for(;r<t.length;){const{label:n,stmt:e,scopedStmts:l}=t[r];if(null!=n||null!=e||null!=l)break;r++}if(r>=t.length)return;const e=t[r];return null!=e.stmt&&"filescope"==e.stmt.type?(this.checkAndDeclareLabel(e.stmt.name),this.withLabelScope(e.stmt.name.name,()=>n(t.slice(r+1)))):n(t)}checkAndDeclareLabel(t){if(this.scopes.symbolSeen(t.name))this.addError(`Symbol '${t.name}' already defined`,t.loc);else{this.scopes.declareLabelSymbol(t,this.getPC())&&(this.needPass=!0)}}assembleLine(t){if(this.lineLoc=t.loc,null==t.label&&null==t.stmt&&null==t.scopedStmts)return;null!==t.label&&this.checkAndDeclareLabel(t.label);const n=t.scopedStmts;if(null!=n){if(!t.label)throw new Error("ICE: line.label cannot be undefined");return void this.withLabelScope(t.label.name,()=>{this.assembleLines(n)})}if(null===t.stmt)return;if("insn"!==t.stmt.type)return void this.checkDirectives(t.stmt,null==t.label?null:t.label.name);const r=t.stmt.insn,e=l.default[r.mnemonic.toUpperCase()];void 0!==e?(t=>{const n=this.getPC();t();const r=this.getPC();this.debugInfo.markAsInstruction(n,r)})(()=>{null===r.imm&&null===r.abs&&null===r.absx&&null===r.absy&&null===r.absind&&this.checkSingle(e[10])||this.checkImm(r.imm,e[0])||this.checkAbs(r.abs,e[1],8)||this.checkAbs(r.absx,e[2],8)||this.checkAbs(r.absy,e[3],8)||this.checkAbs(r.absx,e[5],16)||this.checkAbs(r.absy,e[6],16)||this.checkAbs(r.absind,e[7],16)||this.checkAbs(r.indx,e[8],8)||this.checkAbs(r.indy,e[9],8)||this.checkAbs(r.abs,e[4],16)||this.checkBranch(r.abs,e[11])||this.addError(`Couldn't encode instruction '${r.mnemonic}'`,t.loc)}):this.addError(`Unknown mnemonic '${r.mnemonic}'`,t.loc)}makeSourceRelativePath(t){const n=this.peekSourceStack();return i.join(i.dirname(n),t)}assemble(t,n){try{const r=this.parse(t,n);void 0!==r&&this.assembleLines(r)}catch(t){if(!("name"in t&&"SyntaxError"==t.name)){if("name"in t&&"semantic"==t.name)return;throw t}this.addError(`Syntax error: ${t.message}`,Object.assign(Object.assign({},t.location),{source:this.peekSourceStack()}))}}_requireType(t,n){if(typeof t==n)return t;this.addError(`Expecting a ${n} value, got ${w(t)}`,t.loc)}requireString(t){return this._requireType(t,"string")}requireNumber(t){return this._requireType(t,"number")}registerPlugins(){const t=(t,n)=>{this.scopes.declareVar(t,p(n,!1))};t("loadJson",(...t)=>{const n=this.requireString(t[0]),r=this.makeSourceRelativePath(n);return JSON.parse(this.readFileSync(r,"utf-8"))}),t("range",(...t)=>{let n=0,r=void 0;if(1==t.length)r=this.requireNumber(t[0]);else{if(2!=t.length)throw new Error("Invalid number of args to 'range'.  Expecting 1 or 2 arguments.");n=this.requireNumber(t[0]),r=this.requireNumber(t[1])}if(r==n)return[];if(r<n)throw new Error("range 'end' must be larger or equal to 'start'");return Array(r-n).fill(null).map((t,r)=>r+n)});const n={};for(let t of Object.getOwnPropertyNames(Math)){const r=Math;n[t]="random"===t?()=>{throw new Error("Math.random() not allowed as it will lead to non-reproducible builds")}:r[t]}t("Math",n)}dumpLabels(){return this.scopes.dumpLabels(this.getPC())}}const P={readFileSync:s.readFileSync};n.assemble=function(t,n=P){const r=new C(n);r.pushSource(t);let l=0;do{if(r.startPass(l),r.registerPlugins(),r.assemble(t,b(t)),l>0&&r.anyErrors())return{prg:e.from([]),labels:[],debugInfo:void 0,errors:r.errors(),warnings:r.warnings()};const n=10;if(l>n)return void console.error(`Exceeded max pass limit ${n}`);if(l+=1,!r.needPass&&0!=r.outOfRangeBranches.length){for(let t in r.outOfRangeBranches){const n=r.outOfRangeBranches[t];r.addError(`Branch target too far (must fit in signed 8-bit range, got ${n.offset})`,n.loc)}break}}while(r.needPass);return r.popSource(),{prg:r.prg(),errors:r.errors(),warnings:r.warnings(),labels:r.dumpLabels(),debugInfo:r.debugInfo}}}).call(this,r(3),r(1).Buffer)},function(t,n,r){"use strict";const e=r(0),l=r(15),i=r(16);t.exports=t=>{if("string"!=typeof t)throw new TypeError("Expected a string");const n=l(e.dirname(i()),t);if(r.c[n]&&r.c[n].parent){let t=r.c[n].parent.children.length;for(;t--;)r.c[n].parent.children[t].id===n&&r.c[n].parent.children.splice(t,1)}return delete r.c[n],r(19)(n)}},function(t,n,r){"use strict";const e=r(0),l=r(5),i=(t,n,r)=>{if("string"!=typeof t)throw new TypeError(`Expected \`fromDir\` to be of type \`string\`, got \`${typeof t}\``);if("string"!=typeof n)throw new TypeError(`Expected \`moduleId\` to be of type \`string\`, got \`${typeof n}\``);t=e.resolve(t);const i=e.join(t,"noop.js"),o=()=>l._resolveFilename(n,{id:i,filename:i,paths:l._nodeModulePaths(t)});if(r)try{return o()}catch(t){return null}return o()};t.exports=(t,n)=>i(t,n),t.exports.silent=(t,n)=>i(t,n,!0)},function(t,n,r){"use strict";const e=r(17);t.exports=()=>e().getFileName()},function(t,n,r){"use strict";const e=r(18);t.exports=()=>{const t=e();let n;for(let r=0;r<t.length;r++){if(null!==t[r].getTypeName()){n=r;break}}return t[n]}},function(t,n,r){"use strict";t.exports=()=>{const t=Error.prepareStackTrace;Error.prepareStackTrace=(t,n)=>n;const n=(new Error).stack.slice(1);return Error.prepareStackTrace=t,n}},function(t,n){function r(t){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}r.keys=function(){return[]},r.resolve=r,t.exports=r,r.id=19},function(t,n,r){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.mergeSegments=n.Segment=void 0;const e=r(6);class l{constructor(t,n,r){this.start=t,this.end=n,this.inferStart=r,this.blocks=[{start:t,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(t){let n=void 0;if(this.inferStart&&1===this.blocks.length&&0===this.blocks[0].binary.length)this.start=t;else{const r=void 0!==this.end?`$${e.toHex16(this.end)}`:"",l=`Segment address range: $${e.toHex16(this.start)}-${r}`;t<this.start?n=`${l}.  Cannot set program counter to a lower address $${e.toHex16(t)}.`:void 0!==this.end&&t>this.end?n=`${l}.  Trying to set program counter to $${e.toHex16(t)} -- it is past segment end ${r}.`:1===this.blocks.length&&0===this.blocks[0].binary.length&&(this.start=t)}const r={start:t,binary:[]},l=this.blocks.push(r);return this.curBlock=this.blocks[l-1],n}empty(){return this.blocks.every(t=>0===t.binary.length)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(t){if(this.currentPC()<this.start||void 0!==this.end&&this.currentPC()>this.end){const t=void 0!==this.end?`$${e.toHex16(this.end)}`:"",n=void 0!==this.start?`$${e.toHex16(this.start)}`:"";return`Segment overflow at $${e.toHex16(this.currentPC())}.  Segment address range: ${n}-${t}`}this.curBlock.binary.push(t)}formatRange(){const t=void 0!==this.end?`$${e.toHex16(this.end)}`:"";return`${void 0!==this.start?`$${e.toHex16(this.start)}`:""}-${t}`}overlaps(t){const n=this.start,r=t.start,e=void 0!==this.end?this.end:this.currentPC(),l=void 0!==t.end?t.end:t.currentPC();return n<r?r<=e:l>=n}}n.Segment=l,n.mergeSegments=function(n){const r=function(t){const n=[];for(const[r,e]of t){const t=e.blocks.filter(t=>0!==t.binary.length);if(0!==t.length){const i=new l(e.start,e.end,e.inferStart);i.blocks=t,i.curBlock=t[t.length-1],n.push([r,i])}}return n}(n);if(0===r.length)return{startPC:0,binary:t.from([])};const[e,i]=r[0],o=i.blocks[0],s=i.blocks[i.blocks.length-1];let u=o.start,a=s.start+s.binary.length;for(let t=1;t<r.length;t++){const n=r[t][1],e=n.blocks[0].start,l=n.curBlock.start+n.curBlock.binary.length;u=Math.min(e,u),a=Math.max(l,a)}const c=t.alloc(a,0);for(const[n,e]of r)for(const n of e.blocks)t.from(n.binary).copy(c,n.start);return{startPC:u,binary:c.slice(u)}}}).call(this,r(1).Buffer)},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=r(22);n.default=class{constructor(){this.filenameToSource=new Map,this.sourceToAst=new Map}getFileContents(t,n,r){const e=this.filenameToSource.get(t);if(void 0!==e)return e;const l=r(t,n);return this.filenameToSource.set(t,l),l}parse(t,n,r){const l=this.getFileContents(t,n,r);if(void 0===l)return;const i=this.sourceToAst.get(t);if(void 0!==i)return i;const o=e.parse(l.toString(),{source:t});return this.sourceToAst.set(t,o),o}}},function(t,n,r){"use strict";function e(t,n,r,l){this.message=t,this.expected=n,this.found=r,this.location=l,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}!function(t,n){function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r}(e,Error),e.buildMessage=function(t,n){var r={literal:function(t){return'"'+l(t.text)+'"'},class:function(t){var n,r="";for(n=0;n<t.parts.length;n++)r+=t.parts[n]instanceof Array?i(t.parts[n][0])+"-"+i(t.parts[n][1]):i(t.parts[n]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}function l(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+e(t)})}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+e(t)})}return"Expected "+function(t){var n,e,l,i=new Array(t.length);for(n=0;n<t.length;n++)i[n]=(l=t[n],r[l.type](l));if(i.sort(),i.length>0){for(n=1,e=1;n<i.length;n++)i[n-1]!==i[n]&&(i[e]=i[n],e++);i.length=e}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+l(t)+'"':"end of input"}(n)+" found."},t.exports={SyntaxError:e,parse:function(t,n){n=void 0!==n?n:{};var l,i={},o={statements:Je},s=Je,u=function(t,n){return Ci(t,n,1)},a=function(t){return t},c=function(t,n){return Si.mkAsmLine(t,null,n,Pi())},h=function(t,n){return Si.mkAsmLine(t,n,null,Pi())},f=function(t){return Si.mkAsmLine(t,null,null,Pi())},d=function(t){return Si.mkAsmLine(null,t,null,Pi())},p=function(t){return Si.mkAsmLine(null,t,null,Pi())},m=function(){return Si.mkAsmLine(null,null,null,Pi())},g=function(t){return t},y=function(t){return Si.mkInsn(t,Pi())},v=":",b=Ve(":",!1),w=function(t){return Si.mkLabel(t,Pi())},A=function(t){return Si.mkSetPC(t,Pi())},S=function(t,n){const r="byte"==t?Si.DataSize.Byte:Si.DataSize.Word;return Si.mkData(r,n,Pi())},E=function(t,n){return Si.mkFill(t,n,Pi())},k=function(t){return Si.mkInclude(t,Pi())},C=function(t,n){function r(t,n){return Si.mkKwarg(Si.mkIdent(t,n.loc),n,n.loc)}let e=null,l=null;return null!==n?(e=n[1],l=n[3],Si.mkBinary([r("file",t),r("size",e),r("offset",l)],Pi())):Si.mkBinary([r("file",t)],Pi())},P=function(t){return Si.mkBinary(t,Pi())},x=function(t,n,r,e){const l=[t,...r.map(t=>t.condition)],i=[n,...r.map(t=>t.trueBranch)],o=l.map((t,n)=>[t,i[n]]);return Si.mkIfElse(o,e,Pi())},T="in",$=Ve("in",!1),B=function(t,n,r){return Si.mkFor(t,n,r,Pi())},L=function(t,n,r){return Si.mkMacro(t,n,r,Pi())},_="+",I=Ve("+",!1),R=function(t,n){return Si.mkCallMacro(t,n,Pi())},O=function(t,n){return Si.mkLet(t,n,Pi())},M="as",F=Ve("as",!1),U=function(t,n){return Si.mkLoadPlugin(t,n,Pi())},j=function(t){return Si.mkError(t,Pi())},D=function(t){return Si.mkAlign(t,Pi())},Y=function(t){return Si.mkFilescope(t,Pi())},z=function(t,n){return Si.mkDeclareSegment(t,n,Pi())},N=function(t){return Si.mkUseSegment(t,Pi())},X=function(t){return t},K=function(t,n){return{condition:t,trueBranch:n}},V=function(t){return t},H='"',q=Ve('"',!1),W=function(t){return Si.mkLiteral(t.join(""),Pi())},Q={type:"any"},Z=function(t){return t},G=function(t){return Si.mkIdent(t,Pi())},J=function(t,n){return Ci(t,n,1)},tt=function(t){return Si.mkMacroArg(t)},nt=function(t,n){return Si.mkKwarg(t,n,Pi())},rt=function(t,n){return ki(t,n,null,Pi())},et="x",lt=Ve("x",!1),it=function(t,n){return function(t,n,r){return{...Ei,mnemonic:t,indx:n,loc:r}}(t,n,Pi())},ot="y",st=Ve("y",!1),ut=function(t,n){return function(t,n,r){return{...Ei,mnemonic:t,indy:n,loc:r}}(t,n,Pi())},at=function(t,n){return function(t,n,r){return{...Ei,mnemonic:t,absind:n,loc:r}}(t,n,Pi())},ct=function(t,n,r){return"x"===r?function(t,n,r){return{...Ei,mnemonic:t,absx:n,loc:r}}(t,n,Pi()):function(t,n,r){return{...Ei,mnemonic:t,absy:n,loc:r}}(t,n,Pi())},ht=function(t,n){return ki(t,null,n,Pi())},ft=function(t){return ki(t,null,null,Pi())},dt=function(){return Ke()},pt=function(t){return t},mt="::",gt=Ve("::",!1),yt=function(t,n){return Si.mkScopeQualifiedIdent(Ci(t,n,1),!1,Pi())},vt=function(t,n){return Si.mkScopeQualifiedIdent(Ci(t,n,1),!0,Pi())},bt=function(t){return Si.mkIdent(t,Pi())},wt=function(t){return t},At="#",St=Ve("#",!1),Et=function(t,n){if(null!==t){if("lo"===t)return Si.mkBinaryOp("&",n,Si.mkLiteral(255,Pi(),Pi()));const r=Si.mkLiteral(8,Pi()),e=Si.mkLiteral(255,Pi());return Si.mkBinaryOp("&",Si.mkBinaryOp(">>",n,r,Pi()),e,Pi())}return n},kt=function(){return"lo"},Ct=function(){return"hi"},Pt=function(t){return t},xt=function(t,n){return n.reduce(function(t,n){return Si.mkBinaryOp(n[0],t,n[1],Pi())},t)},Tt=function(t,n){return Si.mkUnary(t,n,Pi())},$t=function(t){return t},Bt=function(t,n){return{property:n,computed:!0}},Lt=function(t,n){return{property:Si.mkIdent(n,Pi()),computed:!1}},_t=function(t,n){return n.reduce(function(t,n){return Si.mkMember(t,n.property,n.computed,Pi())},t)},It=function(t,n){return Si.mkCallFunc(t,n,Pi())},Rt=function(t){return Si.mkLiteral(t,Pi())},Ot=function(t){return t},Mt=function(t){return t},Ft="$",Ut=Ve("$",!1),jt=function(t){return parseInt(t,16)},Dt="%",Yt=Ve("%",!1),zt=function(t){return parseInt(t,2)},Nt=function(t){return t},Xt=function(){return Si.mkGetCurPC(Pi())},Kt=".",Vt=Ve(".",!1),Ht=function(){return parseFloat(Ke())},qt="0",Wt=Ve("0",!1),Qt=/^[1-9]/,Zt=He([["1","9"]],!1,!1),Gt="e",Jt=Ve("e",!0),tn=/^[+\-]/,nn=He(["+","-"],!1,!1),rn=function(t){return Si.mkExprArray(null===t?[]:t,Pi())},en=function(){return Si.mkExprObject([],Pi())},ln=function(t){return Si.mkExprObject(t,Pi())},on=function(t,n){return Ci(t,n,2)},sn=function(t,n){return{key:t,val:n}},un=function(t){return Si.mkStmtExpr(t,Pi())},an=function(t,n){return Si.mkAssign(t,n,Pi())},cn=/^[a-zA-Z_]/,hn=He([["a","z"],["A","Z"],"_"],!1,!1),fn=/^[a-zA-Z_0-9]/,dn=He([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),pn=/^[0-9]/,mn=He([["0","9"]],!1,!1),gn=/^[0-1]/,yn=He([["0","1"]],!1,!1),vn=/^[0-9a-f]/i,bn=He([["0","9"],["a","f"]],!1,!0),wn=qe("whitespace"),An="\t",Sn=Ve("\t",!1),En="\v",kn=Ve("\v",!1),Cn="\f",Pn=Ve("\f",!1),xn=" ",Tn=Ve(" ",!1),$n="",Bn=Ve("",!1),Ln="\ufeff",_n=Ve("\ufeff",!1),In=/^[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,Rn=He([" ","","",["",""],"","",""],!1,!1),On=";",Mn=Ve(";",!1),Fn=/^[\n\r]/,Un=He(["\n","\r"],!1,!1),jn=qe("end of line"),Dn="\n",Yn=Ve("\n",!1),zn="\r\n",Nn=Ve("\r\n",!1),Xn="\r",Kn=Ve("\r",!1),Vn="!align",Hn=Ve("!align",!1),qn="!byte",Wn=Ve("!byte",!1),Qn=function(){return"byte"},Zn="!word",Gn=Ve("!word",!1),Jn=function(){return"word"},tr="!binary",nr=Ve("!binary",!1),rr="!let",er=Ve("!let",!1),lr="!macro",ir=Ve("!macro",!1),or="!if",sr=Ve("!if",!1),ur="else",ar=Ve("else",!1),cr="elif",hr=Ve("elif",!1),fr="!error",dr=Ve("!error",!1),pr="!for",mr=Ve("!for",!1),gr="!include",yr=Ve("!include",!1),vr="!fill",br=Ve("!fill",!1),wr="!use",Ar=Ve("!use",!1),Sr="!filescope",Er=Ve("!filescope",!1),kr="!segment",Cr=Ve("!segment",!1),Pr="!!",xr=Ve("!!",!1),Tr="[",$r=Ve("[",!1),Br=function(t){return t},Lr="]",_r=Ve("]",!1),Ir="(",Rr=Ve("(",!1),Or=")",Mr=Ve(")",!1),Fr="{",Ur=Ve("{",!1),jr="}",Dr=Ve("}",!1),Yr=(Ve("->",!1),Ve("++",!1),Ve("--",!1),"&"),zr=Ve("&",!1),Nr=/^[&]/,Xr=He(["&"],!1,!1),Kr="*",Vr=Ve("*",!1),Hr=/^[=]/,qr=He(["="],!1,!1),Wr=/^[+=]/,Qr=He(["+","="],!1,!1),Zr="-",Gr=Ve("-",!1),Jr=/^[\-=>]/,te=He(["-","=",">"],!1,!1),ne="~",re=Ve("~",!1),ee="!",le=Ve("!",!1),ie="/",oe=Ve("/",!1),se=/^[=>]/,ue=He(["=",">"],!1,!1),ae="<<",ce=Ve("<<",!1),he=">>",fe=Ve(">>",!1),de="<",pe=Ve("<",!1),me=">",ge=Ve(">",!1),ye="<=",ve=Ve("<=",!1),be=">=",we=Ve(">=",!1),Ae="==",Se=Ve("==",!1),Ee="!=",ke=Ve("!=",!1),Ce="^",Pe=Ve("^",!1),xe="|",Te=Ve("|",!1),$e="&&",Be=Ve("&&",!1),Le="||",_e=Ve("||",!1),Ie=(Ve("?",!1),/^[>]/),Re=He([">"],!1,!1),Oe=(Ve("...",!1),"="),Me=Ve("=",!1),Fe=(Ve("*=",!1),Ve("/=",!1),Ve("%=",!1),Ve("+=",!1),Ve("-=",!1),Ve("<<=",!1),Ve(">>=",!1),Ve("&=",!1),Ve("^=",!1),Ve("|=",!1),","),Ue=Ve(",",!1),je=0,De=0,Ye=[{line:1,column:1}],ze=0,Ne=[],Xe=0;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=o[n.startRule]}function Ke(){return t.substring(De,je)}function Ve(t,n){return{type:"literal",text:t,ignoreCase:n}}function He(t,n,r){return{type:"class",parts:t,inverted:n,ignoreCase:r}}function qe(t){return{type:"other",description:t}}function We(n){var r,e=Ye[n];if(e)return e;for(r=n-1;!Ye[r];)r--;for(e={line:(e=Ye[r]).line,column:e.column};r<n;)10===t.charCodeAt(r)?(e.line++,e.column=1):e.column++,r++;return Ye[n]=e,e}function Qe(t,n){var r=We(t),e=We(n);return{start:{offset:t,line:r.line,column:r.column},end:{offset:n,line:e.line,column:e.column}}}function Ze(t){je<ze||(je>ze&&(ze=je,Ne=[]),Ne.push(t))}function Ge(t,n,r){return new e(e.buildMessage(t,n),t,n,r)}function Je(){var t,n,r,e,l,o;if(t=je,(n=tl())!==i){for(r=[],e=je,(l=Kl())!==i&&(o=tl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=Kl())!==i&&(o=tl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=u(n,r)):(je=t,t=i)}else je=t,t=i;return t}function tl(){var t,n,r;return t=je,Yl()!==i&&(n=function(){var t,n,r,e;return t=je,(n=rl())!==i&&(r=Jl())!==i&&(e=Je())!==i&&ti()!==i?(De=t,n=c(n,e),t=n):(je=t,t=i),t===i&&(t=je,(n=rl())!==i&&(r=nl())!==i?(De=t,n=h(n,r),t=n):(je=t,t=i),t===i&&(t=je,(n=rl())!==i&&(De=t,n=f(n)),(t=n)===i&&(t=je,(n=nl())!==i&&(De=t,n=d(n)),(t=n)===i&&(t=je,(n=function(){var t,n,r;return t=je,(n=ei())!==i&&wi()!==i&&(r=Pl())!==i?(De=t,n=A(r),t=n):(je=t,t=i),t}())!==i&&(De=t,n=p(n)),(t=n)===i&&(t=je,(n=Yl())!==i&&(De=t,n=m()),t=n))))),t}())!==i?((r=Xl())===i&&(r=null),r!==i?(De=t,t=a(n)):(je=t,t=i)):(je=t,t=i),t}function nl(){var n,r;return n=je,(r=function(){var n,r,e,l,o,s,u,a,c,h;if(n=je,(r=function(){var n,r;return n=je,t.substr(je,5)===qn?(r=qn,je+=5):(r=i,0===Xe&&Ze(Wn)),r!==i&&Yl()!==i?(De=n,r=Qn(),n=r):(je=n,n=i),n}())===i&&(r=function(){var n,r;return n=je,t.substr(je,5)===Zn?(r=Zn,je+=5):(r=i,0===Xe&&Ze(Gn)),r!==i&&Yl()!==i?(De=n,r=Jn(),n=r):(je=n,n=i),n}()),r!==i&&(e=al())!==i?(De=n,r=S(r,e),n=r):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,5)===vr?(r=vr,je+=5):(r=i,0===Xe&&Ze(br)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=Pl())!==i&&(l=Ai())!==i&&(o=Pl())!==i?(De=n,r=E(e,o),n=r):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,8)===gr?(r=gr,je+=8):(r=i,0===Xe&&Ze(yr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=Pl())!==i?(De=n,r=k(e),n=r):(je=n,n=i),n===i&&(n=je,(r=Hl())!==i&&(e=Pl())!==i?(l=je,(o=Ai())!==i?((s=Pl())===i&&(s=null),s!==i&&(u=Ai())!==i&&(a=Pl())!==i?l=o=[o,s,u,a]:(je=l,l=i)):(je=l,l=i),l===i&&(l=null),l!==i?(De=n,r=C(e,l),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=Hl())!==i&&(e=Zl())!==i&&(l=sl())!==i&&(o=Gl())!==i?(De=n,r=P(l),n=r):(je=n,n=i),n===i))))){if(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,3)===or?(r=or,je+=3):(r=i,0===Xe&&Ze(sr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i)if((e=Zl())!==i)if((l=Pl())!==i)if((o=Gl())!==i)if((s=Jl())!==i)if((u=Je())!==i)if((a=ti())!==i){for(c=[],h=el();h!==i;)c.push(h),h=el();c!==i?((h=function(){var n,r,e;return n=je,(r=function(){var n,r,e;return n=je,t.substr(je,4)===ur?(r=ur,je+=4):(r=i,0===Xe&&Ze(ar)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&Jl()!==i&&(e=Je())!==i&&ti()!==i?(De=n,r=V(e),n=r):(je=n,n=i),n}())===i&&(h=null),h!==i?(De=n,r=x(l,u,c,h),n=r):(je=n,n=i)):(je=n,n=i)}else je=n,n=i;else je=n,n=i;else je=n,n=i;else je=n,n=i;else je=n,n=i;else je=n,n=i;else je=n,n=i;n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,4)===pr?(r=pr,je+=4):(r=i,0===Xe&&Ze(mr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=dl())!==i?(t.substr(je,2)===T?(l=T,je+=2):(l=i,0===Xe&&Ze($)),l!==i&&(o=Yl())!==i&&(s=Pl())!==i&&(u=Jl())!==i&&(a=Je())!==i&&(c=ti())!==i?(De=n,r=B(e,s,a),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,6)===lr?(r=lr,je+=6):(r=i,0===Xe&&Ze(ir)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=function(){var t,n;return t=je,(n=pl())!==i&&(De=t,n=G(n)),t=n}())!==i&&(l=Zl())!==i?((o=function(){var t,n,r,e,l,o;if(t=je,(n=ol())!==i){for(r=[],e=je,(l=Ai())!==i&&(o=ol())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=Ai())!==i&&(o=ol())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,n=J(n,r),t=n):(je=t,t=i)}else je=t,t=i;return t}())===i&&(o=null),o!==i&&(s=Gl())!==i&&(u=Jl())!==i&&(a=Je())!==i&&(c=ti())!==i?(De=n,r=L(e,o,a),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,43===t.charCodeAt(je)?(r=_,je++):(r=i,0===Xe&&Ze(I)),r!==i&&(e=fl())!==i&&(l=Zl())!==i?((o=al())===i&&(o=null),o!==i&&(s=Gl())!==i?(De=n,r=R(e,o),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,4)===rr?(r=rr,je+=4):(r=i,0===Xe&&Ze(er)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=dl())!==i&&(l=wi())!==i&&(o=Pl())!==i?(De=n,r=O(e,o),n=r):(je=n,n=i),n===i&&(n=Ol())===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,4)===wr?(r=wr,je+=4):(r=i,0===Xe&&Ze(Ar)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=ll())!==i?(t.substr(je,2)===M?(l=M,je+=2):(l=i,0===Xe&&Ze(F)),l!==i&&(o=Yl())!==i&&(s=dl())!==i?(De=n,r=U(e,s),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,6)===fr?(r=fr,je+=6):(r=i,0===Xe&&Ze(dr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=ll())!==i?(De=n,r=j(e),n=r):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,6)===Vn?(r=Vn,je+=6):(r=i,0===Xe&&Ze(Hn)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=Pl())!==i?(De=n,r=D(e),n=r):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,10)===Sr?(r=Sr,je+=10):(r=i,0===Xe&&Ze(Er)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=dl())!==i?(De=n,r=Y(e),n=r):(je=n,n=i),n===i&&(n=je,(r=ql())!==i&&(e=dl())!==i&&(l=Zl())!==i&&(o=sl())!==i&&(s=Gl())!==i?(De=n,r=z(e,o),n=r):(je=n,n=i),n===i&&(n=je,(r=ql())!==i&&(e=fl())!==i?(De=n,r=N(e),n=r):(je=n,n=i),n===i&&(n=je,(r=function(){var n,r,e;return n=je,t.substr(je,2)===Pr?(r=Pr,je+=2):(r=i,0===Xe&&Ze(xr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}())!==i&&(e=function(){var t,n;return(t=Ol())===i&&(t=je,(n=Pl())!==i&&(De=t,n=un(n)),t=n),t}())!==i?(De=n,r=X(e),n=r):(je=n,n=i))))))))))))}return n}())!==i&&(De=n,r=g(r)),(n=r)===i&&(n=je,(r=function(){var n,r,e,l,o,s,u;return n=je,(r=ml())!==i&&(e=function(){var n,r,e,l;return n=je,35===t.charCodeAt(je)?(r=At,je++):(r=i,0===Xe&&Ze(St)),r!==i?((e=function(){var t,n;return t=je,(n=ci())!==i&&(De=t,n=kt()),(t=n)===i&&(t=je,(n=hi())!==i&&(De=t,n=Ct()),t=n),t}())===i&&(e=null),e!==i&&(l=Pl())!==i?(De=n,r=Et(e,l),n=r):(je=n,n=i)):(je=n,n=i),n}())!==i?(De=n,r=rt(r,e),n=r):(je=n,n=i),n===i&&(n=je,(r=ml())!==i&&(e=Zl())!==i&&(l=gl())!==i&&(o=Ai())!==i?(120===t.charCodeAt(je)?(s=et,je++):(s=i,0===Xe&&Ze(lt)),s!==i&&(u=Yl())!==i&&Gl()!==i?(De=n,r=it(r,l),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=ml())!==i&&(e=Zl())!==i&&(l=gl())!==i&&(o=Gl())!==i&&(s=Ai())!==i?(121===t.charCodeAt(je)?(u=ot,je++):(u=i,0===Xe&&Ze(st)),u!==i&&Yl()!==i?(De=n,r=ut(r,l),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=ml())!==i&&(e=Zl())!==i&&(l=gl())!==i&&(o=Gl())!==i?(De=n,r=at(r,l),n=r):(je=n,n=i),n===i&&(n=je,(r=ml())!==i&&(e=gl())!==i&&(l=Ai())!==i?(120===t.charCodeAt(je)?(o=et,je++):(o=i,0===Xe&&Ze(lt)),o===i&&(121===t.charCodeAt(je)?(o=ot,je++):(o=i,0===Xe&&Ze(st))),o!==i&&(s=Yl())!==i?(De=n,r=ct(r,e,o),n=r):(je=n,n=i)):(je=n,n=i),n===i&&(n=je,(r=ml())!==i&&(e=gl())!==i?(De=n,r=ht(r,e),n=r):(je=n,n=i),n===i&&(n=je,(r=ml())!==i&&(De=n,r=ft(r)),n=r)))))),n}())!==i&&(De=n,r=y(r)),n=r),n}function rl(){var n,r,e;return n=je,(r=cl())!==i?(58===t.charCodeAt(je)?(e=v,je++):(e=i,0===Xe&&Ze(b)),e!==i&&Yl()!==i?(De=n,n=r=w(r)):(je=n,n=i)):(je=n,n=i),n}function el(){var n,r,e;return n=je,function(){var n,r,e;return n=je,t.substr(je,4)===cr?(r=cr,je+=4):(r=i,0===Xe&&Ze(hr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}()!==i&&Zl()!==i&&(r=Pl())!==i&&Gl()!==i&&Jl()!==i&&(e=Je())!==i&&ti()!==i?(De=n,n=K(r,e)):(je=n,n=i),n}function ll(){var n,r,e,l;if(n=je,34===t.charCodeAt(je)?(r=H,je++):(r=i,0===Xe&&Ze(q)),r!==i){for(e=[],l=il();l!==i;)e.push(l),l=il();e!==i?(34===t.charCodeAt(je)?(l=H,je++):(l=i,0===Xe&&Ze(q)),l!==i&&Yl()!==i?(De=n,n=r=W(e)):(je=n,n=i)):(je=n,n=i)}else je=n,n=i;return n}function il(){var n,r,e;return n=je,r=je,Xe++,34===t.charCodeAt(je)?(e=H,je++):(e=i,0===Xe&&Ze(q)),Xe--,e===i?r=void 0:(je=r,r=i),r!==i?(t.length>je?(e=t.charAt(je),je++):(e=i,0===Xe&&Ze(Q)),e!==i?(De=n,n=r=Z(e)):(je=n,n=i)):(je=n,n=i),n}function ol(){var t,n;return t=je,(n=dl())!==i&&(De=t,n=tt(n)),t=n}function sl(){var t,n,r,e,l,o;if(t=je,(n=ul())!==i){for(r=[],e=je,(l=Ai())!==i&&(o=ul())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=Ai())!==i&&(o=ul())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=J(n,r)):(je=t,t=i)}else je=t,t=i;return t}function ul(){var t,n,r;return t=je,(n=dl())!==i&&wi()!==i&&(r=Pl())!==i?(De=t,t=n=nt(n,r)):(je=t,t=i),t}function al(){var t,n,r,e,l,o;if(t=je,(n=Pl())!==i){for(r=[],e=je,(l=Ai())!==i&&(o=Pl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=Ai())!==i&&(o=Pl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=J(n,r)):(je=t,t=i)}else je=t,t=i;return t}function cl(){var t,n,r,e,l;if(t=je,n=je,r=[],(e=Ml())!==i)for(;e!==i;)r.push(e),e=Ml();else r=i;if(r!==i){for(e=[],l=Fl();l!==i;)e.push(l),l=Fl();e!==i?n=r=[r,e]:(je=n,n=i)}else je=n,n=i;return n!==i&&(De=t,n=dt()),t=n}function hl(){var t,n;return t=je,(n=cl())!==i&&Yl()!==i?(De=t,t=n=pt(n)):(je=t,t=i),t}function fl(){var n,r,e,l,o,s,u;if(n=je,(r=cl())!==i){for(e=[],l=je,t.substr(je,2)===mt?(o=mt,je+=2):(o=i,0===Xe&&Ze(gt)),o!==i&&(s=cl())!==i?l=o=[o,s]:(je=l,l=i);l!==i;)e.push(l),l=je,t.substr(je,2)===mt?(o=mt,je+=2):(o=i,0===Xe&&Ze(gt)),o!==i&&(s=cl())!==i?l=o=[o,s]:(je=l,l=i);e!==i&&(l=Yl())!==i?(De=n,n=r=yt(r,e)):(je=n,n=i)}else je=n,n=i;if(n===i)if(n=je,t.substr(je,2)===mt?(r=mt,je+=2):(r=i,0===Xe&&Ze(gt)),r!==i)if((e=cl())!==i){for(l=[],o=je,t.substr(je,2)===mt?(s=mt,je+=2):(s=i,0===Xe&&Ze(gt)),s!==i&&(u=cl())!==i?o=s=[s,u]:(je=o,o=i);o!==i;)l.push(o),o=je,t.substr(je,2)===mt?(s=mt,je+=2):(s=i,0===Xe&&Ze(gt)),s!==i&&(u=cl())!==i?o=s=[s,u]:(je=o,o=i);l!==i&&(o=Yl())!==i?(De=n,n=r=vt(e,l)):(je=n,n=i)}else je=n,n=i;else je=n,n=i;return n}function dl(){var t,n;return t=je,(n=pl())!==i&&(De=t,n=bt(n)),t=n}function pl(){var t,n;return t=je,(n=cl())!==i&&Yl()!==i?(De=t,t=n=wt(n)):(je=t,t=i),t}function ml(){var t,n;return t=je,(n=cl())!==i&&Yl()!==i?(De=t,t=n=pt(n)):(je=t,t=i),t}function gl(){var t,n;return t=je,(n=Pl())!==i&&(De=t,n=Pt(n)),t=n}function yl(){var t,n,r,e,l,o;if(t=je,(n=xl())!==i){for(r=[],e=je,(l=ei())===i&&(l=oi())===i&&(l=si()),l!==i&&(o=xl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=ei())===i&&(l=oi())===i&&(l=si()),l!==i&&(o=xl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t===i&&(t=$l()),t}function vl(){var t,n,r,e,l,o;if(t=je,(n=yl())!==i){for(r=[],e=je,(l=li())===i&&(l=ii()),l!==i&&(o=yl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=li())===i&&(l=ii()),l!==i&&(o=yl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function bl(){var t,n,r,e,l,o;if(t=je,(n=vl())!==i){for(r=[],e=je,(l=ui())===i&&(l=ai()),l!==i&&(o=vl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=ui())===i&&(l=ai()),l!==i&&(o=vl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function wl(){var t,n,r,e,l,o;if(t=je,(n=bl())!==i){for(r=[],e=je,(l=fi())===i&&(l=di())===i&&(l=ci())===i&&(l=hi()),l!==i&&(o=bl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=fi())===i&&(l=di())===i&&(l=ci())===i&&(l=hi()),l!==i&&(o=bl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function Al(){var t,n,r,e,l,o;if(t=je,(n=wl())!==i){for(r=[],e=je,(l=pi())===i&&(l=mi()),l!==i&&(o=wl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=pi())===i&&(l=mi()),l!==i&&(o=wl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function Sl(){var t,n,r,e,l,o;if(t=je,(n=Al())!==i){for(r=[],e=je,(l=ri())!==i&&(o=Al())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=ri())!==i&&(o=Al())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function El(){var t,n,r,e,l,o;if(t=je,(n=Sl())!==i){for(r=[],e=je,(l=gi())!==i&&(o=Sl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=gi())!==i&&(o=Sl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function kl(){var t,n,r,e,l,o;if(t=je,(n=El())!==i){for(r=[],e=je,(l=yi())!==i&&(o=El())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=yi())!==i&&(o=El())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function Cl(){var t,n,r,e,l,o;if(t=je,(n=kl())!==i){for(r=[],e=je,(l=vi())!==i&&(o=kl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=vi())!==i&&(o=kl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function Pl(){var t,n,r,e,l,o;if(t=je,(n=Cl())!==i){for(r=[],e=je,(l=bi())!==i&&(o=Cl())!==i?e=l=[l,o]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=bi())!==i&&(o=Cl())!==i?e=l=[l,o]:(je=e,e=i);r!==i?(De=t,t=n=xt(n,r)):(je=t,t=i)}else je=t,t=i;return t}function xl(){var n,r,e;return(n=function(){var t;return(t=function(){var t,n,r;return t=je,(n=Tl())!==i&&Zl()!==i?((r=al())===i&&(r=null),r!==i&&Gl()!==i?(De=t,n=It(n,r),t=n):(je=t,t=i)):(je=t,t=i),t}())===i&&(t=Tl()),t}())===i&&(n=je,(r=function(){var n,r;return n=je,(r=li())===i&&(r=ii())===i&&(r=function(){var n,r;return n=je,126===t.charCodeAt(je)?(r=ne,je++):(r=i,0===Xe&&Ze(re)),r!==i&&Yl()!==i?(De=n,r=Br(r),n=r):(je=n,n=i),n}())===i&&(r=function(){var n,r,e,l;return n=je,33===t.charCodeAt(je)?(r=ee,je++):(r=i,0===Xe&&Ze(le)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,r=Br(r),n=r):(je=n,n=i)):(je=n,n=i),n}()),r!==i&&(De=n,r=$t(r)),n=r}())!==i&&(e=xl())!==i?(De=n,n=r=Tt(r,e)):(je=n,n=i)),n}function Tl(){var t,n,r,e,l;if(t=je,(n=$l())!==i){for(r=[],e=je,Wl()!==i&&(l=Pl())!==i&&Ql()!==i?(De=e,e=Bt(n,l)):(je=e,e=i),e===i&&(e=je,ni()!==i&&(l=hl())!==i?(De=e,e=Lt(n,l)):(je=e,e=i));e!==i;)r.push(e),e=je,Wl()!==i&&(l=Pl())!==i&&Ql()!==i?(De=e,e=Bt(n,l)):(je=e,e=i),e===i&&(e=je,ni()!==i&&(l=hl())!==i?(De=e,e=Lt(n,l)):(je=e,e=i));r!==i?(De=t,t=n=_t(n,r)):(je=t,t=i)}else je=t,t=i;return t}function $l(){var t,n,r;return t=je,(n=Bl())!==i&&(De=t,n=Rt(n)),(t=n)===i&&(t=je,(n=fl())!==i&&(De=t,n=pt(n)),(t=n)===i&&(t=je,(n=ll())!==i&&(De=t,n=Ot(n)),(t=n)===i&&(t=function(){var t,n,r;return t=je,(n=Wl())!==i?((r=al())===i&&(r=null),r!==i&&Ql()!==i?(De=t,n=rn(r),t=n):(je=t,t=i)):(je=t,t=i),t}())===i&&(t=function(){var t,n,r;return t=je,(n=Jl())!==i&&Nl()!==i&&(r=ti())!==i?(De=t,n=en(),t=n):(je=t,t=i),t===i&&(t=je,(n=Jl())!==i&&Nl()!==i&&(r=Il())!==i&&Nl()!==i&&ti()!==i?(De=t,n=ln(r),t=n):(je=t,t=i),t===i&&(t=je,(n=Jl())!==i&&Nl()!==i&&(r=Il())!==i&&Nl()!==i&&Ai()!==i&&Nl()!==i&&ti()!==i?(De=t,n=ln(r),t=n):(je=t,t=i))),t}())===i&&(t=function(){var t,n;return t=je,(n=ei())!==i&&(De=t,n=Xt()),t=n}())===i&&(t=je,(n=Zl())!==i&&(r=Pl())!==i&&Gl()!==i?(De=t,t=n=Mt(r)):(je=t,t=i)))),t}function Bl(){var n,r,e,l,o;if(n=je,36===t.charCodeAt(je)?(r=Ft,je++):(r=i,0===Xe&&Ze(Ut)),r!==i){if(e=je,l=[],(o=Dl())!==i)for(;o!==i;)l.push(o),o=Dl();else l=i;(e=l!==i?t.substring(e,je):l)!==i&&(l=Yl())!==i?(De=n,n=r=jt(e)):(je=n,n=i)}else je=n,n=i;if(n===i){if(n=je,37===t.charCodeAt(je)?(r=Dt,je++):(r=i,0===Xe&&Ze(Yt)),r!==i){if(e=je,l=[],(o=jl())!==i)for(;o!==i;)l.push(o),o=jl();else l=i;(e=l!==i?t.substring(e,je):l)!==i&&(l=Yl())!==i?(De=n,n=r=zt(e)):(je=n,n=i)}else je=n,n=i;n===i&&(n=je,(r=function(){var n,r,e,l,o;if(n=je,(r=Ll())!==i)if(46===t.charCodeAt(je)?(e=Kt,je++):(e=i,0===Xe&&Ze(Vt)),e!==i){for(l=[],o=Ul();o!==i;)l.push(o),o=Ul();l!==i?((o=_l())===i&&(o=null),o!==i?(De=n,r=Ht(),n=r):(je=n,n=i)):(je=n,n=i)}else je=n,n=i;else je=n,n=i;if(n===i){if(n=je,46===t.charCodeAt(je)?(r=Kt,je++):(r=i,0===Xe&&Ze(Vt)),r!==i){if(e=[],(l=Ul())!==i)for(;l!==i;)e.push(l),l=Ul();else e=i;e!==i?((l=_l())===i&&(l=null),l!==i?(De=n,r=Ht(),n=r):(je=n,n=i)):(je=n,n=i)}else je=n,n=i;n===i&&(n=je,(r=Ll())!==i?((e=_l())===i&&(e=null),e!==i?(De=n,r=Ht(),n=r):(je=n,n=i)):(je=n,n=i))}return n}())!==i&&(e=Yl())!==i?(De=n,n=r=Nt(r)):(je=n,n=i))}return n}function Ll(){var n,r,e,l;if(48===t.charCodeAt(je)?(n=qt,je++):(n=i,0===Xe&&Ze(Wt)),n===i)if(n=je,(r=function(){var n;return Qt.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(Zt)),n}())!==i){for(e=[],l=Ul();l!==i;)e.push(l),l=Ul();e!==i?n=r=[r,e]:(je=n,n=i)}else je=n,n=i;return n}function _l(){var n,r,e;return n=je,(r=function(){var n;return t.substr(je,1).toLowerCase()===Gt?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(Jt)),n}())!==i&&(e=function(){var n,r,e,l;if(n=je,tn.test(t.charAt(je))?(r=t.charAt(je),je++):(r=i,0===Xe&&Ze(nn)),r===i&&(r=null),r!==i){if(e=[],(l=Ul())!==i)for(;l!==i;)e.push(l),l=Ul();else e=i;e!==i?n=r=[r,e]:(je=n,n=i)}else je=n,n=i;return n}())!==i?n=r=[r,e]:(je=n,n=i),n}function Il(){var t,n,r,e,l,o,s;if(t=je,(n=Rl())!==i){for(r=[],e=je,(l=Ai())!==i&&(o=Nl())!==i&&(s=Rl())!==i?e=l=[l,o,s]:(je=e,e=i);e!==i;)r.push(e),e=je,(l=Ai())!==i&&(o=Nl())!==i&&(s=Rl())!==i?e=l=[l,o,s]:(je=e,e=i);r!==i?(De=t,t=n=on(n,r)):(je=t,t=i)}else je=t,t=i;return t}function Rl(){var n,r,e;return n=je,(r=function(){var t,n;return(t=dl())===i&&(t=ll())===i&&(t=je,(n=Bl())!==i&&(De=t,n=Rt(n)),t=n),t}())!==i&&function(){var n,r,e,l;return n=je,58===t.charCodeAt(je)?(r=v,je++):(r=i,0===Xe&&Ze(b)),r!==i?(e=je,Xe++,Ie.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(Re)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,r=Br(r),n=r):(je=n,n=i)):(je=n,n=i),n}()!==i&&(e=Pl())!==i?(De=n,n=r=sn(r,e)):(je=n,n=i),n}function Ol(){var t,n,r;return t=je,(n=fl())!==i&&wi()!==i&&(r=Pl())!==i?(De=t,t=n=an(n,r)):(je=t,t=i),t}function Ml(){var n;return cn.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(hn)),n}function Fl(){var n;return fn.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(dn)),n}function Ul(){var n;return pn.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(mn)),n}function jl(){var n;return gn.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(yn)),n}function Dl(){var n;return vn.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(bn)),n}function Yl(){var t,n;for(Xe++,t=[],n=zl();n!==i;)t.push(n),n=zl();return Xe--,t===i&&(n=i,0===Xe&&Ze(wn)),t}function zl(){var n;return Xe++,9===t.charCodeAt(je)?(n=An,je++):(n=i,0===Xe&&Ze(Sn)),n===i&&(11===t.charCodeAt(je)?(n=En,je++):(n=i,0===Xe&&Ze(kn)),n===i&&(12===t.charCodeAt(je)?(n=Cn,je++):(n=i,0===Xe&&Ze(Pn)),n===i&&(32===t.charCodeAt(je)?(n=xn,je++):(n=i,0===Xe&&Ze(Tn)),n===i&&(160===t.charCodeAt(je)?(n=$n,je++):(n=i,0===Xe&&Ze(Bn)),n===i&&(65279===t.charCodeAt(je)?(n=Ln,je++):(n=i,0===Xe&&Ze(_n)),n===i&&(n=function(){var n;return In.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(Rn)),n}())))))),Xe--,n===i&&0===Xe&&Ze(wn),n}function Nl(){var t,n;for(t=[],(n=zl())===i&&(n=Vl())===i&&(n=Xl());n!==i;)t.push(n),(n=zl())===i&&(n=Vl())===i&&(n=Xl());return t}function Xl(){var n,r,e,l,o,s;if(n=je,59===t.charCodeAt(je)?(r=On,je++):(r=i,0===Xe&&Ze(Mn)),r!==i){for(e=[],l=je,o=je,Xe++,s=Kl(),Xe--,s===i?o=void 0:(je=o,o=i),o!==i?(t.length>je?(s=t.charAt(je),je++):(s=i,0===Xe&&Ze(Q)),s!==i?l=o=[o,s]:(je=l,l=i)):(je=l,l=i);l!==i;)e.push(l),l=je,o=je,Xe++,s=Kl(),Xe--,s===i?o=void 0:(je=o,o=i),o!==i?(t.length>je?(s=t.charAt(je),je++):(s=i,0===Xe&&Ze(Q)),s!==i?l=o=[o,s]:(je=l,l=i)):(je=l,l=i);e!==i?n=r=[r,e]:(je=n,n=i)}else je=n,n=i;return n}function Kl(){var n;return Fn.test(t.charAt(je))?(n=t.charAt(je),je++):(n=i,0===Xe&&Ze(Un)),n}function Vl(){var n;return Xe++,10===t.charCodeAt(je)?(n=Dn,je++):(n=i,0===Xe&&Ze(Yn)),n===i&&(t.substr(je,2)===zn?(n=zn,je+=2):(n=i,0===Xe&&Ze(Nn)),n===i&&(13===t.charCodeAt(je)?(n=Xn,je++):(n=i,0===Xe&&Ze(Kn)))),Xe--,n===i&&0===Xe&&Ze(jn),n}function Hl(){var n,r,e;return n=je,t.substr(je,7)===tr?(r=tr,je+=7):(r=i,0===Xe&&Ze(nr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}function ql(){var n,r,e;return n=je,t.substr(je,8)===kr?(r=kr,je+=8):(r=i,0===Xe&&Ze(Cr)),r!==i&&(e=Yl())!==i?n=r=[r,e]:(je=n,n=i),n}function Wl(){var n,r;return n=je,91===t.charCodeAt(je)?(r=Tr,je++):(r=i,0===Xe&&Ze($r)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function Ql(){var n,r;return n=je,93===t.charCodeAt(je)?(r=Lr,je++):(r=i,0===Xe&&Ze(_r)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function Zl(){var n,r;return n=je,40===t.charCodeAt(je)?(r=Ir,je++):(r=i,0===Xe&&Ze(Rr)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function Gl(){var n,r;return n=je,41===t.charCodeAt(je)?(r=Or,je++):(r=i,0===Xe&&Ze(Mr)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function Jl(){var n,r;return n=je,123===t.charCodeAt(je)?(r=Fr,je++):(r=i,0===Xe&&Ze(Ur)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function ti(){var n,r;return n=je,125===t.charCodeAt(je)?(r=jr,je++):(r=i,0===Xe&&Ze(Dr)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function ni(){var n,r;return n=je,46===t.charCodeAt(je)?(r=Kt,je++):(r=i,0===Xe&&Ze(Vt)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function ri(){var n,r,e,l;return n=je,38===t.charCodeAt(je)?(r=Yr,je++):(r=i,0===Xe&&Ze(zr)),r!==i?(e=je,Xe++,Nr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(Xr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function ei(){var n,r,e,l;return n=je,42===t.charCodeAt(je)?(r=Kr,je++):(r=i,0===Xe&&Ze(Vr)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function li(){var n,r,e,l;return n=je,43===t.charCodeAt(je)?(r=_,je++):(r=i,0===Xe&&Ze(I)),r!==i?(e=je,Xe++,Wr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(Qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function ii(){var n,r,e,l;return n=je,45===t.charCodeAt(je)?(r=Zr,je++):(r=i,0===Xe&&Ze(Gr)),r!==i?(e=je,Xe++,Jr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(te)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function oi(){var n,r,e,l;return n=je,47===t.charCodeAt(je)?(r=ie,je++):(r=i,0===Xe&&Ze(oe)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function si(){var n,r,e,l;return n=je,37===t.charCodeAt(je)?(r=Dt,je++):(r=i,0===Xe&&Ze(Yt)),r!==i?(e=je,Xe++,se.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(ue)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function ui(){var n,r,e,l;return n=je,t.substr(je,2)===ae?(r=ae,je+=2):(r=i,0===Xe&&Ze(ce)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function ai(){var n,r,e,l;return n=je,t.substr(je,2)===he?(r=he,je+=2):(r=i,0===Xe&&Ze(fe)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function ci(){var n,r,e,l;return n=je,60===t.charCodeAt(je)?(r=de,je++):(r=i,0===Xe&&Ze(pe)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function hi(){var n,r,e,l;return n=je,62===t.charCodeAt(je)?(r=me,je++):(r=i,0===Xe&&Ze(ge)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function fi(){var n,r;return n=je,t.substr(je,2)===ye?(r=ye,je+=2):(r=i,0===Xe&&Ze(ve)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function di(){var n,r;return n=je,t.substr(je,2)===be?(r=be,je+=2):(r=i,0===Xe&&Ze(we)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function pi(){var n,r;return n=je,t.substr(je,2)===Ae?(r=Ae,je+=2):(r=i,0===Xe&&Ze(Se)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function mi(){var n,r;return n=je,t.substr(je,2)===Ee?(r=Ee,je+=2):(r=i,0===Xe&&Ze(ke)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function gi(){var n,r,e,l;return n=je,94===t.charCodeAt(je)?(r=Ce,je++):(r=i,0===Xe&&Ze(Pe)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function yi(){var n,r,e,l;return n=je,124===t.charCodeAt(je)?(r=xe,je++):(r=i,0===Xe&&Ze(Te)),r!==i?(e=je,Xe++,Hr.test(t.charAt(je))?(l=t.charAt(je),je++):(l=i,0===Xe&&Ze(qr)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function vi(){var n,r;return n=je,t.substr(je,2)===$e?(r=$e,je+=2):(r=i,0===Xe&&Ze(Be)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function bi(){var n,r;return n=je,t.substr(je,2)===Le?(r=Le,je+=2):(r=i,0===Xe&&Ze(_e)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}function wi(){var n,r,e,l;return n=je,61===t.charCodeAt(je)?(r=Oe,je++):(r=i,0===Xe&&Ze(Me)),r!==i?(e=je,Xe++,61===t.charCodeAt(je)?(l=Oe,je++):(l=i,0===Xe&&Ze(Me)),Xe--,l===i?e=void 0:(je=e,e=i),e!==i&&(l=Yl())!==i?(De=n,n=r=Br(r)):(je=n,n=i)):(je=n,n=i),n}function Ai(){var n,r;return n=je,44===t.charCodeAt(je)?(r=Fe,je++):(r=i,0===Xe&&Ze(Ue)),r!==i&&Yl()!==i?(De=n,n=r=Br(r)):(je=n,n=i),n}var Si=r(7);Si.objectToAst;const Ei={mnemonic:null,imm:null,abs:null,absx:null,absy:null,absind:null,indx:null,indy:null};function ki(t,n,r,e){return{...Ei,mnemonic:t,imm:n,abs:r,loc:e}}function Ci(t,n,r){return[t].concat(function(t,n){return t.map(function(t){return t[n]})}(n,r))}function Pi(){return{...Qe(De,je),source:n.source}}if((l=s())!==i&&je===t.length)return l;throw l!==i&&je<t.length&&Ze({type:"end"}),Ge(Ne,ze<t.length?t.charAt(ze):null,ze<t.length?Qe(ze,ze+1):Qe(ze,ze))}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DebugInfoTracker=void 0;const e=r(0),l=r(24);n.DebugInfoTracker=class{constructor(){this.lineStack=[],this.pcToLocs={},this.insnBitset=new l}startLine(t,n){const r={source:e.resolve(t.source),lineNo:t.start.line};this.lineStack.push({loc:r,pc:n})}endLine(t){const n=this.lineStack.pop();if(!n)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");if(t-n.pc>0){const t=this.pcToLocs[n.pc]||[];t.push(n.loc),this.pcToLocs[n.pc]=t}}markAsInstruction(t,n){for(let r=t;r<n;r++)this.insnBitset.add(r)}info(){const t=this.insnBitset.clone();return{pcToLocs:this.pcToLocs,isInstruction:n=>t.has(n)}}}},function(t,n,r){"use strict";function e(t){if(this.words=[],null!=(r=t)&&void 0!==r[Symbol.iterator])for(var n of t)this.add(n);var r}e.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t},e.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t},e.prototype.clear=function(){this.words=[]},e.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)},e.prototype.isEmpty=function(t){for(var n=this.words.length,r=0;r<n;r++)if(0!==this.words[r])return!1;return!0},e.prototype.has=function(t){return 0!=(this.words[t>>>5]&1<<t)},e.prototype.checkedAdd=function(t){this.resize(t);var n=this.words[t>>>5],r=n|1<<t;return this.words[t>>>5]=r,(r^n)>>>t},e.prototype.trim=function(t){for(var n=this.words.length;n>0&&0===this.words[n-1];)n--;this.words=this.words.slice(0,n)},e.prototype.resize=function(t){for(var n=t+32>>>5,r=this.words.length;r<n;r++)this.words[r]=0},e.prototype.hammingWeight=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.prototype.hammingWeight4=function(t,n,r,e){return 16843009*((t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135)+(r=(r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135)+(e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135))>>>24},e.prototype.size=function(){for(var t=0,n=this.words.length,r=this.words,e=0;e<n;e++)t+=this.hammingWeight(r[e]);return t},e.prototype.array=function(){for(var t=new Array(this.size()),n=0,r=this.words.length,e=0;e<r;++e)for(var l=this.words[e];0!=l;){var i=l&-l;t[n++]=(e<<5)+this.hammingWeight(i-1|0),l^=i}return t},e.prototype.forEach=function(t){for(var n=this.words.length,r=0;r<n;++r)for(var e=this.words[r];0!=e;){var l=e&-e;t((r<<5)+this.hammingWeight(l-1|0)),e^=l}},e.prototype.clone=function(){var t=Object.create(e.prototype);return t.words=this.words.slice(),t},e.prototype.intersects=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0;r<n;++r)if(0!=(this.words[r]&t.words[r]))return!0;return!1},e.prototype.intersection=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0;r+7<n;r+=8)this.words[r]&=t.words[r],this.words[r+1]&=t.words[r+1],this.words[r+2]&=t.words[r+2],this.words[r+3]&=t.words[r+3],this.words[r+4]&=t.words[r+4],this.words[r+5]&=t.words[r+5],this.words[r+6]&=t.words[r+6],this.words[r+7]&=t.words[r+7];for(;r<n;++r)this.words[r]&=t.words[r];var e=this.words.length;for(r=n;r<e;++r)this.words[r]=0;return this},e.prototype.intersection_size=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0,e=0;e<n;++e)r+=this.hammingWeight(this.words[e]&t.words[e]);return r},e.prototype.new_intersection=function(t){var n=Object.create(e.prototype),r=Math.min(this.words.length,t.words.length);n.words=new Array(r);for(var l=r,i=0;i+7<l;i+=8)n.words[i]=this.words[i]&t.words[i],n.words[i+1]=this.words[i+1]&t.words[i+1],n.words[i+2]=this.words[i+2]&t.words[i+2],n.words[i+3]=this.words[i+3]&t.words[i+3],n.words[i+4]=this.words[i+4]&t.words[i+4],n.words[i+5]=this.words[i+5]&t.words[i+5],n.words[i+6]=this.words[i+6]&t.words[i+6],n.words[i+7]=this.words[i+7]&t.words[i+7];for(;i<l;++i)n.words[i]=this.words[i]&t.words[i];return n},e.prototype.equals=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0;r<n;++r)if(this.words[r]!=t.words[r])return!1;if(this.words.length<t.words.length){var e=t.words.length;for(r=this.words.length;r<e;++r)if(0!=t.words[r])return!1}else if(t.words.length<this.words.length)for(e=this.words.length,r=t.words.length;r<e;++r)if(0!=this.words[r])return!1;return!0},e.prototype.difference=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0;r+7<n;r+=8)this.words[r]&=~t.words[r],this.words[r+1]&=~t.words[r+1],this.words[r+2]&=~t.words[r+2],this.words[r+3]&=~t.words[r+3],this.words[r+4]&=~t.words[r+4],this.words[r+5]&=~t.words[r+5],this.words[r+6]&=~t.words[r+6],this.words[r+7]&=~t.words[r+7];for(;r<n;++r)this.words[r]&=~t.words[r];return this},e.prototype.difference_size=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0,e=0;e<n;++e)r+=this.hammingWeight(this.words[e]&~t.words[e]);for(var l=this.words.length;e<l;++e)r+=this.hammingWeight(this.words[e]);return r},e.prototype.toString=function(){return"{"+this.array().join(",")+"}"},e.prototype.union=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0;r+7<n;r+=8)this.words[r]|=t.words[r],this.words[r+1]|=t.words[r+1],this.words[r+2]|=t.words[r+2],this.words[r+3]|=t.words[r+3],this.words[r+4]|=t.words[r+4],this.words[r+5]|=t.words[r+5],this.words[r+6]|=t.words[r+6],this.words[r+7]|=t.words[r+7];for(;r<n;++r)this.words[r]|=t.words[r];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);var e=t.words.length;for(r=n;r<e;++r)this.words[r]=t.words[r]}return this},e.prototype.new_union=function(t){var n=Object.create(e.prototype),r=Math.max(this.words.length,t.words.length);n.words=new Array(r);for(var l=Math.min(this.words.length,t.words.length),i=0;i+7<l;i+=8)n.words[i]=this.words[i]|t.words[i],n.words[i+1]=this.words[i+1]|t.words[i+1],n.words[i+2]=this.words[i+2]|t.words[i+2],n.words[i+3]=this.words[i+3]|t.words[i+3],n.words[i+4]=this.words[i+4]|t.words[i+4],n.words[i+5]=this.words[i+5]|t.words[i+5],n.words[i+6]=this.words[i+6]|t.words[i+6],n.words[i+7]=this.words[i+7]|t.words[i+7];for(;i<l;++i)n.words[i]=this.words[i]|t.words[i];var o=this.words.length;for(i=l;i<o;++i)n.words[i]=this.words[i];var s=t.words.length;for(i=l;i<s;++i)n.words[i]=t.words[i];return n},e.prototype.new_difference=function(t){return this.clone().difference(t)},e.prototype.union_size=function(t){for(var n=Math.min(this.words.length,t.words.length),r=0,e=0;e<n;++e)r+=this.hammingWeight(this.words[e]|t.words[e]);if(this.words.length<t.words.length){var l=t.words.length;for(e=this.words.length;e<l;++e)r+=this.hammingWeight(0|t.words[e])}else for(l=this.words.length,e=t.words.length;e<l;++e)r+=this.hammingWeight(0|this.words[e]);return r},t.exports=e},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.disassemble=n.chunkArray=void 0;const e=r(4);function l(t){return`${t.toString(16).toUpperCase().padStart(2,"0")}`}function i(t){return`${t.toString(16).toUpperCase().padStart(4,"0")}`}function o(t,n){var r=0,e=t.length,l=[];for(r=0;r<e;r+=n){const e=t.slice(r,r+n);l.push(e)}return l}function s(t,n){const r=63&t,e=t>>6;return 1===e||2===e?`${r}/${r+1}`:3===e?n?`${r+1}/${r+2}`:`${r}/${r+1}`:`${r}`}n.chunkArray=o;class u{constructor(t,n,r){var o;this.buf=t,this.outputPadChars="     ",this.outputBytesPerLine=1,this.bytes={startPC:0,bytes:[]},this.labelsDict={},this.byte=()=>{const t=this.buf.readUInt8(this.curOffs);return this.curOffs++,t},this.print=(t,n,r,e,o)=>{var s,u;this.flushBytes();const a=l(n[0]),c=n.length>=2?l(n[1]):"  ",h=n.length>=3?l(n[2]):"  ",f=`${i(t)}: ${a} ${c} ${h}${this.outputPadChars}${r}`,d=null===(s=this.disasmOptions)||void 0===s?void 0:s.showCycles,p=null===(u=this.disasmOptions)||void 0===u?void 0:u.showLabels;if(d||p){const t=[];d&&t.push(o),p&&t.push(e),this.output.push(`${f.padEnd(50)}; ${t.join(" ")}`)}else this.output.push(f)},this.output=[],this.curAddr=t.readUInt8(0)+(t.readUInt8(1)<<8),this.curOffs=2,this.disasmOptions=r,this.labels=n,(null===(o=this.disasmOptions)||void 0===o?void 0:o.isInstruction)&&(this.outputPadChars="                    ",this.outputBytesPerLine=8),this.labels&&this.labels.forEach(({name:t,addr:n,size:r})=>{this.labelsDict[n]=t}),this.opToDecl={},Object.keys(e.default).forEach(t=>{let n=e.default[t];for(let r=0;r<n.length;r++){const e=n[r];if(null!==e){const r=n.map(t=>null!==t?255&t:null);this.opToDecl[255&e]={mnemonic:t,decode:r,cycles:e>>8}}}})}flushBytes(){const t=o(this.bytes.bytes,this.outputBytesPerLine);let n=this.bytes.startPC;for(let r=0;r<t.length;r++,n+=this.outputBytesPerLine){const e=t[r].map(t=>l(t)).join(" ");this.output.push(`${i(n)}: ${e}`)}this.bytes.bytes=[]}disImm(t,n,r,e){const i=this.curAddr,o=this.byte(),u=s(e);this.print(i,[n,o],`${t} #$${l(o)}`,r,u)}disZp(t,n,r,e){const i=this.curAddr,o=this.byte(),u=s(e);this.print(i,[n,o],`${t} $${l(o)}`,r,u)}disZpX(t,n,r,e){const i=this.curAddr,o=this.byte(),u=s(e);this.print(i,[n,o],`${t} $${l(o)},X`,r,u)}disZpY(t,n,r,e){const i=this.curAddr,o=this.byte(),u=s(e);this.print(i,[n,o],`${t} $${l(o)},Y`,r,u)}disAbs(t,n,r,e){const l=this.curAddr,o=this.byte(),u=this.byte(),a=s(e);this.print(l,[n,o,u],`${t} $${i(o+256*u)}`,r,a)}disAbsX(t,n,r,e){const l=this.curAddr,o=this.byte(),u=this.byte(),a=s(e);this.print(l,[n,o,u],`${t} $${i(o+256*u)},X`,r,a)}disAbsY(t,n,r,e){const l=this.curAddr,o=this.byte(),u=this.byte(),a=s(e);this.print(l,[n,o,u],`${t} $${i(o+256*u)},Y`,r,a)}disInd(t,n,r,e){const l=this.curAddr,o=this.byte(),u=this.byte(),a=s(e);this.print(l,[n,o,u],`${t} ($${i(o+256*u)})`,r,a)}disIndX(t,n,r,e){const i=this.curAddr,o=this.byte(),u=s(e);this.print(i,[n,o],`${t} ($${l(o)},X)`,r,u)}disIndY(t,n,r,e){const i=this.curAddr,o=this.byte(),u=s(e);this.print(i,[n,o],`${t} ($${l(o)}),Y`,r,u)}disSingle(t,n,r,e){const l=this.curAddr,i=s(e);this.print(l,[n],`${t}`,r,i)}disBranch(t,n,r,e){const l=this.curAddr,o=this.byte(),u=l+(o>=128?-(256-o):o)+2,a=s(e,(l+2&-256)!=(-256&u));this.print(l,[n,o],`${t} $${i(u)}`,r,a)}disUnknown(t){0!==this.bytes.bytes.length?this.bytes.bytes.push(t):(this.bytes.bytes=[t],this.bytes.startPC=this.curAddr)}disassemble(){const t=this.buf.byteLength;let n=t=>!0;this.disasmOptions&&this.disasmOptions.isInstruction&&(n=this.disasmOptions.isInstruction);let r=this.curOffs;for(;this.curOffs<t;){this.curAddr+=this.curOffs-r;var e="";this.curAddr in this.labelsDict&&(e=this.labelsDict[this.curAddr]),r=this.curOffs;const t=this.byte(),l=this.opToDecl[t];if(n(this.curAddr)&&void 0!==l){const n=l.decode.indexOf(t),r=l.cycles;if(0===n){this.disImm(l.mnemonic,t,e,r);continue}if(1===n){this.disZp(l.mnemonic,t,e,r);continue}if(2===n){this.disZpX(l.mnemonic,t,e,r);continue}if(3===n){this.disZpY(l.mnemonic,t,e,r);continue}if(4===n){this.disAbs(l.mnemonic,t,e,r);continue}if(5===n){this.disAbsX(l.mnemonic,t,e,r);continue}if(6===n){this.disAbsY(l.mnemonic,t,e,r);continue}if(7===n){this.disInd(l.mnemonic,t,e,r);continue}if(8===n){this.disIndX(l.mnemonic,t,e,r);continue}if(9===n){this.disIndY(l.mnemonic,t,e,r);continue}if(10===n){this.disSingle(l.mnemonic,t,e,r);continue}if(11===n){this.disBranch(l.mnemonic,t,e,r);continue}}else this.disUnknown(t)}return this.flushBytes(),this.output}}n.disassemble=function(t,n,r){return new u(t,n,r).disassemble()}}]);