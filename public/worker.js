!function(t){var e={};function n(r){if(e[r])return e[r].exports;var l=e[r]={i:r,l:!1,exports:{}};return t[r].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)n.d(r,l,function(e){return t[e]}.bind(null,l));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var l=t[r];"."===l?t.splice(r,1):".."===l?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",l=!1,s=arguments.length-1;s>=-1&&!l;s--){var i=s>=0?arguments[s]:t.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,l="/"===i.charAt(0))}return(l?"/":"")+(e=n(r(e.split("/"),(function(t){return!!t})),!l).join("/"))||"."},e.normalize=function(t){var s=e.isAbsolute(t),i="/"===l(t,-1);return(t=n(r(t.split("/"),(function(t){return!!t})),!s).join("/"))||s||(t="."),t&&i&&(t+="/"),(s?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(r(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var l=r(t.split("/")),s=r(n.split("/")),i=Math.min(l.length,s.length),o=i,u=0;u<i;u++)if(l[u]!==s[u]){o=u;break}var a=[];for(u=o;u<l.length;u++)a.push("..");return(a=a.concat(s.slice(o))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,l=!0,s=t.length-1;s>=1;--s)if(47===(e=t.charCodeAt(s))){if(!l){r=s;break}}else l=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,l=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!l){n=e+1;break}}else-1===r&&(l=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,l=!0,s=0,i=t.length-1;i>=0;--i){var o=t.charCodeAt(i);if(47!==o)-1===r&&(l=!1,r=i+1),46===o?-1===e?e=i:1!==s&&(s=1):-1!==e&&(s=-1);else if(!l){n=i+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===n+1?"":t.slice(e,r)};var l="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(3))},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(10),l=n(11),s=n(12);function i(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(i()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return a(this,t,e,n)}function a(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=f(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),l=(t=o(t,r)).write(e,n);l!==r&&(t=t.slice(0,l));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=o(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?o(t,0):f(t,e);if("Buffer"===e.type&&s(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=o(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e){var n=e.length<0?0:0|d(e.length);t=o(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(t).length;default:if(r)return D(t).length;e=(""+e).toLowerCase(),r=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return $(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return x(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,l){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=l?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(l)return-1;n=t.length-1}else if(n<0){if(!l)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,l);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?l?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,l);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,l){var s,i=1,o=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;i=2,o/=2,u/=2,n/=2}function a(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(l){var c=-1;for(s=n;s<o;s++)if(a(t,s)===a(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===u)return c*i}else-1!==c&&(s-=s-c),c=-1}else for(n+u>o&&(n=o-u),s=n;s>=0;s--){for(var h=!0,f=0;f<u;f++)if(a(t,s+f)!==a(e,f)){h=!1;break}if(h)return s}return-1}function b(t,e,n,r){n=Number(n)||0;var l=t.length-n;r?(r=Number(r))>l&&(r=l):r=l;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");r>s/2&&(r=s/2);for(var i=0;i<r;++i){var o=parseInt(e.substr(2*i,2),16);if(isNaN(o))return i;t[n+i]=o}return i}function w(t,e,n,r){return N(D(e,t.length-n),t,n,r)}function A(t,e,n,r){return N(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function S(t,e,n,r){return A(t,e,n,r)}function k(t,e,n,r){return N(Y(e),t,n,r)}function E(t,e,n,r){return N(function(t,e){for(var n,r,l,s=[],i=0;i<t.length&&!((e-=2)<0);++i)n=t.charCodeAt(i),r=n>>8,l=n%256,s.push(l),s.push(r);return s}(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);for(var r=[],l=e;l<n;){var s,i,o,u,a=t[l],c=null,h=a>239?4:a>223?3:a>191?2:1;if(l+h<=n)switch(h){case 1:a<128&&(c=a);break;case 2:128==(192&(s=t[l+1]))&&(u=(31&a)<<6|63&s)>127&&(c=u);break;case 3:s=t[l+1],i=t[l+2],128==(192&s)&&128==(192&i)&&(u=(15&a)<<12|(63&s)<<6|63&i)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:s=t[l+1],i=t[l+2],o=t[l+3],128==(192&s)&&128==(192&i)&&128==(192&o)&&(u=(15&a)<<18|(63&s)<<12|(63&i)<<6|63&o)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),l+=h}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=i(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return a(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?o(t,e):void 0!==n?"string"==typeof r?o(t,e).fill(n,r):o(t,e).fill(n):o(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,l=0,s=Math.min(n,r);l<s;++l)if(t[l]!==e[l]){n=t[l],r=e[l];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),l=0;for(n=0;n<t.length;++n){var i=t[n];if(!u.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,l),l+=i.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,l){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===l&&(l=this.length),e<0||n>t.length||r<0||l>this.length)throw new RangeError("out of range index");if(r>=l&&e>=n)return 0;if(r>=l)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(l>>>=0)-(r>>>=0),i=(n>>>=0)-(e>>>=0),o=Math.min(s,i),a=this.slice(r,l),c=t.slice(e,n),h=0;h<o;++h)if(a[h]!==c[h]){s=a[h],i=c[h];break}return s<i?-1:i<s?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var l=this.length-e;if((void 0===n||n>l)&&(n=l),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return A(this,t,e,n);case"latin1":case"binary":return S(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function x(t,e,n){var r="";n=Math.min(t.length,n);for(var l=e;l<n;++l)r+=String.fromCharCode(127&t[l]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var l=e;l<n;++l)r+=String.fromCharCode(t[l]);return r}function $(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var l="",s=e;s<n;++s)l+=U(t[s]);return l}function B(t,e,n){for(var r=t.slice(e,n),l="",s=0;s<r.length;s+=2)l+=String.fromCharCode(r[s]+256*r[s+1]);return l}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,n,r,l,s){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>l||e<s)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function _(t,e,n,r){e<0&&(e=65535+e+1);for(var l=0,s=Math.min(t.length-n,2);l<s;++l)t[n+l]=(e&255<<8*(r?l:1-l))>>>8*(r?l:1-l)}function R(t,e,n,r){e<0&&(e=4294967295+e+1);for(var l=0,s=Math.min(t.length-n,4);l<s;++l)t[n+l]=e>>>8*(r?l:3-l)&255}function O(t,e,n,r,l,s){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(t,e,n,r,s){return s||O(t,0,n,4),l.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,s){return s||O(t,0,n,8),l.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var l=e-t;n=new u(l,void 0);for(var s=0;s<l;++s)n[s]=this[s+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],l=1,s=0;++s<e&&(l*=256);)r+=this[t+s]*l;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],l=1;e>0&&(l*=256);)r+=this[t+--e]*l;return r},u.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],l=1,s=0;++s<e&&(l*=256);)r+=this[t+s]*l;return r>=(l*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,l=1,s=this[t+--r];r>0&&(l*=256);)s+=this[t+--r]*l;return s>=(l*=128)&&(s-=Math.pow(2,8*e)),s},u.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),l.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),l.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),l.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),l.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||L(this,t,e,n,Math.pow(2,8*n)-1,0);var l=1,s=0;for(this[e]=255&t;++s<n&&(l*=256);)this[e+s]=t/l&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||L(this,t,e,n,Math.pow(2,8*n)-1,0);var l=n-1,s=1;for(this[e+l]=255&t;--l>=0&&(s*=256);)this[e+l]=t/s&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):R(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var l=Math.pow(2,8*n-1);L(this,t,e,n,l-1,-l)}var s=0,i=1,o=0;for(this[e]=255&t;++s<n&&(i*=256);)t<0&&0===o&&0!==this[e+s-1]&&(o=1),this[e+s]=(t/i>>0)-o&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var l=Math.pow(2,8*n-1);L(this,t,e,n,l-1,-l)}var s=n-1,i=1,o=0;for(this[e+s]=255&t;--s>=0&&(i*=256);)t<0&&0===o&&0!==this[e+s+1]&&(o=1),this[e+s]=(t/i>>0)-o&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):R(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):R(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return M(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return M(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var l,s=r-n;if(this===t&&n<e&&e<r)for(l=s-1;l>=0;--l)t[l+e]=this[l+n];else if(s<1e3||!u.TYPED_ARRAY_SUPPORT)for(l=0;l<s;++l)t[l+e]=this[l+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var l=t.charCodeAt(0);l<256&&(t=l)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var i=u.isBuffer(t)?t:D(new u(t,r).toString()),o=i.length;for(s=0;s<n-e;++s)this[s+e]=i[s%o]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function D(t,e){var n;e=e||1/0;for(var r=t.length,l=null,s=[],i=0;i<r;++i){if((n=t.charCodeAt(i))>55295&&n<57344){if(!l){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(i+1===r){(e-=3)>-1&&s.push(239,191,189);continue}l=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),l=n;continue}n=65536+(l-55296<<10|n-56320)}else l&&(e-=3)>-1&&s.push(239,191,189);if(l=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Y(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function N(t,e,n,r){for(var l=0;l<r&&!(l+n>=e.length||l>=t.length);++l)e[l+n]=t[l];return l}}).call(this,n(9))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.disassemble=e.platformC64=e.assemble=void 0;var r=n(13);Object.defineProperty(e,"assemble",{enumerable:!0,get:function(){return r.assemble}}),Object.defineProperty(e,"platformC64",{enumerable:!0,get:function(){return r.platformC64}});var l=n(25);Object.defineProperty(e,"disassemble",{enumerable:!0,get:function(){return l.disassemble}})},function(t,e){var n,r,l=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var u,a=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?a=u.concat(a):h=-1,a.length&&d())}function d(){if(!c){var t=o(f);c=!0;for(var e=a.length;e;){for(u=a,a=[];++h<e;)u&&u[h].run();h=-1,e=a.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new p(t,e)),1!==a.length||c||o(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=m,l.addListener=m,l.once=m,l.off=m,l.removeListener=m,l.removeAllListeners=m,l.emit=m,l.prependListener=m,l.prependOnceListener=m,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function r(t,e){return t|e<<8}function l(t,e){return t|e<<8|16384}function s(t,e){return 49152|(t|e<<8)}const i={ADC:[r(105,2),r(101,3),r(117,4),null,r(109,4),l(125,4),l(121,4),null,r(97,6),l(113,5),null,null],AND:[r(41,2),r(37,3),r(53,4),null,r(45,4),l(61,4),l(57,4),null,r(33,6),l(49,5),null,null],ASL:[null,r(6,5),r(22,6),null,r(14,6),r(30,7),null,null,null,null,r(10,2),null],BIT:[null,r(36,3),null,null,r(44,4),null,null,null,null,null,null,null],BPL:[null,null,null,null,null,null,null,null,null,null,null,s(16,2)],BMI:[null,null,null,null,null,null,null,null,null,null,null,s(48,2)],BVC:[null,null,null,null,null,null,null,null,null,null,null,s(80,2)],BVS:[null,null,null,null,null,null,null,null,null,null,null,s(112,2)],BCC:[null,null,null,null,null,null,null,null,null,null,null,s(144,2)],BCS:[null,null,null,null,null,null,null,null,null,null,null,s(176,2)],BNE:[null,null,null,null,null,null,null,null,null,null,null,s(208,2)],BEQ:[null,null,null,null,null,null,null,null,null,null,null,s(240,2)],BRK:[null,null,null,null,null,null,null,null,null,null,r(0,7),null],CMP:[r(201,2),r(197,3),r(213,4),null,r(205,4),l(221,4),l(217,4),null,r(193,6),l(209,5),null,null],CPX:[r(224,2),r(228,3),null,null,r(236,4),null,null,null,null,null,null,null],CPY:[r(192,2),r(196,3),null,null,r(204,4),null,null,null,null,null,null,null],DEC:[null,r(198,5),r(214,6),null,r(206,6),r(222,7),null,null,null,null,null,null],EOR:[r(73,2),r(69,3),r(85,4),null,r(77,4),l(93,4),l(89,4),null,r(65,6),l(81,5),null,null],CLC:[null,null,null,null,null,null,null,null,null,null,r(24,2),null],SEC:[null,null,null,null,null,null,null,null,null,null,r(56,2),null],CLI:[null,null,null,null,null,null,null,null,null,null,r(88,2),null],SEI:[null,null,null,null,null,null,null,null,null,null,r(120,2),null],CLV:[null,null,null,null,null,null,null,null,null,null,r(184,2),null],CLD:[null,null,null,null,null,null,null,null,null,null,r(216,2),null],SED:[null,null,null,null,null,null,null,null,null,null,r(248,2),null],INC:[null,r(230,5),r(246,6),null,r(238,6),r(254,7),null,null,null,null,null,null],JMP:[null,null,null,null,r(76,3),null,null,r(108,5),null,null,null,null],JSR:[null,null,null,null,r(32,6),null,null,null,null,null,null,null],LDA:[r(169,2),r(165,3),r(181,4),null,r(173,4),l(189,4),l(185,4),null,r(161,6),l(177,5),null,null],LDX:[r(162,2),r(166,3),null,r(182,4),r(174,4),null,l(190,4),null,null,null,null,null],LDY:[r(160,2),r(164,3),r(180,4),null,r(172,4),l(188,4),null,null,null,null,null,null],LSR:[null,r(70,5),r(86,6),null,r(78,6),r(94,7),null,null,null,null,r(74,2),null],NOP:[null,null,null,null,null,null,null,null,null,null,r(234,2),null],ORA:[r(9,2),r(5,3),r(21,4),null,r(13,4),l(29,4),l(25,4),null,r(1,6),l(17,5),null,null],TAX:[null,null,null,null,null,null,null,null,null,null,r(170,2),null],TXA:[null,null,null,null,null,null,null,null,null,null,r(138,2),null],DEX:[null,null,null,null,null,null,null,null,null,null,r(202,2),null],INX:[null,null,null,null,null,null,null,null,null,null,r(232,2),null],TAY:[null,null,null,null,null,null,null,null,null,null,r(168,2),null],TYA:[null,null,null,null,null,null,null,null,null,null,r(152,2),null],DEY:[null,null,null,null,null,null,null,null,null,null,r(136,2),null],INY:[null,null,null,null,null,null,null,null,null,null,r(200,2),null],ROR:[null,r(102,5),r(118,6),null,r(110,6),r(126,7),null,null,null,null,r(106,2),null],ROL:[null,r(38,5),r(54,6),null,r(46,6),r(62,7),null,null,null,null,r(42,2),null],RTI:[null,null,null,null,null,null,null,null,null,null,r(64,6),null],RTS:[null,null,null,null,null,null,null,null,null,null,r(96,6),null],SBC:[r(233,2),r(229,3),r(245,4),null,r(237,4),l(253,4),l(249,4),null,r(225,6),l(241,5),null,null],STA:[null,r(133,3),r(149,4),null,r(141,4),r(157,5),r(153,5),null,r(129,6),r(145,6),null,null],TXS:[null,null,null,null,null,null,null,null,null,null,r(154,2),null],TSX:[null,null,null,null,null,null,null,null,null,null,r(186,2),null],PHA:[null,null,null,null,null,null,null,null,null,null,r(72,3),null],PLA:[null,null,null,null,null,null,null,null,null,null,r(104,4),null],PHP:[null,null,null,null,null,null,null,null,null,null,r(8,3),null],PLP:[null,null,null,null,null,null,null,null,null,null,r(40,4),null],STX:[null,r(134,3),null,r(150,4),r(142,4),null,null,null,null,null,null,null],STY:[null,r(132,3),r(148,4),null,r(140,4),null,null,null,null,null,null,null],SLO:[null,r(7,5),r(23,6),null,r(15,6),r(31,7),r(27,7),null,r(3,8),r(19,8),null,null],ANC:[r(11,2),null,null,null,null,null,null,null,null,null,null,null],RLA:[null,r(39,5),r(55,6),null,r(47,6),r(63,7),r(59,7),null,r(35,8),r(51,8),null,null],SRE:[null,r(71,5),r(87,6),null,r(79,6),r(95,7),r(91,7),null,r(67,8),r(83,8),null,null],RRA:[null,r(103,5),r(119,6),null,r(111,6),r(127,7),r(123,7),null,r(99,8),r(115,8),null,null],SAX:[null,r(135,3),null,r(151,4),r(143,4),null,null,null,r(131,6),null,null,null],AHX:[null,null,null,null,null,null,r(159,5),null,null,r(147,6),null,null],XAA:[r(139,2),null,null,null,null,null,null,null,null,null,null,null],TAS:[null,null,null,null,null,null,r(155,5),null,null,null,null,null],SHY:[null,null,null,null,null,r(156,5),null,null,null,null,null,null],SHX:[null,null,null,null,null,null,r(158,5),null,null,null,null,null],LAX:[r(171,2),r(167,3),null,r(183,4),r(175,4),null,r(191,4),null,r(163,6),r(179,5),null,null],LAS:[null,null,null,null,null,null,r(187,4),null,null,null,null,null],DCP:[null,r(199,5),r(215,6),null,r(207,6),r(223,7),r(219,7),null,r(195,8),r(211,8),null,null],ISC:[null,r(231,5),r(247,6),null,r(239,6),r(255,7),r(251,7),null,r(227,8),r(243,8),null,null],ALR:[r(75,2),null,null,null,null,null,null,null,null,null,null,null],AXS:[r(203,2),null,null,null,null,null,null,null,null,null,null,null],ARR:[r(107,2),null,null,null,null,null,null,null,null,null,null,null],"---":[null,null,null,null,null,null,null,null,null,null,null,null]};e.default=i},function(t,e){},function(t,e,n){"use strict";function r(t){return t.toString(16).padStart(4,"0")}Object.defineProperty(e,"__esModule",{value:!0}),e.exportC64debuggerInfo=e.exportViceMoncommands=e.toHex16=void 0,e.toHex16=r,e.exportViceMoncommands=function(t,e,n){for(const{name:n,addr:l}of e){t(`al C:${r(l)} .${n}\n`)}for(const e of n.info().breakpoints){t(`break ${r(e.addr)}\n`)}},e.exportC64debuggerInfo=function(t,e,n,l){const s={},i=[];for(let t=0;t<l.sourceFiles.length;t++){const e=l.sourceFiles[t];i.push(`${t},${e}`),s[e]=t}const o=Object.keys(l.pcToLocs).map(Number).sort((t,e)=>t-e),u=[{name:n[0].name,blocks:[{text:[]}]}];let a=[0,0];t:for(const t of o){let e=n[a[0]].blocks[a[1]];for(;;){const r=n[a[0]];if(e=r.blocks[a[1]],t>=e.start&&t<=e.end)break;if(t<e.start)continue t;if(a[1]!=r.blocks.length-1)a[1]+=1,u[a[0]].blocks.push({text:[]});else{if(a[0]+=1,a[1]=0,a[0]>=n.length)break t;u.push({name:n[a[0]].name,blocks:[{text:[]}]})}}if(!(t>=e.start&&t<=e.end))throw new Error("internal compiler error: inconsistent segments");const i=l.pcToLocs[t],o=u[a[0]].blocks[a[1]].text,c=i[0];o.push(`$${r(t)},$${r(t+c.numBytes-1)},${s[c.source]},${c.lineNo},1,${c.lineNo},1`)}const c=e.map(({name:t,addr:e,segmentName:n})=>`${n},$${r(e)},${t}`),h=u.map(t=>({name:"Segment",attributes:{name:t.name,values:"START,END,FILE_IDX,LINE1,COL1,LINE2,COL2"},children:t.blocks.map(t=>({name:"Block",attributes:{},children:t.text}))})),f=l.info().breakpoints.map(t=>`${t.segmentName},$${r(t.addr)},`);var d,p;d={name:"C64debugger",attributes:{version:"1.0"},children:[{name:"Sources",attributes:{values:"INDEX,FILE"},children:i},...h,{name:"Labels",attributes:{values:"SEGMENT,ADDRESS,NAME"},children:c},{name:"Breakpoints",attributes:{values:"SEGMENT,ADDRESS,ARGUMENT"},children:f}]},p=e=>t(e),function t(e,n){const r=Object.entries(e.attributes).map(([t,e])=>`${t}="${e}"`).join(" "),l="  ".repeat(n);if(p(`${l}<${e.name}${""!==r?" "+r:""}>\n`),0!==e.children.length)if("object"==typeof(s=e.children[0])&&"name"in s)for(const r of e.children)t(r,n+1);else{const t="  ".repeat(n+1);for(const n of e.children)p(`${t}${n}\n`)}var s;p(`${l}</${e.name}>\n`)}(d,0)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mkAsmLine=e.mkBreak=e.mkUseSegment=e.mkDeclareSegment=e.mkFilescope=e.mkLoadPlugin=e.mkStmtExpr=e.mkAssign=e.mkLet=e.mkCallMacro=e.mkMacro=e.mkMacroArg=e.mkFor=e.mkIfElse=e.mkBinary=e.mkError=e.mkInclude=e.mkAlign=e.mkFill=e.mkData=e.mkSetPC=e.mkInsn=e.mkLabel=e.DataSize=e.mkMember=e.mkGetCurPC=e.mkCallFunc=e.mkExprObject=e.mkExprArray=e.mkBinaryOp=e.mkUnary=e.mkKwarg=e.mkIdent=e.mkScopeQualifiedIdent=e.mkLiteral=void 0,e.mkLiteral=function(t,e){return{type:"literal",lit:t,loc:e}},e.mkScopeQualifiedIdent=function(t,e,n){return{type:"qualified-ident",path:t,absolute:e,loc:n}},e.mkIdent=function(t,e){return{type:"ident",name:t,loc:e}},e.mkKwarg=function(t,e,n){return{type:"kwarg",name:t,value:e,loc:n}},e.mkUnary=function(t,e,n){return{type:"unary",op:t,expr:e,loc:n}},e.mkBinaryOp=function(t,e,n,r){return{type:"binary",op:t,left:e,right:n,loc:r}},e.mkExprArray=function(t,e){return{type:"array",list:t,loc:e}},e.mkExprObject=function(t,e){return{type:"object",props:t,loc:e}},e.mkCallFunc=function(t,e,n){return{type:"callfunc",callee:t,args:null==e?[]:e,loc:n}},e.mkGetCurPC=function(t){return{type:"getcurpc",loc:t}},e.mkMember=function(t,e,n,r){return{type:"member",object:t,property:e,computed:n,loc:r}},function(t){t[t.Byte=0]="Byte",t[t.Word=1]="Word"}(e.DataSize||(e.DataSize={})),e.mkLabel=function(t,e){return{name:t,loc:e}},e.mkInsn=function(t,e){return{type:"insn",insn:t,loc:e}},e.mkSetPC=function(t,e){return{type:"setpc",pc:t,loc:e}},e.mkData=function(t,e,n){return{type:"data",values:e,dataSize:t,loc:n}},e.mkFill=function(t,e,n){return{type:"fill",numBytes:t,fillValue:e,loc:n}},e.mkAlign=function(t,e){return{type:"align",alignBytes:t,loc:e}},e.mkInclude=function(t,e){return{type:"include",filename:t,loc:e}},e.mkError=function(t,e){return{type:"error",error:t,loc:e}},e.mkBinary=function(t,e){return{type:"binary",kwargs:t,loc:e}},e.mkIfElse=function(t,e,n){return{type:"if",cases:t,elseBranch:null!==e?e:[],loc:n}},e.mkFor=function(t,e,n,r){return{type:"for",index:t,list:e,body:n,loc:r}},e.mkMacroArg=function(t){return{ident:t}},e.mkMacro=function(t,e,n,r){return{type:"macro",name:t,args:null==e?[]:e,body:n,loc:r}},e.mkCallMacro=function(t,e,n){return{type:"callmacro",name:t,args:null==e?[]:e,loc:n}},e.mkLet=function(t,e,n){return{type:"let",name:t,value:e,loc:n}},e.mkAssign=function(t,e,n){return{type:"assign",name:t,value:e,loc:n}},e.mkStmtExpr=function(t,e){return{type:"statement-expr",expr:t,loc:e}},e.mkLoadPlugin=function(t,e,n){return{type:"load-plugin",filename:t,moduleName:e,loc:n}},e.mkFilescope=function(t,e){return{type:"filescope",name:t,loc:e}},e.mkDeclareSegment=function(t,e,n){return{type:"declare-segment",name:t,kwargs:e,loc:n}},e.mkUseSegment=function(t,e){return{type:"use-segment",name:t,loc:e}},e.mkBreak=function(t){return{type:"break",loc:t}},e.mkAsmLine=function(t,e,n,r){return{label:t,stmt:e,scopedStmts:n,loc:r}}},function(t,e,n){"use strict";n.r(e),function(t){var e=n(2);onmessage=function(n){postMessage(function(n){var r=n.sourceFileMap,l={readFileSync:function(e){if(e in r)return t.from(r[e]);throw new Error("File not found "+e)}},s=e.assemble("main.asm",l);if(0===s.errors.length){var i={showLabels:!0,showCycles:!0,isInstruction:s.debugInfo.info().isInstruction};return{prg:s.prg,disassembly:e.disassemble(s.prg,s.labels,i),diagnostics:s.errors}}return{prg:void 0,diagnostics:s.errors}}(n.data))}}.call(this,n(1).Buffer)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";e.byteLength=function(t){var e=a(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=a(t),i=r[0],o=r[1],u=new s(function(t,e,n){return 3*(e+n)/4-n}(0,i,o)),c=0,h=o>0?i-4:i;for(n=0;n<h;n+=4)e=l[t.charCodeAt(n)]<<18|l[t.charCodeAt(n+1)]<<12|l[t.charCodeAt(n+2)]<<6|l[t.charCodeAt(n+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;2===o&&(e=l[t.charCodeAt(n)]<<2|l[t.charCodeAt(n+1)]>>4,u[c++]=255&e);1===o&&(e=l[t.charCodeAt(n)]<<10|l[t.charCodeAt(n+1)]<<4|l[t.charCodeAt(n+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,l=n%3,s=[],i=0,o=n-l;i<o;i+=16383)s.push(c(t,i,i+16383>o?o:i+16383));1===l?(e=t[n-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===l&&(e=(t[n-2]<<8)+t[n-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return s.join("")};for(var r=[],l=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,u=i.length;o<u;++o)r[o]=i[o],l[i.charCodeAt(o)]=o;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var l,s,i=[],o=e;o<n;o+=3)l=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(r[(s=l)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,r,l){var s,i,o=8*l-r-1,u=(1<<o)-1,a=u>>1,c=-7,h=n?l-1:0,f=n?-1:1,d=t[e+h];for(h+=f,s=d&(1<<-c)-1,d>>=-c,c+=o;c>0;s=256*s+t[e+h],h+=f,c-=8);for(i=s&(1<<-c)-1,s>>=-c,c+=r;c>0;i=256*i+t[e+h],h+=f,c-=8);if(0===s)s=1-a;else{if(s===u)return i?NaN:1/0*(d?-1:1);i+=Math.pow(2,r),s-=a}return(d?-1:1)*i*Math.pow(2,s-r)},e.write=function(t,e,n,r,l,s){var i,o,u,a=8*s-l-1,c=(1<<a)-1,h=c>>1,f=23===l?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:s-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,i=c):(i=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-i))<1&&(i--,u*=2),(e+=i+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(i++,u/=2),i+h>=c?(o=0,i=c):i+h>=1?(o=(e*u-1)*Math.pow(2,l),i+=h):(o=e*Math.pow(2,h-1)*Math.pow(2,l),i=0));l>=8;t[n+d]=255&o,d+=p,o/=256,l-=8);for(i=i<<l|o,a+=l;a>0;t[n+d]=255&i,d+=p,i/=256,a-=8);t[n+d-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.assemble=e.platformC64=void 0;const l=n(4),s=n(0),i=n(14),o=n(5),u=n(6),a=n(7),c=n(20),h=n(21),f=n(23);function d(t){return{value:t,errors:!0,completeFirstPass:!1}}function p(t,e){return{value:t,errors:!1,completeFirstPass:e}}function m(...t){return t.some(t=>void 0!==t&&t.errors)}function g(...t){return t.every(t=>void 0!==t&&t.completeFirstPass)}e.platformC64={name:"c64",defaultStartPC:2049};class y{constructor(t,e){this.syms=new Map,this.parent=null,this.children=new Map,this.parent=t,this.name=e}newScope(t,e){const n=this.children.get(t);if(void 0!==n)return n;const r=new y(e,t);return this.children.set(t,r),r}findSymbol(t){for(let e=this;null!==e;e=e.parent){const n=e.syms.get(t);if(void 0!==n)return n}}findSymbolPath(t){if(1==t.length)return this.findSymbol(t[0]);let e=this;for(;null==e.children.get(t[0]);)if(e=e.parent,null==e)return;for(let n=0;n<t.length-1;n++)if(e=e.children.get(t[n]),null==e)return;return e.syms.get(t[t.length-1])}addSymbol(t,e,n){this.syms.set(t,Object.assign(Object.assign({},e),{seen:n}))}updateSymbol(t,e,n){for(let r=this;null!==r;r=r.parent){if(void 0!==r.syms.get(t))return void r.syms.set(t,Object.assign(Object.assign({},e),{seen:n}))}}}class v{constructor(){this.passCount=0,this.root=new y(null,""),this.curSymtab=this.root,this.anonScopeCount=0}startPass(t){this.curSymtab=this.root,this.anonScopeCount=0,this.passCount=t}withAnonScope(t,e){const n="__anon_scope_"+this.anonScopeCount;this.anonScopeCount++,this.withLabelScope(n,t,e)}withLabelScope(t,e,n){const r=this.curSymtab;this.curSymtab=this.curSymtab.newScope(t,n||r),e(),this.curSymtab=r}findPath(t,e){return e?this.root.findSymbolPath(t):this.curSymtab.findSymbolPath(t)}findQualifiedSym(t,e){return this.findPath(t,e)}symbolSeen(t){const e=this.curSymtab.syms.get(t);return void 0!==e&&e.seen==this.passCount}declareLabelSymbol(t,e,n){const{name:r,loc:l}=t,s=this.curSymtab.syms.get(r);if(void 0===s){const t={type:"label",segment:n,data:p({addr:e,loc:l},!1)};return this.curSymtab.addSymbol(r,t,this.passCount),!1}if("label"!==s.type)throw new Error("ICE: declareLabelSymbol should be called only on labels");if(s.data.value.addr!==e){const t={type:"label",segment:n,data:Object.assign(Object.assign({},s.data),{value:Object.assign(Object.assign({},s.data.value),{addr:e})})};return this.curSymtab.updateSymbol(r,t,this.passCount),!0}return this.curSymtab.updateSymbol(r,s,this.passCount),!1}declareVar(t,e){this.curSymtab.addSymbol(t,{type:"var",data:e},this.passCount)}updateVar(t,e){const n={type:"var",data:e};this.curSymtab.updateSymbol(t,n,this.passCount)}declareSegment(t,e){this.curSymtab.addSymbol(t,{type:"segment",data:e},this.passCount)}findMacro(t,e){const n=this.findPath(t,e);if(void 0!==n&&"macro"==n.type)return n}declareMacro(t,e){this.curSymtab.addSymbol(t,{type:"macro",macro:e,declaredIn:this.curSymtab},this.passCount)}dumpLabels(t,e){const n={};for(const[t,r]of e)n[r.id]=t;const r=[],l=(t,e)=>{if(void 0!==t){const n=[...t,e.name];r.push({path:n,sym:e})}else r.push({path:[],sym:e})};l(void 0,this.root);const s=[];for(;r.length>0;){const t=r.pop();for(let[e,r]of t.sym.syms)"label"==r.type&&s.push({path:[...t.path,e],addr:r.data.value.addr,size:0,segmentName:n[r.segment.id]});for(let[e,n]of t.sym.children)l(t.path,n)}const i=s.sort((t,e)=>t.addr-e.addr),o=i.length;if(o>0){for(let t=1;t<o;t++)i[t-1].size=i[t].addr-i[t-1].addr;const e=i[o-1];e.size=t-e.addr}return i.map(({path:t,addr:e,size:n,segmentName:r})=>({name:t.join("::"),addr:e,size:n,segmentName:r}))}}function b(t){return{source:t,start:{offset:0,line:0,column:0},end:{offset:0,line:0,column:0}}}function w(t){const e=typeof t;return"object"===e&&t instanceof Array?"array":e}function A(t){return`${t.absolute?"::":""}${t.path.join("::")}`}const S=(t,e,n)=>{const r=n(t.value,e.value),l=g(t,e);return p("boolean"==typeof r?r?1:0:r,l)},k=(t,e)=>{if(m(t))return d(0);const n=e(t.value);return p("boolean"==typeof n?n?1:0:n,t.completeFirstPass)},E=void 0!==t&&null!=t.versions&&null!=t.versions.node;class C{constructor(t){this.parseCache=new h.default,this.pluginCache=new Map,this.includeStack=[],this.curSegmentName="",this.curSegment=new c.Segment(0,0,!1,0),this.pass=0,this.needPass=!1,this.scopes=new v,this.segments=[],this.errorList=[],this.warningList=[],this.outOfRangeBranches=[],this.debugInfo=new f.DebugInfoTracker,this.errors=()=>this.formatErrors(this.errorList,"error"),this.warnings=()=>this.formatErrors(this.warningList,"warning"),this.readFileSyncFunc=t.readFileSync,this.platform=t.platformOptions||e.platformC64}readFileSync(t,e){return this.readFileSyncFunc(t,e)}prg(){const{startPC:t,binary:e}=c.mergeSegments(this.segments),n=255&t,l=t>>8&255;return r.concat([r.from([n,l]),e])}parse(t,e){const n=null==e?b(t):e;return this.parseCache.parse(t,e,(t,e)=>this.guardedReadFileSync(t,n))}addJSStackErrors(t,e){if(t.stack){const n=t.stack.split("\n");if(n.length>0){const t=n[0].match(/(.*):(\d+)/);if(t){const r=t[1],l=t[2],i=s.relative(s.dirname(e.source),r),o=this.makeSourceRelativePath(i);let u=null;for(let t=1;t<n.length;t++){const e=n[t].match(/^([a-zA-Z]*Error:.*)/);e&&(u=e[1])}const a={start:{offset:-1,line:l,column:1},end:{offset:-1,line:l,column:2},source:o};this.addError(""+(null!=u?u:"null"),a)}else if(n.length>=2){const t=n[0].match(/^([a-zA-Z]*Error:.*)/),r=n[1].match(/^\s*at\s+.+\s+\((.+):(\d+):(\d+)\)/);if(t&&r){const n=t[1],l=r[1],i=r[2],o=r[3],u=s.relative(s.dirname(e.source),l),a={start:{offset:-1,line:i,column:o},end:{offset:-1,line:i,column:o},source:this.makeSourceRelativePath(u)};this.addError(""+n,a)}}}}}requirePlugin(t,e){const n=this.pluginCache.get(t);if(void 0!==n)return n;const r=this.makeSourceRelativePath(t);try{let n=void 0;if(E)n=i(s.resolve(r));else{const t=this.guardedReadFileSync(r+".js",e);void 0!==t&&(n=function(t){let e={exports:{}};return Function("module",t.toString())(e),e.exports}(t))}if(void 0===n)return d(0);const l=p(n,!0);return this.pluginCache.set(t,l),l}catch(t){return this.addError(`Plugin load failed: ${r}.js: ${t.message}`,e),this.addJSStackErrors(t,e),d(0)}}peekSourceStack(){const t=this.includeStack.length;return this.includeStack[t-1]}pushSource(t){this.includeStack.push(t)}popSource(){this.includeStack.pop()}anyErrors(){return 0!==this.errorList.length}formatErrors(t,e){return[...new Set(t.map(t=>JSON.stringify(t)))].map(t=>{const{loc:n,msg:r}=JSON.parse(t);let l=`<unknown>:1:1: ${e}: ${r}`;return n&&(l=`${n.source}:${n.start.line}:${n.start.column}: ${e}: ${r}`),{loc:n,msg:r,formatted:l}})}addError(t,e){this.errorList.push({msg:t,loc:e})}addWarning(t,e){this.warningList.push({msg:t,loc:e})}startPass(t){this.pass=t,this.needPass=!1,this.errorList=[],this.scopes.startPass(t),this.outOfRangeBranches=[],this.debugInfo=new f.DebugInfoTracker,this.segments=[];const e=this.newSegment("default",this.platform.defaultStartPC,void 0,!0);this.setCurrentSegment({type:"segment",data:e},"default"),this.scopes.declareSegment("default",this.curSegment)}setCurrentSegment(t,e){this.curSegmentName=e,this.curSegment=t.data}newSegment(t,e,n,r){const l=new c.Segment(e,n,r,this.segments.length-1);for(let e=1;e<this.segments.length;e++){const[n,r]=this.segments[e];this.segments[e][1].overlaps(l)&&this.addError(`Segment '${t}' (range: ${l.formatRange()} overlaps with an earlier segment '${n}' (range: ${r.formatRange()})`,this.lineLoc)}return this.segments.push([t,l]),l}getPC(){return this.curSegment.currentPC()}emitBasicHeader(){this.emit(12),this.emit(8),this.emit(0),this.emit(0),this.emit(158);[1e4,1e3,100,10,1].forEach(t=>{2061>=t&&this.emit(48+2061/t%10)}),this.emit(0),this.emit(0),this.emit(0)}emitBinary(t){const{kwargs:e}=t,[n,r]=this.evalKwargToString(e,"file",t.loc);let[l,s]=this.evalKwargToIntMaybe(e,"size",t.loc);const[i,o]=this.evalKwargToIntMaybe(e,"offset",t.loc),u=l,a=null!=i?i:p(0,!0),c=this.validateKwargs(e,["file","size","offset"]);if(m(n,a,null!=u?u:void 0)||!c)return;a.completeFirstPass||this.addError("!binary 'offset' must evaluate to a value in the first pass",o),null===u||u.completeFirstPass||this.addError("!binary 'size' must evaluate to a value in the first pass",s);const h=this.makeSourceRelativePath(n.value),f=this.guardedReadFileSync(h,t.loc);if(void 0===f)return;const d=null!==u?u.value:f.byteLength,g=f.slice(a.value,a.value+d);for(const t of g)this.emit(t)}evalExprType(t,e,n){const r=this.evalExpr(t),{errors:l,value:s,completeFirstPass:i}=r;return l||typeof s===e?r:(this.addError(`Expecting ${n} to be '${e}' type, got '${w(s)}'`,t.loc),{errors:!0,completeFirstPass:i,value:s})}evalKwargType(t,e,n,r){for(const r of t)if(r.name.name===e){return[this.evalExprType(r.value,n,`keyword arg '${e}'`),r.loc]}return this.addError(`Missing required keyword arg '${e}'`,r),[d(0),r]}evalKwargTypeMaybe(t,e,n,r){for(const r of t)if(r.name.name===e){return[this.evalExprType(r.value,n,`keyword arg '${e}'`),r.loc]}return[null,r]}validateKwargs(t,e){let n=!0;const r={};for(const e of t){const t=e.name.name;void 0===r[t]?r[t]=1:r[t]+=1,r[t]>1&&(this.addError(`Duplicate keyword arg '${t}'`,e.loc),n=!1)}for(const r of t)e.indexOf(r.name.name)<0&&(this.addError(`Unexpected keyword arg '${r.name.name}'`,r.loc),n=!1);return n}evalExprToInt(t,e){return this.evalExprType(t,"number",e)}evalExprToString(t,e){return this.evalExprType(t,"string",e)}evalKwargToInt(t,e,n){return this.evalKwargType(t,e,"number",n)}evalKwargToString(t,e,n){return this.evalKwargType(t,e,"string",n)}evalKwargToIntMaybe(t,e,n){return this.evalKwargTypeMaybe(t,e,"number",n)}evalExpr(t){switch(t.type){case"binary":{const e=this.evalExpr(t.left),n=this.evalExpr(t.right);if(m(e,n))return d(0);if(typeof e.value!=typeof n.value)return this.addError(`Binary expression operands are expected to be of the same type.  Got: '${w(e.value)}' (left), '${w(n.value)}' (right)`,t.loc),d(0);if("string"!=typeof e.value&&"number"!=typeof e.value)return this.addError(`Binary expression operands can only operator on numbers or strings.  Got: '${w(e.value)}'`,t.loc),d(0);if("string"==typeof e.value){const e=["+","==","<","<=",">",">="];if(e.indexOf(t.op)<0)return this.addError(`'${t.op}' operator is not supported for strings.  Valid operators for strings are: ${e.join(", ")}`,t.loc),d(0)}switch(t.op){case"+":return S(e,n,(t,e)=>t+e);case"-":return S(e,n,(t,e)=>t-e);case"*":return S(e,n,(t,e)=>t*e);case"/":return S(e,n,(t,e)=>t/e);case"%":return S(e,n,(t,e)=>t%e);case"&":return S(e,n,(t,e)=>t&e);case"|":return S(e,n,(t,e)=>t|e);case"^":return S(e,n,(t,e)=>t^e);case"<<":return S(e,n,(t,e)=>t<<e);case">>":return S(e,n,(t,e)=>t>>e);case"==":return S(e,n,(t,e)=>t==e);case"!=":return S(e,n,(t,e)=>t!=e);case"<":return S(e,n,(t,e)=>t<e);case"<=":return S(e,n,(t,e)=>t<=e);case">":return S(e,n,(t,e)=>t>e);case">=":return S(e,n,(t,e)=>t>=e);case"&&":return S(e,n,(t,e)=>t&&e);case"||":return S(e,n,(t,e)=>t||e);default:throw new Error("Unhandled binary operator "+t.op)}}case"unary":{const e=this.evalExprToInt(t.expr,"operand");if(e.errors)return e;switch(t.op){case"+":return k(e,t=>+t);case"-":return k(e,t=>-t);case"~":return k(e,t=>~t);default:throw new Error("Unhandled unary operator "+t.op)}}case"literal":return p(t.lit,!0);case"array":{const e=t.list.map(t=>this.evalExpr(t));return{value:e.map(t=>t.value),errors:m(...e),completeFirstPass:g(...e)}}case"object":{const e=t.props.map(t=>{const e=this.evalExpr(t.val);return["literal"===t.key.type?t.key.lit:t.key.name,e]});return{value:e.reduce((t,[e,n])=>Object.assign(Object.assign({},t),{[e]:n.value}),{}),errors:m(...e.map(([t,e])=>e)),completeFirstPass:g(...e.map(([t,e])=>e))}}case"ident":throw new Error("should not see an ident here -- if you do, it is probably a wrong type node in parser");case"qualified-ident":{const e=this.scopes.findQualifiedSym(t.path,t.absolute);if(null==e)return this.pass>=1?(this.addError(`Undefined symbol '${A(t)}'`,t.loc),d(0)):(this.needPass=!0,p(0,!1));switch(e.type){case"label":return{errors:e.data.errors,value:e.data.value.addr,completeFirstPass:e.seen==this.pass};case"var":return e.seen<this.pass&&this.addError(`Undeclared variable '${A(t)}'`,t.loc),e.data;case"macro":case"segment":return this.addError(`Must have a label or a variable identifier here, got ${e.type} name`,t.loc),d(0)}break}case"member":{const e=this.evalExpr(t.object);if(m(e))return d(0);const{value:n}=e;if(null==n)return this.addError("Cannot access properties of an undefined object",t.loc),d(0);const r=(t,e)=>t in n||(this.addError(`Property '${t}' does not exist in object`,e),!1),l=(t,l)=>{if("ident"!==t.property.type)this.addError(`${l} property must be a string, got ${w(t.property.type)}`,t.loc);else if(r(t.property.name,t.property.loc))return p(n[t.property.name],e.completeFirstPass);return d(0)};if(n instanceof Array){if(!t.computed)return l(t,"Array");const{errors:r,value:s,completeFirstPass:i}=this.evalExprToInt(t.property,"array index");return r?d(0):s in n?p(n[s],e.completeFirstPass&&i):(this.addError("Out of bounds array index "+s,t.property.loc),d(0))}if("object"==typeof n){if(t.computed){let{errors:l,value:s,completeFirstPass:i}=this.evalExpr(t.property);return l?d(0):"string"!=typeof s&&"number"!=typeof s?(this.addError("Object property must be a string or an integer, got "+w(s),t.loc),d(0)):r(s,t.property.loc)?p(n[s],i&&e.completeFirstPass):d(0)}return l(t,"Object")}return 0!==this.pass?(e.errors||(t.computed?this.addError("Cannot use []-operator on non-array/object values",t.loc):this.addError("Cannot use the dot-operator on non-object values",t.loc)),d(0)):p(0,!1)}case"callfunc":{const e=this.evalExpr(t.callee),n=t.args.map(t=>this.evalExpr(t));if(e.errors)return d(0);if("function"!=typeof e.value)return this.addError(`Callee must be a function type.  Got '${w(e)}'`,t.loc),d(0);if(m(...n))return d(0);try{const t=e.completeFirstPass&&g(...n);return p(e.value(...n.map(t=>t.value)),t)}catch(e){return"qualified-ident"==t.callee.type?this.addError(`Call to '${A(t.callee)}' failed with an error: ${e.message}`,t.loc):this.addError("Plugin call failed with an error: "+e.message,t.loc),void 0!==e.jsError&&this.addJSStackErrors(e,t.loc),d(0)}}case"getcurpc":return p(this.getPC(),!0)}throw new Error("should be unreachable?")}topLevelSourceLoc(){return b(this.includeStack[0])}emit(t){const e=this.curSegment.emit(t);void 0!==e&&this.addError(e,this.lineLoc)}emit16(t){this.emit(255&t),this.emit(t>>8&255)}checkSingle(t){return null!==t&&(this.emit(t),!0)}checkImm(t,e){if(null===e||null===t)return!1;const n=this.evalExprToInt(t,"immediate");return m(n)||(this.emit(e),this.emit(n.value)),!0}checkAbs(t,e,n){if(null===e||null===t)return!1;const r=this.evalExprToInt(t,"absolute address");if(m(r))return!0;const{value:l}=r;if(8===n){if(l<0||l>=1<<n)return!1;this.emit(e),this.emit(l)}else this.emit(e),this.emit16(l);return!0}checkBranch(t,e){if(null===e||null===t)return!1;const n=this.evalExpr(t);if(m(n))return!0;if("number"!=typeof n.value)return this.addError("Expecting branch label to evaluate to integer, got "+w(n.value),t.loc),!0;const{value:r}=n,l=r-this.getPC()-2;return this.emit(e),(l>127||l<-128)&&this.outOfRangeBranches.push({loc:t.loc,offset:l}),this.emit(255&l),!0}handleSetPC(t){const e=this.evalExprToInt(t,"pc");if(!m(e)){const{value:n,completeFirstPass:r}=e;if(!r)return void this.addError("Value for new program counter must evaluate to a value in the first pass",t.loc);!this.curSegment.empty()&&this.curSegment.currentPC()>n&&this.addError(`Cannot set program counter to a smaller value than current (current: $${u.toHex16(this.curSegment.currentPC())}, trying to set $${u.toHex16(n)})`,t.loc);const l=this.curSegment.setCurrentPC(n);void 0!==l&&this.addError(l,t.loc)}}guardedReadFileSync(t,e){try{return this.readFileSync(t)}catch(n){return void this.addError(`Couldn't open file '${t}'`,e)}}fileInclude(t){const e=this.evalExprToString(t.filename,"!include filename");if(m(e))return;const n=e.value,r=this.makeSourceRelativePath(n);this.pushSource(r),this.assemble(r,t.loc),this.popSource()}fillBytes(t){const e=this.evalExprToInt(t.numBytes,"!fill num_bytes"),n=this.evalExprToInt(t.fillValue,"!fill value");if(m(e,n))return;const{value:r}=n;if(r<0||r>=256)return void this.addError(`!fill value to repeat must be in 8-bit range, '${r}' given`,t.fillValue.loc);const l=e.value;if(l<0)this.addError("!fill repeat count must be >= 0, got "+l,t.numBytes.loc);else for(let t=0;t<l;t++)this.emit(r)}alignBytes(t){const e=this.evalExprToInt(t.alignBytes,"alignment");if(m(e))return;const{value:n}=e;if(n<1)this.addError(`Alignment must be a positive integer, ${n} given`,t.alignBytes.loc);else if(0==(n&n-1))for(;0!=(this.getPC()&n-1);)this.emit(0);else this.addError(`Alignment must be a power of two, ${n} given`,t.loc)}withAnonScope(t,e,n){if(null!==t)return this.withLabelScope(t,e,n);this.scopes.withAnonScope(e,n)}withLabelScope(t,e,n){this.scopes.withLabelScope(t,e)}emit8or16(t,e){8!=e?this.emit16(t):this.emit(t)}emitData(t,e){for(let n=0;n<t.length;n++){const r=this.evalExpr(t[n]);if(m(r))continue;const{value:l}=r;if("number"==typeof l)this.emit8or16(l,e);else if(l instanceof Array){let r=-1;for(let t=0;t<l.length;t++){const n="number"==typeof l[t]?l[t]:0;r="number"!=typeof l[t]&&-1===r?t:r,this.emit8or16(n,e)}-1!=r&&this.addError("Cannot emit non-numeric values.  First non-number at index "+r,t[n].loc)}else this.addError("Only literal (int constants) or array types can be emitted.  Got "+w(l),t[n].loc)}}makeFunction(t,e){return(...e)=>{try{return t.apply(null,[{readFileSync:t=>this.readFileSync(t),resolveRelative:t=>this.makeSourceRelativePath(t)},...e])}catch(t){throw t.jsError=!0,t}}}bindFunction(t,e,n){this.scopes.declareVar(t.name,p(this.makeFunction(e,n),!0))}bindPlugin(t,e){const n=t.moduleName;if(m(e))return void this.scopes.declareVar(n.name,d(0));const r=e.value;if("function"==typeof r&&this.bindFunction(n,r,t.loc),"object"==typeof r){const e={},l=Object.keys(r);for(let n in l){const s=l[n],i=r[s];e[s]="function"==typeof i?this.makeFunction(i,t.loc):i}this.scopes.declareVar(n.name,p(e,!0))}}checkDirectives(t,e){switch(t.type){case"data":this.emitData(t.values,t.dataSize===a.DataSize.Byte?8:16);break;case"fill":this.fillBytes(t);break;case"align":this.alignBytes(t);break;case"setpc":this.handleSetPC(t.pc);break;case"binary":this.emitBinary(t);break;case"include":this.fileInclude(t);break;case"error":{const e=this.evalExprToString(t.error,"error message");if(!m(e))return void this.addError(e.value,t.loc);break}case"if":{const{cases:r,elseBranch:l}=t;for(let t in r){const[l,s]=r[t],i=this.evalExpr(l);if(!m(i)&&(!0===(n=i.value)||0!=n))return this.withAnonScope(e,()=>{this.assembleLines(s)})}return this.withAnonScope(e,()=>{this.assembleLines(l)})}case"for":{const{index:n,list:r,body:l,loc:s}=t,i=this.evalExpr(r);if(m(i))return;const{value:o}=i;if(!(o instanceof Array))return void this.addError("for-loop range must be an array expression (e.g., a range() or an array)",r.loc);for(let t=0;t<o.length;t++){let r=null;null!==e&&(r=`${e}__${t}`),this.withAnonScope(r,()=>(this.scopes.declareVar(n.name,p(o[t],i.completeFirstPass)),this.assembleLines(l)))}break}case"macro":{const{name:e,args:n,body:r}=t;if(void 0!==this.scopes.findQualifiedSym([e.name],!1)&&this.scopes.symbolSeen(e.name))return void this.addError(`Symbol '${e.name}' already defined`,e.loc);this.scopes.declareMacro(e.name,t);break}case"callmacro":{const{name:n,args:r}=t,l=this.scopes.findMacro(n.path,n.absolute),s=r.map(t=>this.evalExpr(t));if(null==l||l.seen<this.pass)return void this.addError(`Undefined macro '${A(n)}'`,n.loc);const{macro:i,declaredIn:o}=l;if(i.args.length!==r.length)return void this.addError(`Macro '${A(n)}' declared with ${i.args.length} args but called here with ${r.length}`,n.loc);this.withAnonScope(e,()=>{for(let t=0;t<s.length;t++){const e=i.args[t].ident.name;this.scopes.declareVar(e,s[t])}this.assembleLines(i.body)},o);break}case"let":{const e=t.name,n=this.scopes.findQualifiedSym([e.name],!1),r=this.evalExpr(t.value);if(void 0!==n&&this.scopes.symbolSeen(e.name))return void this.addError(`Variable '${e.name}' already defined`,t.loc);this.scopes.declareVar(e.name,r);break}case"assign":{const e=t.name;if(1!==t.name.path.length||t.name.absolute)return void this.addError("Only symbol names in the current (or owning) scopes are allowed for assignment",t.loc);const n=this.scopes.findQualifiedSym(t.name.path,t.name.absolute);if(null==n)return void this.addError(`Assignment to undeclared variable '${A(e)}'`,t.loc);if("var"!==n.type)return void this.addError(`Assignment to symbol '${A(e)}' that is not a variable.  Its type is '${n.type}'`,t.loc);const r=this.evalExpr(t.value);this.scopes.updateVar(e.path[0],r);break}case"statement-expr":this.evalExpr(t.expr);break;case"load-plugin":{const e=this.evalExprToString(t.filename,"plugin filename");if(m(e))return;const n=this.requirePlugin(e.value,t.loc);this.bindPlugin(t,n);break}case"filescope":return void this.addError("The !filescope directive is only allowed as the first directive in a source file",t.loc);case"declare-segment":{const{name:e,kwargs:n,loc:r}=t,l=this.scopes.findQualifiedSym([e.name],!1),[s,i]=this.evalKwargToInt(n,"start",r),[o,u]=this.evalKwargToInt(n,"end",r);if(void 0!==l&&this.scopes.symbolSeen(e.name))return void this.addError(`Segment '${e.name}' already defined`,t.loc);const a=this.validateKwargs(n,["start","end"]);if(m(s)||m(o)||!a)return;let c=!1;if(s.completeFirstPass||(this.addError("!segment 'start' must evaluate to a value in the first pass",i),c=!0),o.completeFirstPass||(this.addError("!segment 'end' must evaluate to a value in the first pass",u),c=!0),c)return;const h=this.newSegment(e.name,s.value,o.value,!1);return void this.scopes.declareSegment(e.name,h)}case"use-segment":{const{name:e,loc:n}=t,r=this.scopes.findQualifiedSym(e.path,e.absolute);if(void 0===r)return void this.addError(`Use of undeclared segment '${A(e)}'`,n);if("segment"!==r.type)return void this.addError(`Use of segment '${A(e)}' that is not a declared segment.  Its type is '${r.type}'`,n);this.setCurrentSegment(r,A(e));break}case"break":this.debugInfo.markBreak(this.getPC(),this.curSegmentName);break;default:return void this.addError("unknown directive "+t.type,t.loc)}var n}assembleLines(t){if(null===t||0==t.length)return;if(0==t.length)return;const e=t=>{for(let e=0;e<t.length;e++)this.debugInfo.startLine(t[e].loc,this.getPC(),this.curSegment),this.assembleLine(t[e]),this.debugInfo.endLine(this.getPC(),this.curSegment)};let n=0;for(;n<t.length;){const{label:e,stmt:r,scopedStmts:l}=t[n];if(null!=e||null!=r||null!=l)break;n++}if(n>=t.length)return;const r=t[n];return null!=r.stmt&&"filescope"==r.stmt.type?(this.checkAndDeclareLabel(r.stmt.name),this.withLabelScope(r.stmt.name.name,()=>e(t.slice(n+1)))):e(t)}checkAndDeclareLabel(t){if(this.scopes.symbolSeen(t.name))this.addError(`Symbol '${t.name}' already defined`,t.loc);else{this.scopes.declareLabelSymbol(t,this.getPC(),this.curSegment)&&(this.needPass=!0)}}assembleLine(t){if(this.lineLoc=t.loc,null==t.label&&null==t.stmt&&null==t.scopedStmts)return;null!==t.label&&this.checkAndDeclareLabel(t.label);const e=t.scopedStmts;if(null!=e){if(!t.label)throw new Error("ICE: line.label cannot be undefined");return void this.withLabelScope(t.label.name,()=>{this.assembleLines(e)})}if(null===t.stmt)return;if("insn"!==t.stmt.type)return void this.checkDirectives(t.stmt,null==t.label?null:t.label.name);const n=t.stmt.insn,r=l.default[n.mnemonic.toUpperCase()];void 0!==r?(t=>{const e=this.getPC();t();const n=this.getPC();this.debugInfo.markAsInstruction(e,n)})(()=>{null===n.imm&&null===n.abs&&null===n.absx&&null===n.absy&&null===n.absind&&this.checkSingle(r[10])||this.checkImm(n.imm,r[0])||this.checkAbs(n.abs,r[1],8)||this.checkAbs(n.absx,r[2],8)||this.checkAbs(n.absy,r[3],8)||this.checkAbs(n.absx,r[5],16)||this.checkAbs(n.absy,r[6],16)||this.checkAbs(n.absind,r[7],16)||this.checkAbs(n.indx,r[8],8)||this.checkAbs(n.indy,r[9],8)||this.checkAbs(n.abs,r[4],16)||this.checkBranch(n.abs,r[11])||this.addError(`Couldn't encode instruction '${n.mnemonic}'`,t.loc)}):this.addError(`Unknown mnemonic '${n.mnemonic}'`,t.loc)}makeSourceRelativePath(t){const e=this.peekSourceStack();return s.join(s.dirname(e),t)}assemble(t,e){try{const n=this.parse(t,e);void 0!==n&&this.assembleLines(n)}catch(t){if(!("name"in t)||"SyntaxError"!=t.name){if("name"in t&&"semantic"==t.name)return;throw t}this.addError("Syntax error: "+t.message,Object.assign(Object.assign({},t.location),{source:this.peekSourceStack()}))}}_requireType(t,e){if(typeof t==e)return t;this.addError(`Expecting a ${e} value, got ${w(t)}`,t.loc)}requireString(t){return this._requireType(t,"string")}requireNumber(t){return this._requireType(t,"number")}registerPlugins(){const t=(t,e)=>{this.scopes.declareVar(t,p(e,!1))};t("loadJson",(...t)=>{const e=this.requireString(t[0]),n=this.makeSourceRelativePath(e);return JSON.parse(this.readFileSync(n,"utf-8"))}),t("range",(...t)=>{let e=0,n=void 0;if(1==t.length)n=this.requireNumber(t[0]);else{if(2!=t.length)throw new Error("Invalid number of args to 'range'.  Expecting 1 or 2 arguments.");e=this.requireNumber(t[0]),n=this.requireNumber(t[1])}if(n==e)return[];if(n<e)throw new Error("range 'end' must be larger or equal to 'start'");return Array(n-e).fill(null).map((t,n)=>n+e)});const e={};for(let t of Object.getOwnPropertyNames(Math)){const n=Math;e[t]="random"===t?()=>{throw new Error("Math.random() not allowed as it will lead to non-reproducible builds")}:n[t]}t("Math",e)}dumpLabels(){return this.scopes.dumpLabels(this.getPC(),this.segments)}collectSegmentInfo(){return c.collectSegmentInfo(this.segments)}}const P={readFileSync:o.readFileSync};e.assemble=function(t,e=P){const n=new C(e);n.pushSource(t);let l=0;do{if(n.startPass(l),n.registerPlugins(),n.assemble(t,b(t)),l>0&&n.anyErrors())return{prg:r.from([]),labels:[],segments:[],debugInfo:void 0,errors:n.errors(),warnings:n.warnings()};const e=10;if(l>e)return void console.error("Exceeded max pass limit "+e);if(l+=1,!n.needPass&&0!=n.outOfRangeBranches.length){for(let t in n.outOfRangeBranches){const e=n.outOfRangeBranches[t];n.addError(`Branch target too far (must fit in signed 8-bit range, got ${e.offset})`,e.loc)}break}}while(n.needPass);return n.popSource(),{prg:n.prg(),errors:n.errors(),warnings:n.warnings(),labels:n.dumpLabels(),segments:n.collectSegmentInfo(),debugInfo:n.debugInfo}}}).call(this,n(3),n(1).Buffer)},function(t,e,n){"use strict";const r=n(0),l=n(15),s=n(16);t.exports=t=>{if("string"!=typeof t)throw new TypeError("Expected a string");const e=l(r.dirname(s()),t);if(n.c[e]&&n.c[e].parent){let t=n.c[e].parent.children.length;for(;t--;)n.c[e].parent.children[t].id===e&&n.c[e].parent.children.splice(t,1)}return delete n.c[e],n(19)(e)}},function(t,e,n){"use strict";const r=n(0),l=n(5),s=(t,e,n)=>{if("string"!=typeof t)throw new TypeError(`Expected \`fromDir\` to be of type \`string\`, got \`${typeof t}\``);if("string"!=typeof e)throw new TypeError(`Expected \`moduleId\` to be of type \`string\`, got \`${typeof e}\``);t=r.resolve(t);const s=r.join(t,"noop.js"),i=()=>l._resolveFilename(e,{id:s,filename:s,paths:l._nodeModulePaths(t)});if(n)try{return i()}catch(t){return null}return i()};t.exports=(t,e)=>s(t,e),t.exports.silent=(t,e)=>s(t,e,!0)},function(t,e,n){"use strict";const r=n(17);t.exports=()=>r().getFileName()},function(t,e,n){"use strict";const r=n(18);t.exports=()=>{const t=r();let e;for(let n=0;n<t.length;n++){if(null!==t[n].getTypeName()){e=n;break}}return t[e]}},function(t,e,n){"use strict";t.exports=()=>{const t=Error.prepareStackTrace;Error.prepareStackTrace=(t,e)=>e;const e=(new Error).stack.slice(1);return Error.prepareStackTrace=t,e}},function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=19},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.collectSegmentInfo=e.mergeSegments=e.Segment=void 0;const r=n(6);class l{constructor(t,e,n,r){this.start=t,this.end=e,this.inferStart=n,this.id=r,this.blocks=[{start:t,binary:[]}],this.curBlock=this.blocks[0]}setCurrentPC(t){let e=void 0;if(this.inferStart&&1===this.blocks.length&&0===this.blocks[0].binary.length)this.start=t;else{const n=void 0!==this.end?"$"+r.toHex16(this.end):"",l=`Segment address range: $${r.toHex16(this.start)}-${n}`;t<this.start?e=`${l}.  Cannot set program counter to a lower address $${r.toHex16(t)}.`:void 0!==this.end&&t>this.end?e=`${l}.  Trying to set program counter to $${r.toHex16(t)} -- it is past segment end ${n}.`:1===this.blocks.length&&0===this.blocks[0].binary.length&&(this.start=t)}const n={start:t,binary:[]},l=this.blocks.push(n);return this.curBlock=this.blocks[l-1],e}empty(){return this.blocks.every(t=>0===t.binary.length)}currentPC(){return this.curBlock.start+this.curBlock.binary.length}emit(t){if(this.currentPC()<this.start||void 0!==this.end&&this.currentPC()>this.end){const t=void 0!==this.end?"$"+r.toHex16(this.end):"",e=void 0!==this.start?"$"+r.toHex16(this.start):"";return`Segment overflow at $${r.toHex16(this.currentPC())}.  Segment address range: ${e}-${t}`}this.curBlock.binary.push(t)}formatRange(){const t=void 0!==this.end?"$"+r.toHex16(this.end):"";return`${void 0!==this.start?"$"+r.toHex16(this.start):""}-${t}`}overlaps(t){const e=this.start,n=t.start,r=void 0!==this.end?this.end:this.currentPC(),l=void 0!==t.end?t.end:t.currentPC();return e<n?n<=r:l>=e}}function s(t){const e=[];for(const[n,r]of t){const t=r.blocks.filter(t=>0!==t.binary.length).sort((t,e)=>t.start-e.start);if(0!==t.length){const s=new l(r.start,r.end,r.inferStart,e.length-1);s.blocks=t,s.curBlock=t[t.length-1],e.push([n,s])}}return e}e.Segment=l,e.mergeSegments=function(e){const n=s(e);if(0===n.length)return{startPC:0,binary:t.from([])};const[r,l]=n[0],i=l.blocks[0],o=l.blocks[l.blocks.length-1];let u=i.start,a=o.start+o.binary.length;for(let t=1;t<n.length;t++){const e=n[t][1],r=e.blocks[0].start,l=e.curBlock.start+e.curBlock.binary.length;u=Math.min(r,u),a=Math.max(l,a)}const c=t.alloc(a,0);for(const[e,r]of n)for(const e of r.blocks)t.from(e.binary).copy(c,e.start);return{startPC:u,binary:c.slice(u)}},e.collectSegmentInfo=function(t){return s(t).sort((t,e)=>t[1].start-e[1].start).map(([t,e])=>({name:t,blocks:e.blocks.map(t=>({start:t.start,end:t.start+t.binary.length-1}))}))}}).call(this,n(1).Buffer)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(22);e.default=class{constructor(){this.filenameToSource=new Map,this.sourceToAst=new Map}getFileContents(t,e,n){const r=this.filenameToSource.get(t);if(void 0!==r)return r;const l=n(t,e);return this.filenameToSource.set(t,l),l}parse(t,e,n){const l=this.getFileContents(t,e,n);if(void 0===l)return;const s=this.sourceToAst.get(t);if(void 0!==s)return s;const i=r.parse(l.toString(),{source:t});return this.sourceToAst.set(t,i),i}}},function(t,e,n){"use strict";function r(t,e,n,l){this.message=t,this.expected=e,this.found=n,this.location=l,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(r,Error),r.buildMessage=function(t,e){var n={literal:function(t){return'"'+l(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?s(t.parts[e][0])+"-"+s(t.parts[e][1]):s(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function l(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,l,s=new Array(t.length);for(e=0;e<t.length;e++)s[e]=(l=t[e],n[l.type](l));if(s.sort(),s.length>0){for(e=1,r=1;e<s.length;e++)s[e-1]!==s[e]&&(s[r]=s[e],r++);s.length=r}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+l(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:r,parse:function(t,e){e=void 0!==e?e:{};var l,s={},i={statements:Pe},o=Pe,u=be(":",!1),a=be("in",!1),c=be("+",!1),h=be("as",!1),f=be('"',!1),d={type:"any"},p=function(t,e){return Jn(t,e,1)},m=be("x",!1),g=function(t,e){return function(t,e,n){return{...Qn,mnemonic:t,indx:e,loc:n}}(t,e,tr())},y=be("y",!1),v=function(t,e){return function(t,e,n){return{...Qn,mnemonic:t,indy:e,loc:n}}(t,e,tr())},b=function(t,e){return function(t,e,n){return{...Qn,mnemonic:t,absind:e,loc:n}}(t,e,tr())},w=function(t,e,n){return"x"===n?function(t,e,n){return{...Qn,mnemonic:t,absx:e,loc:n}}(t,e,tr()):function(t,e,n){return{...Qn,mnemonic:t,absy:e,loc:n}}(t,e,tr())},A=be("::",!1),S=be("#",!1),k=function(t,e){return e.reduce((function(t,e){return Zn.mkBinaryOp(e[0],t,e[1],tr())}),t)},E=function(t,e){return{property:e,computed:!0}},C=function(t,e){return{property:Zn.mkIdent(e,tr()),computed:!1}},P=function(t){return Zn.mkLiteral(t,tr())},x=be("$",!1),T=be("%",!1),$=be(".",!1),B=function(){return parseFloat(ve())},I=be("0",!1),L=/^[1-9]/,_=we([["1","9"]],!1,!1),R=be("e",!0),O=/^[+\-]/,M=we(["+","-"],!1,!1),F=function(t){return Zn.mkExprObject(t,tr())},j=/^[a-zA-Z_]/,U=we([["a","z"],["A","Z"],"_"],!1,!1),D=/^[a-zA-Z_0-9]/,Y=we([["a","z"],["A","Z"],"_",["0","9"]],!1,!1),N=/^[0-9]/,z=we([["0","9"]],!1,!1),X=/^[0-1]/,V=we([["0","1"]],!1,!1),K=/^[0-9a-f]/i,H=we([["0","9"],["a","f"]],!1,!0),q=Ae("whitespace"),W=be("\t",!1),Z=be("\v",!1),Q=be("\f",!1),G=be(" ",!1),J=be(" ",!1),tt=be("\ufeff",!1),et=/^[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,nt=we([" "," "," ",[" "," "]," "," ","　"],!1,!1),rt=be(";",!1),lt=/^[\n\r]/,st=we(["\n","\r"],!1,!1),it=Ae("end of line"),ot=be("\n",!1),ut=be("\r\n",!1),at=be("\r",!1),ct=be("!align",!1),ht=be("!byte",!1),ft=be("!word",!1),dt=be("!binary",!1),pt=be("!let",!1),mt=be("!macro",!1),gt=be("!if",!1),yt=be("else",!1),vt=be("elif",!1),bt=be("!error",!1),wt=be("!for",!1),At=be("!include",!1),St=be("!fill",!1),kt=be("!use",!1),Et=be("!filescope",!1),Ct=be("!segment",!1),Pt=be("!break",!1),xt=be("!!",!1),Tt=be("[",!1),$t=be("]",!1),Bt=be("(",!1),It=be(")",!1),Lt=be("{",!1),_t=be("}",!1),Rt=(be("->",!1),be("++",!1),be("--",!1),be("&",!1)),Ot=/^[&]/,Mt=we(["&"],!1,!1),Ft=be("*",!1),jt=/^[=]/,Ut=we(["="],!1,!1),Dt=/^[+=]/,Yt=we(["+","="],!1,!1),Nt=be("-",!1),zt=/^[\-=>]/,Xt=we(["-","=",">"],!1,!1),Vt=be("~",!1),Kt=be("!",!1),Ht=be("/",!1),qt=/^[=>]/,Wt=we(["=",">"],!1,!1),Zt=be("<<",!1),Qt=be(">>",!1),Gt=be("<",!1),Jt=be(">",!1),te=be("<=",!1),ee=be(">=",!1),ne=be("==",!1),re=be("!=",!1),le=be("^",!1),se=be("|",!1),ie=be("&&",!1),oe=be("||",!1),ue=(be("?",!1),/^[>]/),ae=we([">"],!1,!1),ce=(be("...",!1),be("=",!1)),he=(be("*=",!1),be("/=",!1),be("%=",!1),be("+=",!1),be("-=",!1),be("<<=",!1),be(">>=",!1),be("&=",!1),be("^=",!1),be("|=",!1),be(",",!1)),fe=0,de=0,pe=[{line:1,column:1}],me=0,ge=[],ye=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=i[e.startRule]}function ve(){return t.substring(de,fe)}function be(t,e){return{type:"literal",text:t,ignoreCase:e}}function we(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function Ae(t){return{type:"other",description:t}}function Se(e){var n,r=pe[e];if(r)return r;for(n=e-1;!pe[n];)n--;for(r={line:(r=pe[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return pe[e]=r,r}function ke(t,e){var n=Se(t),r=Se(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Ee(t){fe<me||(fe>me&&(me=fe,ge=[]),ge.push(t))}function Ce(t,e,n){return new r(r.buildMessage(t,e),t,e,n)}function Pe(){var t,e,n,r,l,i;if(t=fe,(e=xe())!==s){for(n=[],r=fe,(l=bn())!==s&&(i=xe())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=bn())!==s&&(i=xe())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=Jn(e,n,1)):(fe=t,t=s)}else fe=t,t=s;return t}function xe(){var t,e,n;return t=fe,mn()!==s&&(e=function(){var t,e,n,r;t=fe,(e=$e())!==s&&(n=xn())!==s&&(r=Pe())!==s&&Tn()!==s?(de=t,l=e,i=r,e=Zn.mkAsmLine(l,null,i,tr()),t=e):(fe=t,t=s);var l,i;t===s&&(t=fe,(e=$e())!==s&&(n=Te())!==s?(de=t,e=function(t,e){return Zn.mkAsmLine(t,e,null,tr())}(e,n),t=e):(fe=t,t=s),t===s&&(t=fe,(e=$e())!==s&&(de=t,e=function(t){return Zn.mkAsmLine(t,null,null,tr())}(e)),(t=e)===s&&(t=fe,(e=Te())!==s&&(de=t,u=e,e=Zn.mkAsmLine(null,u,null,tr())),(t=e)===s&&(t=fe,(e=function(){var t,e,n;t=fe,(e=In())!==s&&qn()!==s&&(n=Je())!==s?(de=t,r=n,e=Zn.mkSetPC(r,tr()),t=e):(fe=t,t=s);var r;return t}())!==s&&(de=t,o=e,e=Zn.mkAsmLine(null,o,null,tr())),(t=e)===s&&(t=fe,(e=mn())!==s&&(de=t,e=Zn.mkAsmLine(null,null,null,tr())),t=e)))));var o;var u;return t}())!==s?((n=vn())===s&&(n=null),n!==s?(de=t,t=e):(fe=t,t=s)):(fe=t,t=s),t}function Te(){var e,n,r;return e=fe,(n=function(){var e,n,r,l,i,o,u,f,d,m;e=fe,(n=function(){var e,n;e=fe,"!byte"===t.substr(fe,5)?(n="!byte",fe+=5):(n=s,0===ye&&Ee(ht));n!==s&&mn()!==s?(de=e,e=n="byte"):(fe=e,e=s);return e}())===s&&(n=function(){var e,n;e=fe,"!word"===t.substr(fe,5)?(n="!word",fe+=5):(n=s,0===ye&&Ee(ft));n!==s&&mn()!==s?(de=e,e=n="word"):(fe=e,e=s);return e}());n!==s&&(r=Me())!==s?(de=e,n=function(t,e){const n="byte"==t?Zn.DataSize.Byte:Zn.DataSize.Word;return Zn.mkData(n,e,tr())}(n,r),e=n):(fe=e,e=s);if(e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!fill"===t.substr(fe,5)?(n="!fill",fe+=5):(n=s,0===ye&&Ee(St));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=Je())!==s&&(l=Wn())!==s&&(i=Je())!==s?(de=e,E=r,C=i,n=Zn.mkFill(E,C,tr()),e=n):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!include"===t.substr(fe,8)?(n="!include",fe+=8):(n=s,0===ye&&Ee(At));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=Je())!==s?(de=e,k=r,n=Zn.mkInclude(k,tr()),e=n):(fe=e,e=s),e===s&&(e=fe,(n=An())!==s&&(r=Je())!==s?(l=fe,(i=Wn())!==s?((o=Je())===s&&(o=null),o!==s&&(u=Wn())!==s&&(f=Je())!==s?l=i=[i,o,u,f]:(fe=l,l=s)):(fe=l,l=s),l===s&&(l=null),l!==s?(de=e,n=function(t,e){function n(t,e){return Zn.mkKwarg(Zn.mkIdent(t,e.loc),e,e.loc)}let r=null,l=null;return null!==e?(r=e[1],l=e[3],Zn.mkBinary([n("file",t),n("size",r),n("offset",l)],tr())):Zn.mkBinary([n("file",t)],tr())}(r,l),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=An())!==s&&(r=Cn())!==s&&(l=Re())!==s&&(i=Pn())!==s?(de=e,S=l,n=Zn.mkBinary(S,tr()),e=n):(fe=e,e=s),e===s))))){if(e=fe,(n=function(){var e,n,r;e=fe,"!if"===t.substr(fe,3)?(n="!if",fe+=3):(n=s,0===ye&&Ee(gt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s)if((r=Cn())!==s)if((l=Je())!==s)if((i=Pn())!==s)if((o=xn())!==s)if((u=Pe())!==s)if((f=Tn())!==s){for(d=[],m=Be();m!==s;)d.push(m),m=Be();d!==s?((m=function(){var e,n;e=fe,function(){var e,n,r;e=fe,"else"===t.substr(fe,4)?(n="else",fe+=4):(n=s,0===ye&&Ee(yt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}()!==s&&xn()!==s&&(n=Pe())!==s&&Tn()!==s?(de=e,e=n):(fe=e,e=s);return e}())===s&&(m=null),m!==s?(de=e,n=function(t,e,n,r){const l=[t,...n.map(t=>t.condition)],s=[e,...n.map(t=>t.trueBranch)],i=l.map((t,e)=>[t,s[e]]);return Zn.mkIfElse(i,r,tr())}(l,u,d,m),e=n):(fe=e,e=s)):(fe=e,e=s)}else fe=e,e=s;else fe=e,e=s;else fe=e,e=s;else fe=e,e=s;else fe=e,e=s;else fe=e,e=s;else fe=e,e=s;e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!for"===t.substr(fe,4)?(n="!for",fe+=4):(n=s,0===ye&&Ee(wt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=De())!==s?("in"===t.substr(fe,2)?(l="in",fe+=2):(l=s,0===ye&&Ee(a)),l!==s&&(i=mn())!==s&&(o=Je())!==s&&(u=xn())!==s&&(f=Pe())!==s&&(d=Tn())!==s?(de=e,b=r,w=o,A=f,n=Zn.mkFor(b,w,A,tr()),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!macro"===t.substr(fe,6)?(n="!macro",fe+=6):(n=s,0===ye&&Ee(mt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=function(){var t,e;t=fe,(e=Ye())!==s&&(de=t,n=e,e=Zn.mkIdent(n,tr()));var n;return t=e}())!==s&&(l=Cn())!==s?((i=function(){var t,e,n,r,l,i;if(t=fe,(e=_e())!==s){for(n=[],r=fe,(l=Wn())!==s&&(i=_e())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Wn())!==s&&(i=_e())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,e=p(e,n),t=e):(fe=t,t=s)}else fe=t,t=s;return t}())===s&&(i=null),i!==s&&(o=Pn())!==s&&(u=xn())!==s&&(f=Pe())!==s&&(d=Tn())!==s?(de=e,n=function(t,e,n){return Zn.mkMacro(t,e,n,tr())}(r,i,f),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,43===t.charCodeAt(fe)?(n="+",fe++):(n=s,0===ye&&Ee(c)),n!==s&&(r=Ue())!==s&&(l=Cn())!==s?((i=Me())===s&&(i=null),i!==s&&(o=Pn())!==s?(de=e,y=r,v=i,n=Zn.mkCallMacro(y,v,tr()),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!let"===t.substr(fe,4)?(n="!let",fe+=4):(n=s,0===ye&&Ee(pt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=De())!==s&&(l=qn())!==s&&(i=Je())!==s?(de=e,n=function(t,e){return Zn.mkLet(t,e,tr())}(r,i),e=n):(fe=e,e=s),e===s&&(e=an())===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!use"===t.substr(fe,4)?(n="!use",fe+=4):(n=s,0===ye&&Ee(kt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=Ie())!==s?("as"===t.substr(fe,2)?(l="as",fe+=2):(l=s,0===ye&&Ee(h)),l!==s&&(i=mn())!==s&&(o=De())!==s?(de=e,n=function(t,e){return Zn.mkLoadPlugin(t,e,tr())}(r,o),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!error"===t.substr(fe,6)?(n="!error",fe+=6):(n=s,0===ye&&Ee(bt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=Ie())!==s?(de=e,n=function(t){return Zn.mkError(t,tr())}(r),e=n):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!align"===t.substr(fe,6)?(n="!align",fe+=6):(n=s,0===ye&&Ee(ct));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=Je())!==s?(de=e,g=r,n=Zn.mkAlign(g,tr()),e=n):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!filescope"===t.substr(fe,10)?(n="!filescope",fe+=10):(n=s,0===ye&&Ee(Et));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=De())!==s?(de=e,n=function(t){return Zn.mkFilescope(t,tr())}(r),e=n):(fe=e,e=s),e===s&&(e=fe,(n=Sn())!==s&&(r=De())!==s&&(l=Cn())!==s&&(i=Re())!==s&&(o=Pn())!==s?(de=e,n=function(t,e){return Zn.mkDeclareSegment(t,e,tr())}(r,i),e=n):(fe=e,e=s),e===s&&(e=fe,(n=Sn())!==s&&(r=Ue())!==s?(de=e,n=function(t){return Zn.mkUseSegment(t,tr())}(r),e=n):(fe=e,e=s),e===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!break"===t.substr(fe,6)?(n="!break",fe+=6):(n=s,0===ye&&Ee(Pt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(de=e,n=Zn.mkBreak(tr())),(e=n)===s&&(e=fe,(n=function(){var e,n,r;e=fe,"!!"===t.substr(fe,2)?(n="!!",fe+=2):(n=s,0===ye&&Ee(xt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}())!==s&&(r=function(){var t,e;(t=an())===s&&(t=fe,(e=Je())!==s&&(de=t,n=e,e=Zn.mkStmtExpr(n,tr())),t=e);var n;return t}())!==s?(de=e,e=n=r):(fe=e,e=s)))))))))))))}var g;var y,v;var b,w,A;var S;var k;var E,C;return e}())!==s&&(de=e,n=n),(e=n)===s&&(e=fe,(n=function(){var e,n,r,l,i,o,u;e=fe,(n=Ne())!==s&&(r=function(){var e,n,r,l;e=fe,35===t.charCodeAt(fe)?(n="#",fe++):(n=s,0===ye&&Ee(S));n!==s?((r=function(){var t,e;t=fe,(e=jn())!==s&&(de=t,e="lo");(t=e)===s&&(t=fe,(e=Un())!==s&&(de=t,e="hi"),t=e);return t}())===s&&(r=null),r!==s&&(l=Je())!==s?(de=e,n=function(t,e){if(null!==t){if("lo"===t)return Zn.mkBinaryOp("&",e,Zn.mkLiteral(255,tr(),tr()));const n=Zn.mkLiteral(8,tr()),r=Zn.mkLiteral(255,tr());return Zn.mkBinaryOp("&",Zn.mkBinaryOp(">>",e,n,tr()),r,tr())}return e}(r,l),e=n):(fe=e,e=s)):(fe=e,e=s);return e}())!==s?(de=e,n=Gn(n,r,null,tr()),e=n):(fe=e,e=s);e===s&&(e=fe,(n=Ne())!==s&&(r=Cn())!==s&&(l=ze())!==s&&(i=Wn())!==s?(120===t.charCodeAt(fe)?(o="x",fe++):(o=s,0===ye&&Ee(m)),o!==s&&(u=mn())!==s&&Pn()!==s?(de=e,n=g(n,l),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=Ne())!==s&&(r=Cn())!==s&&(l=ze())!==s&&(i=Pn())!==s&&(o=Wn())!==s?(121===t.charCodeAt(fe)?(u="y",fe++):(u=s,0===ye&&Ee(y)),u!==s&&mn()!==s?(de=e,n=v(n,l),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=Ne())!==s&&(r=Cn())!==s&&(l=ze())!==s&&(i=Pn())!==s?(de=e,n=b(n,l),e=n):(fe=e,e=s),e===s&&(e=fe,(n=Ne())!==s&&(r=ze())!==s&&(l=Wn())!==s?(120===t.charCodeAt(fe)?(i="x",fe++):(i=s,0===ye&&Ee(m)),i===s&&(121===t.charCodeAt(fe)?(i="y",fe++):(i=s,0===ye&&Ee(y))),i!==s&&(o=mn())!==s?(de=e,n=w(n,r,i),e=n):(fe=e,e=s)):(fe=e,e=s),e===s&&(e=fe,(n=Ne())!==s&&(r=ze())!==s?(de=e,n=function(t,e){return Gn(t,null,e,tr())}(n,r),e=n):(fe=e,e=s),e===s&&(e=fe,(n=Ne())!==s&&(de=e,n=function(t){return Gn(t,null,null,tr())}(n)),e=n))))));return e}())!==s&&(de=e,r=n,n=Zn.mkInsn(r,tr())),e=n),e}function $e(){var e,n,r,l;return e=fe,(n=Fe())!==s?(58===t.charCodeAt(fe)?(r=":",fe++):(r=s,0===ye&&Ee(u)),r!==s&&mn()!==s?(de=e,l=n,e=n=Zn.mkLabel(l,tr())):(fe=e,e=s)):(fe=e,e=s),e}function Be(){var e,n,r;return e=fe,function(){var e,n,r;e=fe,"elif"===t.substr(fe,4)?(n="elif",fe+=4):(n=s,0===ye&&Ee(vt));n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s);return e}()!==s&&Cn()!==s&&(n=Je())!==s&&Pn()!==s&&xn()!==s&&(r=Pe())!==s&&Tn()!==s?(de=e,e={condition:n,trueBranch:r}):(fe=e,e=s),e}function Ie(){var e,n,r,l,i;if(e=fe,34===t.charCodeAt(fe)?(n='"',fe++):(n=s,0===ye&&Ee(f)),n!==s){for(r=[],l=Le();l!==s;)r.push(l),l=Le();r!==s?(34===t.charCodeAt(fe)?(l='"',fe++):(l=s,0===ye&&Ee(f)),l!==s&&mn()!==s?(de=e,i=r,e=n=Zn.mkLiteral(i.join(""),tr())):(fe=e,e=s)):(fe=e,e=s)}else fe=e,e=s;return e}function Le(){var e,n,r;return e=fe,n=fe,ye++,34===t.charCodeAt(fe)?(r='"',fe++):(r=s,0===ye&&Ee(f)),ye--,r===s?n=void 0:(fe=n,n=s),n!==s?(t.length>fe?(r=t.charAt(fe),fe++):(r=s,0===ye&&Ee(d)),r!==s?(de=e,e=n=r):(fe=e,e=s)):(fe=e,e=s),e}function _e(){var t,e,n;return t=fe,(e=De())!==s&&(de=t,n=e,e=Zn.mkMacroArg(n)),t=e}function Re(){var t,e,n,r,l,i;if(t=fe,(e=Oe())!==s){for(n=[],r=fe,(l=Wn())!==s&&(i=Oe())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Wn())!==s&&(i=Oe())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=p(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Oe(){var t,e,n,r,l;return t=fe,(e=De())!==s&&qn()!==s&&(n=Je())!==s?(de=t,r=e,l=n,t=e=Zn.mkKwarg(r,l,tr())):(fe=t,t=s),t}function Me(){var t,e,n,r,l,i;if(t=fe,(e=Je())!==s){for(n=[],r=fe,(l=Wn())!==s&&(i=Je())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Wn())!==s&&(i=Je())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=p(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Fe(){var t,e,n,r,l;if(t=fe,e=fe,n=[],(r=cn())!==s)for(;r!==s;)n.push(r),r=cn();else n=s;if(n!==s){for(r=[],l=hn();l!==s;)r.push(l),l=hn();r!==s?e=n=[n,r]:(fe=e,e=s)}else fe=e,e=s;return e!==s&&(de=t,e=ve()),t=e}function je(){var t,e;return t=fe,(e=Fe())!==s&&mn()!==s?(de=t,t=e=e):(fe=t,t=s),t}function Ue(){var e,n,r,l,i,o,u,a,c;if(e=fe,(n=Fe())!==s){for(r=[],l=fe,"::"===t.substr(fe,2)?(i="::",fe+=2):(i=s,0===ye&&Ee(A)),i!==s&&(o=Fe())!==s?l=i=[i,o]:(fe=l,l=s);l!==s;)r.push(l),l=fe,"::"===t.substr(fe,2)?(i="::",fe+=2):(i=s,0===ye&&Ee(A)),i!==s&&(o=Fe())!==s?l=i=[i,o]:(fe=l,l=s);r!==s&&(l=mn())!==s?(de=e,a=n,c=r,e=n=Zn.mkScopeQualifiedIdent(Jn(a,c,1),!1,tr())):(fe=e,e=s)}else fe=e,e=s;if(e===s)if(e=fe,"::"===t.substr(fe,2)?(n="::",fe+=2):(n=s,0===ye&&Ee(A)),n!==s)if((r=Fe())!==s){for(l=[],i=fe,"::"===t.substr(fe,2)?(o="::",fe+=2):(o=s,0===ye&&Ee(A)),o!==s&&(u=Fe())!==s?i=o=[o,u]:(fe=i,i=s);i!==s;)l.push(i),i=fe,"::"===t.substr(fe,2)?(o="::",fe+=2):(o=s,0===ye&&Ee(A)),o!==s&&(u=Fe())!==s?i=o=[o,u]:(fe=i,i=s);l!==s&&(i=mn())!==s?(de=e,e=n=function(t,e){return Zn.mkScopeQualifiedIdent(Jn(t,e,1),!0,tr())}(r,l)):(fe=e,e=s)}else fe=e,e=s;else fe=e,e=s;return e}function De(){var t,e,n;return t=fe,(e=Ye())!==s&&(de=t,n=e,e=Zn.mkIdent(n,tr())),t=e}function Ye(){var t,e;return t=fe,(e=Fe())!==s&&mn()!==s?(de=t,t=e=e):(fe=t,t=s),t}function Ne(){var t,e;return t=fe,(e=Fe())!==s&&mn()!==s?(de=t,t=e=e):(fe=t,t=s),t}function ze(){var t,e;return t=fe,(e=Je())!==s&&(de=t,e=e),t=e}function Xe(){var t,e,n,r,l,i;if(t=fe,(e=tn())!==s){for(n=[],r=fe,(l=In())===s&&(l=Rn())===s&&(l=On()),l!==s&&(i=tn())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=In())===s&&(l=Rn())===s&&(l=On()),l!==s&&(i=tn())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t===s&&(t=nn()),t}function Ve(){var t,e,n,r,l,i;if(t=fe,(e=Xe())!==s){for(n=[],r=fe,(l=Ln())===s&&(l=_n()),l!==s&&(i=Xe())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Ln())===s&&(l=_n()),l!==s&&(i=Xe())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Ke(){var t,e,n,r,l,i;if(t=fe,(e=Ve())!==s){for(n=[],r=fe,(l=Mn())===s&&(l=Fn()),l!==s&&(i=Ve())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Mn())===s&&(l=Fn()),l!==s&&(i=Ve())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function He(){var t,e,n,r,l,i;if(t=fe,(e=Ke())!==s){for(n=[],r=fe,(l=Dn())===s&&(l=Yn())===s&&(l=jn())===s&&(l=Un()),l!==s&&(i=Ke())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Dn())===s&&(l=Yn())===s&&(l=jn())===s&&(l=Un()),l!==s&&(i=Ke())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function qe(){var t,e,n,r,l,i;if(t=fe,(e=He())!==s){for(n=[],r=fe,(l=Nn())===s&&(l=zn()),l!==s&&(i=He())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Nn())===s&&(l=zn()),l!==s&&(i=He())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function We(){var t,e,n,r,l,i;if(t=fe,(e=qe())!==s){for(n=[],r=fe,(l=Bn())!==s&&(i=qe())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Bn())!==s&&(i=qe())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Ze(){var t,e,n,r,l,i;if(t=fe,(e=We())!==s){for(n=[],r=fe,(l=Xn())!==s&&(i=We())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Xn())!==s&&(i=We())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Qe(){var t,e,n,r,l,i;if(t=fe,(e=Ze())!==s){for(n=[],r=fe,(l=Vn())!==s&&(i=Ze())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Vn())!==s&&(i=Ze())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Ge(){var t,e,n,r,l,i;if(t=fe,(e=Qe())!==s){for(n=[],r=fe,(l=Kn())!==s&&(i=Qe())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Kn())!==s&&(i=Qe())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function Je(){var t,e,n,r,l,i;if(t=fe,(e=Ge())!==s){for(n=[],r=fe,(l=Hn())!==s&&(i=Ge())!==s?r=l=[l,i]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Hn())!==s&&(i=Ge())!==s?r=l=[l,i]:(fe=r,r=s);n!==s?(de=t,t=e=k(e,n)):(fe=t,t=s)}else fe=t,t=s;return t}function tn(){var e,n,r,l,i;return(e=function(){var t;(t=function(){var t,e,n;t=fe,(e=en())!==s&&Cn()!==s?((n=Me())===s&&(n=null),n!==s&&Pn()!==s?(de=t,r=e,l=n,e=Zn.mkCallFunc(r,l,tr()),t=e):(fe=t,t=s)):(fe=t,t=s);var r,l;return t}())===s&&(t=en());return t}())===s&&(e=fe,(n=function(){var e,n;e=fe,(n=Ln())===s&&(n=_n())===s&&(n=function(){var e,n;e=fe,126===t.charCodeAt(fe)?(n="~",fe++):(n=s,0===ye&&Ee(Vt));n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s);return e}())===s&&(n=function(){var e,n,r,l;e=fe,33===t.charCodeAt(fe)?(n="!",fe++):(n=s,0===ye&&Ee(Kt));n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s);return e}());n!==s&&(de=e,n=n);return e=n}())!==s&&(r=tn())!==s?(de=e,l=n,i=r,e=n=Zn.mkUnary(l,i,tr())):(fe=e,e=s)),e}function en(){var t,e,n,r,l,i;if(t=fe,(e=nn())!==s){for(n=[],r=fe,kn()!==s&&(l=Je())!==s&&En()!==s?(de=r,r=E(0,l)):(fe=r,r=s),r===s&&(r=fe,$n()!==s&&(l=je())!==s?(de=r,r=C(0,l)):(fe=r,r=s));r!==s;)n.push(r),r=fe,kn()!==s&&(l=Je())!==s&&En()!==s?(de=r,r=E(0,l)):(fe=r,r=s),r===s&&(r=fe,$n()!==s&&(l=je())!==s?(de=r,r=C(0,l)):(fe=r,r=s));n!==s?(de=t,i=e,t=e=n.reduce((function(t,e){return Zn.mkMember(t,e.property,e.computed,tr())}),i)):(fe=t,t=s)}else fe=t,t=s;return t}function nn(){var t,e,n;return t=fe,(e=rn())!==s&&(de=t,e=P(e)),(t=e)===s&&(t=fe,(e=Ue())!==s&&(de=t,e=e),(t=e)===s&&(t=fe,(e=Ie())!==s&&(de=t,e=e),(t=e)===s&&(t=function(){var t,e,n;t=fe,(e=kn())!==s?((n=Me())===s&&(n=null),n!==s&&En()!==s?(de=t,r=n,e=Zn.mkExprArray(null===r?[]:r,tr()),t=e):(fe=t,t=s)):(fe=t,t=s);var r;return t}())===s&&(t=function(){var t,e,n;t=fe,(e=xn())!==s&&yn()!==s&&(n=Tn())!==s?(de=t,e=Zn.mkExprObject([],tr()),t=e):(fe=t,t=s);t===s&&(t=fe,(e=xn())!==s&&yn()!==s&&(n=on())!==s&&yn()!==s&&Tn()!==s?(de=t,e=F(n),t=e):(fe=t,t=s),t===s&&(t=fe,(e=xn())!==s&&yn()!==s&&(n=on())!==s&&yn()!==s&&Wn()!==s&&yn()!==s&&Tn()!==s?(de=t,e=F(n),t=e):(fe=t,t=s)));return t}())===s&&(t=function(){var t,e;t=fe,(e=In())!==s&&(de=t,e=Zn.mkGetCurPC(tr()));return t=e}())===s&&(t=fe,(e=Cn())!==s&&(n=Je())!==s&&Pn()!==s?(de=t,t=e=n):(fe=t,t=s)))),t}function rn(){var e,n,r,l,i;if(e=fe,36===t.charCodeAt(fe)?(n="$",fe++):(n=s,0===ye&&Ee(x)),n!==s){if(r=fe,l=[],(i=pn())!==s)for(;i!==s;)l.push(i),i=pn();else l=s;(r=l!==s?t.substring(r,fe):l)!==s&&(l=mn())!==s?(de=e,e=n=parseInt(r,16)):(fe=e,e=s)}else fe=e,e=s;if(e===s){if(e=fe,37===t.charCodeAt(fe)?(n="%",fe++):(n=s,0===ye&&Ee(T)),n!==s){if(r=fe,l=[],(i=dn())!==s)for(;i!==s;)l.push(i),i=dn();else l=s;(r=l!==s?t.substring(r,fe):l)!==s&&(l=mn())!==s?(de=e,e=n=parseInt(r,2)):(fe=e,e=s)}else fe=e,e=s;e===s&&(e=fe,(n=function(){var e,n,r,l,i;if(e=fe,(n=ln())!==s)if(46===t.charCodeAt(fe)?(r=".",fe++):(r=s,0===ye&&Ee($)),r!==s){for(l=[],i=fn();i!==s;)l.push(i),i=fn();l!==s?((i=sn())===s&&(i=null),i!==s?(de=e,n=B(),e=n):(fe=e,e=s)):(fe=e,e=s)}else fe=e,e=s;else fe=e,e=s;if(e===s){if(e=fe,46===t.charCodeAt(fe)?(n=".",fe++):(n=s,0===ye&&Ee($)),n!==s){if(r=[],(l=fn())!==s)for(;l!==s;)r.push(l),l=fn();else r=s;r!==s?((l=sn())===s&&(l=null),l!==s?(de=e,n=B(),e=n):(fe=e,e=s)):(fe=e,e=s)}else fe=e,e=s;e===s&&(e=fe,(n=ln())!==s?((r=sn())===s&&(r=null),r!==s?(de=e,n=B(),e=n):(fe=e,e=s)):(fe=e,e=s))}return e}())!==s&&(r=mn())!==s?(de=e,e=n=n):(fe=e,e=s))}return e}function ln(){var e,n,r,l;if(48===t.charCodeAt(fe)?(e="0",fe++):(e=s,0===ye&&Ee(I)),e===s)if(e=fe,(n=function(){var e;L.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(_));return e}())!==s){for(r=[],l=fn();l!==s;)r.push(l),l=fn();r!==s?e=n=[n,r]:(fe=e,e=s)}else fe=e,e=s;return e}function sn(){var e,n,r;return e=fe,(n=function(){var e;"e"===t.substr(fe,1).toLowerCase()?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(R));return e}())!==s&&(r=function(){var e,n,r,l;e=fe,O.test(t.charAt(fe))?(n=t.charAt(fe),fe++):(n=s,0===ye&&Ee(M));n===s&&(n=null);if(n!==s){if(r=[],(l=fn())!==s)for(;l!==s;)r.push(l),l=fn();else r=s;r!==s?e=n=[n,r]:(fe=e,e=s)}else fe=e,e=s;return e}())!==s?e=n=[n,r]:(fe=e,e=s),e}function on(){var t,e,n,r,l,i,o;if(t=fe,(e=un())!==s){for(n=[],r=fe,(l=Wn())!==s&&(i=yn())!==s&&(o=un())!==s?r=l=[l,i,o]:(fe=r,r=s);r!==s;)n.push(r),r=fe,(l=Wn())!==s&&(i=yn())!==s&&(o=un())!==s?r=l=[l,i,o]:(fe=r,r=s);n!==s?(de=t,t=e=Jn(e,n,2)):(fe=t,t=s)}else fe=t,t=s;return t}function un(){var e,n,r;return e=fe,(n=function(){var t,e;(t=De())===s&&(t=Ie())===s&&(t=fe,(e=rn())!==s&&(de=t,e=P(e)),t=e);return t}())!==s&&function(){var e,n,r,l;e=fe,58===t.charCodeAt(fe)?(n=":",fe++):(n=s,0===ye&&Ee(u));n!==s?(r=fe,ye++,ue.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(ae)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s);return e}()!==s&&(r=Je())!==s?(de=e,e=n={key:n,val:r}):(fe=e,e=s),e}function an(){var t,e,n,r,l;return t=fe,(e=Ue())!==s&&qn()!==s&&(n=Je())!==s?(de=t,r=e,l=n,t=e=Zn.mkAssign(r,l,tr())):(fe=t,t=s),t}function cn(){var e;return j.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(U)),e}function hn(){var e;return D.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(Y)),e}function fn(){var e;return N.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(z)),e}function dn(){var e;return X.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(V)),e}function pn(){var e;return K.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(H)),e}function mn(){var t,e;for(ye++,t=[],e=gn();e!==s;)t.push(e),e=gn();return ye--,t===s&&(e=s,0===ye&&Ee(q)),t}function gn(){var e;return ye++,9===t.charCodeAt(fe)?(e="\t",fe++):(e=s,0===ye&&Ee(W)),e===s&&(11===t.charCodeAt(fe)?(e="\v",fe++):(e=s,0===ye&&Ee(Z)),e===s&&(12===t.charCodeAt(fe)?(e="\f",fe++):(e=s,0===ye&&Ee(Q)),e===s&&(32===t.charCodeAt(fe)?(e=" ",fe++):(e=s,0===ye&&Ee(G)),e===s&&(160===t.charCodeAt(fe)?(e=" ",fe++):(e=s,0===ye&&Ee(J)),e===s&&(65279===t.charCodeAt(fe)?(e="\ufeff",fe++):(e=s,0===ye&&Ee(tt)),e===s&&(e=function(){var e;et.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(nt));return e}())))))),ye--,e===s&&(s,0===ye&&Ee(q)),e}function yn(){var t,e;for(t=[],(e=gn())===s&&(e=wn())===s&&(e=vn());e!==s;)t.push(e),(e=gn())===s&&(e=wn())===s&&(e=vn());return t}function vn(){var e,n,r,l,i,o;if(e=fe,59===t.charCodeAt(fe)?(n=";",fe++):(n=s,0===ye&&Ee(rt)),n!==s){for(r=[],l=fe,i=fe,ye++,o=bn(),ye--,o===s?i=void 0:(fe=i,i=s),i!==s?(t.length>fe?(o=t.charAt(fe),fe++):(o=s,0===ye&&Ee(d)),o!==s?l=i=[i,o]:(fe=l,l=s)):(fe=l,l=s);l!==s;)r.push(l),l=fe,i=fe,ye++,o=bn(),ye--,o===s?i=void 0:(fe=i,i=s),i!==s?(t.length>fe?(o=t.charAt(fe),fe++):(o=s,0===ye&&Ee(d)),o!==s?l=i=[i,o]:(fe=l,l=s)):(fe=l,l=s);r!==s?e=n=[n,r]:(fe=e,e=s)}else fe=e,e=s;return e}function bn(){var e;return lt.test(t.charAt(fe))?(e=t.charAt(fe),fe++):(e=s,0===ye&&Ee(st)),e}function wn(){var e;return ye++,10===t.charCodeAt(fe)?(e="\n",fe++):(e=s,0===ye&&Ee(ot)),e===s&&("\r\n"===t.substr(fe,2)?(e="\r\n",fe+=2):(e=s,0===ye&&Ee(ut)),e===s&&(13===t.charCodeAt(fe)?(e="\r",fe++):(e=s,0===ye&&Ee(at)))),ye--,e===s&&(s,0===ye&&Ee(it)),e}function An(){var e,n,r;return e=fe,"!binary"===t.substr(fe,7)?(n="!binary",fe+=7):(n=s,0===ye&&Ee(dt)),n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s),e}function Sn(){var e,n,r;return e=fe,"!segment"===t.substr(fe,8)?(n="!segment",fe+=8):(n=s,0===ye&&Ee(Ct)),n!==s&&(r=mn())!==s?e=n=[n,r]:(fe=e,e=s),e}function kn(){var e,n;return e=fe,91===t.charCodeAt(fe)?(n="[",fe++):(n=s,0===ye&&Ee(Tt)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function En(){var e,n;return e=fe,93===t.charCodeAt(fe)?(n="]",fe++):(n=s,0===ye&&Ee($t)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Cn(){var e,n;return e=fe,40===t.charCodeAt(fe)?(n="(",fe++):(n=s,0===ye&&Ee(Bt)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Pn(){var e,n;return e=fe,41===t.charCodeAt(fe)?(n=")",fe++):(n=s,0===ye&&Ee(It)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function xn(){var e,n;return e=fe,123===t.charCodeAt(fe)?(n="{",fe++):(n=s,0===ye&&Ee(Lt)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Tn(){var e,n;return e=fe,125===t.charCodeAt(fe)?(n="}",fe++):(n=s,0===ye&&Ee(_t)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function $n(){var e,n;return e=fe,46===t.charCodeAt(fe)?(n=".",fe++):(n=s,0===ye&&Ee($)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Bn(){var e,n,r,l;return e=fe,38===t.charCodeAt(fe)?(n="&",fe++):(n=s,0===ye&&Ee(Rt)),n!==s?(r=fe,ye++,Ot.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Mt)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function In(){var e,n,r,l;return e=fe,42===t.charCodeAt(fe)?(n="*",fe++):(n=s,0===ye&&Ee(Ft)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Ln(){var e,n,r,l;return e=fe,43===t.charCodeAt(fe)?(n="+",fe++):(n=s,0===ye&&Ee(c)),n!==s?(r=fe,ye++,Dt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Yt)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function _n(){var e,n,r,l;return e=fe,45===t.charCodeAt(fe)?(n="-",fe++):(n=s,0===ye&&Ee(Nt)),n!==s?(r=fe,ye++,zt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Xt)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Rn(){var e,n,r,l;return e=fe,47===t.charCodeAt(fe)?(n="/",fe++):(n=s,0===ye&&Ee(Ht)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function On(){var e,n,r,l;return e=fe,37===t.charCodeAt(fe)?(n="%",fe++):(n=s,0===ye&&Ee(T)),n!==s?(r=fe,ye++,qt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Wt)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Mn(){var e,n,r,l;return e=fe,"<<"===t.substr(fe,2)?(n="<<",fe+=2):(n=s,0===ye&&Ee(Zt)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Fn(){var e,n,r,l;return e=fe,">>"===t.substr(fe,2)?(n=">>",fe+=2):(n=s,0===ye&&Ee(Qt)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function jn(){var e,n,r,l;return e=fe,60===t.charCodeAt(fe)?(n="<",fe++):(n=s,0===ye&&Ee(Gt)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Un(){var e,n,r,l;return e=fe,62===t.charCodeAt(fe)?(n=">",fe++):(n=s,0===ye&&Ee(Jt)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Dn(){var e,n;return e=fe,"<="===t.substr(fe,2)?(n="<=",fe+=2):(n=s,0===ye&&Ee(te)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Yn(){var e,n;return e=fe,">="===t.substr(fe,2)?(n=">=",fe+=2):(n=s,0===ye&&Ee(ee)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Nn(){var e,n;return e=fe,"=="===t.substr(fe,2)?(n="==",fe+=2):(n=s,0===ye&&Ee(ne)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function zn(){var e,n;return e=fe,"!="===t.substr(fe,2)?(n="!=",fe+=2):(n=s,0===ye&&Ee(re)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Xn(){var e,n,r,l;return e=fe,94===t.charCodeAt(fe)?(n="^",fe++):(n=s,0===ye&&Ee(le)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Vn(){var e,n,r,l;return e=fe,124===t.charCodeAt(fe)?(n="|",fe++):(n=s,0===ye&&Ee(se)),n!==s?(r=fe,ye++,jt.test(t.charAt(fe))?(l=t.charAt(fe),fe++):(l=s,0===ye&&Ee(Ut)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Kn(){var e,n;return e=fe,"&&"===t.substr(fe,2)?(n="&&",fe+=2):(n=s,0===ye&&Ee(ie)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function Hn(){var e,n;return e=fe,"||"===t.substr(fe,2)?(n="||",fe+=2):(n=s,0===ye&&Ee(oe)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}function qn(){var e,n,r,l;return e=fe,61===t.charCodeAt(fe)?(n="=",fe++):(n=s,0===ye&&Ee(ce)),n!==s?(r=fe,ye++,61===t.charCodeAt(fe)?(l="=",fe++):(l=s,0===ye&&Ee(ce)),ye--,l===s?r=void 0:(fe=r,r=s),r!==s&&(l=mn())!==s?(de=e,e=n=n):(fe=e,e=s)):(fe=e,e=s),e}function Wn(){var e,n;return e=fe,44===t.charCodeAt(fe)?(n=",",fe++):(n=s,0===ye&&Ee(he)),n!==s&&mn()!==s?(de=e,e=n=n):(fe=e,e=s),e}var Zn=n(7);Zn.objectToAst;const Qn={mnemonic:null,imm:null,abs:null,absx:null,absy:null,absind:null,indx:null,indy:null};function Gn(t,e,n,r){return{...Qn,mnemonic:t,imm:e,abs:n,loc:r}}function Jn(t,e,n){return[t].concat(function(t,e){return t.map((function(t){return t[e]}))}(e,n))}function tr(){return{...ke(de,fe),source:e.source}}if((l=o())!==s&&fe===t.length)return l;throw l!==s&&fe<t.length&&Ee({type:"end"}),Ce(ge,me<t.length?t.charAt(me):null,me<t.length?ke(me,me+1):ke(me,me))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DebugInfoTracker=void 0;const r=n(0),l=n(24);e.DebugInfoTracker=class{constructor(){this.sourceFileSet=new Set,this.sourceFiles=[],this.lineStack=[],this.pcToLocs={},this.insnBitset=new l,this.breakpoints=[]}startLine(t,e,n){const l=r.resolve(t.source),s={source:l,lineNo:t.start.line,segmentId:n.id,numBytes:0};this.lineStack.push({loc:s,pc:e,segmentId:n.id}),this.sourceFileSet.has(l)||(this.sourceFiles.push(l),this.sourceFileSet.add(l))}endLine(t,e){const n=this.lineStack.pop();if(!n)throw new Error("internal compiler error, mismatching start/end lines in debugInfo");const r=t-n.pc;if(r>0&&e.id===n.segmentId){const t=Object.assign(Object.assign({},n.loc),{numBytes:r});void 0===this.pcToLocs[n.pc]?this.pcToLocs[n.pc]=[t]:this.pcToLocs[n.pc].push(t)}}markAsInstruction(t,e){for(let n=t;n<e;n++)this.insnBitset.add(n)}markBreak(t,e){this.breakpoints.push({addr:t,segmentName:e})}info(){const t=this.insnBitset.clone();return{pcToLocs:this.pcToLocs,breakpoints:this.breakpoints,sourceFiles:this.sourceFiles,isInstruction:e=>t.has(e)}}}},function(t,e,n){"use strict";function r(t){if(this.words=[],null!=(n=t)&&void 0!==n[Symbol.iterator])for(var e of t)this.add(e);var n}r.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t},r.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t},r.prototype.clear=function(){this.words=[]},r.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)},r.prototype.isEmpty=function(t){for(var e=this.words.length,n=0;n<e;n++)if(0!==this.words[n])return!1;return!0},r.prototype.has=function(t){return 0!=(this.words[t>>>5]&1<<t)},r.prototype.checkedAdd=function(t){this.resize(t);var e=this.words[t>>>5],n=e|1<<t;return this.words[t>>>5]=n,(n^e)>>>t},r.prototype.trim=function(t){for(var e=this.words.length;e>0&&0===this.words[e-1];)e--;this.words=this.words.slice(0,e)},r.prototype.resize=function(t){for(var e=t+32>>>5,n=this.words.length;n<e;n++)this.words[n]=0},r.prototype.hammingWeight=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},r.prototype.hammingWeight4=function(t,e,n,r){return 16843009*((t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135)+(r=(r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135))>>>24},r.prototype.size=function(){for(var t=0,e=this.words.length,n=this.words,r=0;r<e;r++)t+=this.hammingWeight(n[r]);return t},r.prototype.array=function(){for(var t=new Array(this.size()),e=0,n=this.words.length,r=0;r<n;++r)for(var l=this.words[r];0!=l;){var s=l&-l;t[e++]=(r<<5)+this.hammingWeight(s-1|0),l^=s}return t},r.prototype.forEach=function(t){for(var e=this.words.length,n=0;n<e;++n)for(var r=this.words[n];0!=r;){var l=r&-r;t((n<<5)+this.hammingWeight(l-1|0)),r^=l}},r.prototype.clone=function(){var t=Object.create(r.prototype);return t.words=this.words.slice(),t},r.prototype.intersects=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0;n<e;++n)if(0!=(this.words[n]&t.words[n]))return!0;return!1},r.prototype.intersection=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0;n+7<e;n+=8)this.words[n]&=t.words[n],this.words[n+1]&=t.words[n+1],this.words[n+2]&=t.words[n+2],this.words[n+3]&=t.words[n+3],this.words[n+4]&=t.words[n+4],this.words[n+5]&=t.words[n+5],this.words[n+6]&=t.words[n+6],this.words[n+7]&=t.words[n+7];for(;n<e;++n)this.words[n]&=t.words[n];var r=this.words.length;for(n=e;n<r;++n)this.words[n]=0;return this},r.prototype.intersection_size=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0,r=0;r<e;++r)n+=this.hammingWeight(this.words[r]&t.words[r]);return n},r.prototype.new_intersection=function(t){var e=Object.create(r.prototype),n=Math.min(this.words.length,t.words.length);e.words=new Array(n);for(var l=n,s=0;s+7<l;s+=8)e.words[s]=this.words[s]&t.words[s],e.words[s+1]=this.words[s+1]&t.words[s+1],e.words[s+2]=this.words[s+2]&t.words[s+2],e.words[s+3]=this.words[s+3]&t.words[s+3],e.words[s+4]=this.words[s+4]&t.words[s+4],e.words[s+5]=this.words[s+5]&t.words[s+5],e.words[s+6]=this.words[s+6]&t.words[s+6],e.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<l;++s)e.words[s]=this.words[s]&t.words[s];return e},r.prototype.equals=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0;n<e;++n)if(this.words[n]!=t.words[n])return!1;if(this.words.length<t.words.length){var r=t.words.length;for(n=this.words.length;n<r;++n)if(0!=t.words[n])return!1}else if(t.words.length<this.words.length)for(r=this.words.length,n=t.words.length;n<r;++n)if(0!=this.words[n])return!1;return!0},r.prototype.difference=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0;n+7<e;n+=8)this.words[n]&=~t.words[n],this.words[n+1]&=~t.words[n+1],this.words[n+2]&=~t.words[n+2],this.words[n+3]&=~t.words[n+3],this.words[n+4]&=~t.words[n+4],this.words[n+5]&=~t.words[n+5],this.words[n+6]&=~t.words[n+6],this.words[n+7]&=~t.words[n+7];for(;n<e;++n)this.words[n]&=~t.words[n];return this},r.prototype.difference_size=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0,r=0;r<e;++r)n+=this.hammingWeight(this.words[r]&~t.words[r]);for(var l=this.words.length;r<l;++r)n+=this.hammingWeight(this.words[r]);return n},r.prototype.toString=function(){return"{"+this.array().join(",")+"}"},r.prototype.union=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0;n+7<e;n+=8)this.words[n]|=t.words[n],this.words[n+1]|=t.words[n+1],this.words[n+2]|=t.words[n+2],this.words[n+3]|=t.words[n+3],this.words[n+4]|=t.words[n+4],this.words[n+5]|=t.words[n+5],this.words[n+6]|=t.words[n+6],this.words[n+7]|=t.words[n+7];for(;n<e;++n)this.words[n]|=t.words[n];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);var r=t.words.length;for(n=e;n<r;++n)this.words[n]=t.words[n]}return this},r.prototype.new_union=function(t){var e=Object.create(r.prototype),n=Math.max(this.words.length,t.words.length);e.words=new Array(n);for(var l=Math.min(this.words.length,t.words.length),s=0;s+7<l;s+=8)e.words[s]=this.words[s]|t.words[s],e.words[s+1]=this.words[s+1]|t.words[s+1],e.words[s+2]=this.words[s+2]|t.words[s+2],e.words[s+3]=this.words[s+3]|t.words[s+3],e.words[s+4]=this.words[s+4]|t.words[s+4],e.words[s+5]=this.words[s+5]|t.words[s+5],e.words[s+6]=this.words[s+6]|t.words[s+6],e.words[s+7]=this.words[s+7]|t.words[s+7];for(;s<l;++s)e.words[s]=this.words[s]|t.words[s];var i=this.words.length;for(s=l;s<i;++s)e.words[s]=this.words[s];var o=t.words.length;for(s=l;s<o;++s)e.words[s]=t.words[s];return e},r.prototype.new_difference=function(t){return this.clone().difference(t)},r.prototype.union_size=function(t){for(var e=Math.min(this.words.length,t.words.length),n=0,r=0;r<e;++r)n+=this.hammingWeight(this.words[r]|t.words[r]);if(this.words.length<t.words.length){var l=t.words.length;for(r=this.words.length;r<l;++r)n+=this.hammingWeight(0|t.words[r])}else for(l=this.words.length,r=t.words.length;r<l;++r)n+=this.hammingWeight(0|this.words[r]);return n},t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.disassemble=e.chunkArray=void 0;const r=n(4);function l(t){return""+t.toString(16).toUpperCase().padStart(2,"0")}function s(t){return""+t.toString(16).toUpperCase().padStart(4,"0")}function i(t,e){var n=0,r=t.length,l=[];for(n=0;n<r;n+=e){const r=t.slice(n,n+e);l.push(r)}return l}function o(t,e){const n=63&t,r=t>>6;return 1===r||2===r?`${n}/${n+1}`:3===r?e?`${n+1}/${n+2}`:`${n}/${n+1}`:""+n}e.chunkArray=i;class u{constructor(t,e,n){var i;this.buf=t,this.outputPadChars="     ",this.outputBytesPerLine=1,this.bytes={startPC:0,bytes:[]},this.labelsDict={},this.byte=()=>{const t=this.buf.readUInt8(this.curOffs);return this.curOffs++,t},this.print=(t,e,n,r,i)=>{var o,u;this.flushBytes();const a=l(e[0]),c=e.length>=2?l(e[1]):"  ",h=e.length>=3?l(e[2]):"  ",f=`${s(t)}: ${a} ${c} ${h}${this.outputPadChars}${n}`,d=null===(o=this.disasmOptions)||void 0===o?void 0:o.showCycles,p=null===(u=this.disasmOptions)||void 0===u?void 0:u.showLabels;if(d||p){const t=[];d&&t.push(i),p&&t.push(r),this.output.push(`${f.padEnd(50)}; ${t.join(" ")}`)}else this.output.push(f)},this.output=[],this.curAddr=t.readUInt8(0)+(t.readUInt8(1)<<8),this.curOffs=2,this.disasmOptions=n,this.labels=e,(null===(i=this.disasmOptions)||void 0===i?void 0:i.isInstruction)&&(this.outputPadChars="                    ",this.outputBytesPerLine=8),this.labels&&this.labels.forEach(({name:t,addr:e,size:n})=>{this.labelsDict[e]=t}),this.opToDecl={},Object.keys(r.default).forEach(t=>{let e=r.default[t];for(let n=0;n<e.length;n++){const r=e[n];if(null!==r){const n=e.map(t=>null!==t?255&t:null);this.opToDecl[255&r]={mnemonic:t,decode:n,cycles:r>>8}}}})}flushBytes(){const t=i(this.bytes.bytes,this.outputBytesPerLine);let e=this.bytes.startPC;for(let n=0;n<t.length;n++,e+=this.outputBytesPerLine){const r=t[n].map(t=>l(t)).join(" ");this.output.push(`${s(e)}: ${r}`)}this.bytes.bytes=[]}disImm(t,e,n,r){const s=this.curAddr,i=this.byte(),u=o(r);this.print(s,[e,i],`${t} #$${l(i)}`,n,u)}disZp(t,e,n,r){const s=this.curAddr,i=this.byte(),u=o(r);this.print(s,[e,i],`${t} $${l(i)}`,n,u)}disZpX(t,e,n,r){const s=this.curAddr,i=this.byte(),u=o(r);this.print(s,[e,i],`${t} $${l(i)},X`,n,u)}disZpY(t,e,n,r){const s=this.curAddr,i=this.byte(),u=o(r);this.print(s,[e,i],`${t} $${l(i)},Y`,n,u)}disAbs(t,e,n,r){const l=this.curAddr,i=this.byte(),u=this.byte(),a=o(r);this.print(l,[e,i,u],`${t} $${s(i+256*u)}`,n,a)}disAbsX(t,e,n,r){const l=this.curAddr,i=this.byte(),u=this.byte(),a=o(r);this.print(l,[e,i,u],`${t} $${s(i+256*u)},X`,n,a)}disAbsY(t,e,n,r){const l=this.curAddr,i=this.byte(),u=this.byte(),a=o(r);this.print(l,[e,i,u],`${t} $${s(i+256*u)},Y`,n,a)}disInd(t,e,n,r){const l=this.curAddr,i=this.byte(),u=this.byte(),a=o(r);this.print(l,[e,i,u],`${t} ($${s(i+256*u)})`,n,a)}disIndX(t,e,n,r){const s=this.curAddr,i=this.byte(),u=o(r);this.print(s,[e,i],`${t} ($${l(i)},X)`,n,u)}disIndY(t,e,n,r){const s=this.curAddr,i=this.byte(),u=o(r);this.print(s,[e,i],`${t} ($${l(i)}),Y`,n,u)}disSingle(t,e,n,r){const l=this.curAddr,s=o(r);this.print(l,[e],""+t,n,s)}disBranch(t,e,n,r){const l=this.curAddr,i=this.byte(),u=l+(i>=128?-(256-i):i)+2,a=o(r,(l+2&-256)!=(-256&u));this.print(l,[e,i],`${t} $${s(u)}`,n,a)}disUnknown(t){0!==this.bytes.bytes.length?this.bytes.bytes.push(t):(this.bytes.bytes=[t],this.bytes.startPC=this.curAddr)}disassemble(){const t=this.buf.byteLength;let e=t=>!0;this.disasmOptions&&this.disasmOptions.isInstruction&&(e=this.disasmOptions.isInstruction);let n=this.curOffs;for(;this.curOffs<t;){this.curAddr+=this.curOffs-n;var r="";this.curAddr in this.labelsDict&&(r=this.labelsDict[this.curAddr]),n=this.curOffs;const t=this.byte(),l=this.opToDecl[t];if(e(this.curAddr)&&void 0!==l){const e=l.decode.indexOf(t),n=l.cycles;if(0===e){this.disImm(l.mnemonic,t,r,n);continue}if(1===e){this.disZp(l.mnemonic,t,r,n);continue}if(2===e){this.disZpX(l.mnemonic,t,r,n);continue}if(3===e){this.disZpY(l.mnemonic,t,r,n);continue}if(4===e){this.disAbs(l.mnemonic,t,r,n);continue}if(5===e){this.disAbsX(l.mnemonic,t,r,n);continue}if(6===e){this.disAbsY(l.mnemonic,t,r,n);continue}if(7===e){this.disInd(l.mnemonic,t,r,n);continue}if(8===e){this.disIndX(l.mnemonic,t,r,n);continue}if(9===e){this.disIndY(l.mnemonic,t,r,n);continue}if(10===e){this.disSingle(l.mnemonic,t,r,n);continue}if(11===e){this.disBranch(l.mnemonic,t,r,n);continue}}else this.disUnknown(t)}return this.flushBytes(),this.output}}e.disassemble=function(t,e,n){return new u(t,e,n).disassemble()}}]);