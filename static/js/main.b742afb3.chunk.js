(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){e.exports={heading:"Disasm_heading__2ZRjL",layoutContainer:"Disasm_layoutContainer__36ehI",disasmContainer:"Disasm_disasmContainer__2QplX"}},17:function(e,t,n){e.exports={buttonContainer:"CloseButton_buttonContainer__28ZWo",close:"CloseButton_close__1cumB"}},18:function(e,t,n){e.exports={navContainer:"App_navContainer__32B3M",appTitle:"App_appTitle__2SEQk"}},27:function(e,t,n){e.exports=n(60)},3:function(e,t,n){e.exports={heading:"Editor_heading__3jsuC",layoutContainer:"Editor_layoutContainer__2bFri",editorContainer:"Editor_editorContainer__1wXnR",textarea:"Editor_textarea__28EdL",textareaHighlightOverlay:"Editor_textareaHighlightOverlay__1opTU",textareaHighlightRow:"Editor_textareaHighlightRow__1R6Ia",textareaHighlightRowCurrent:"Editor_textareaHighlightRowCurrent__25KL2",highlightError:"Editor_highlightError__1YeA5",gutter:"Editor_gutter__3CDcX",gutterRow:"Editor_gutterRow__1DNMN",gutterRowSelected:"Editor_gutterRowSelected__3GiGf"}},32:function(e,t,n){},51:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=51},60:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(14),o=n.n(i),s=(n(32),n(4)),l=n(5),c=n(6),u=n(1),d=n(2),h=n(16);var m=n(26),p=n(25),f=n.n(p),g=n(9),v=n.n(g),b=n(3),y=n.n(b);function _(e,t){_=function(e,t){return new i(e,t)};var n=Object(m.a)(RegExp),a=RegExp.prototype,r=new WeakMap;function i(e,t){var a=n.call(this,e);return r.set(a,t),a}function o(e,t){var n=r.get(t);return Object.keys(n).reduce(function(t,a){return t[a]=e[n[a]],t},Object.create(null))}return Object(d.a)(i,n),i.prototype.exec=function(e){var t=a.exec.call(this,e);return t&&(t.groups=o(t,this)),t},i.prototype[Symbol.replace]=function(e,t){if("string"===typeof t){var n=r.get(this);return a[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"===typeof t){var i=this;return a[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==typeof e[e.length-1]&&e.push(o(e,i)),t.apply(this,e)})}return a[Symbol.replace].call(this,e,t)},_.apply(this,arguments)}var x=4;function E(e,t){for(var n=0,a=0;a<t;a++){if(e.length<a)return;"\t"===e[a]?n+=x:n++}return n}function C(e){var t=0;if(!e.text)return null;var n=!0,i=!1,o=void 0;try{for(var s,l=e.text[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){"\t"===s.value?t+=x:t++}}catch(f){i=!0,o=f}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}var c=Array(t).fill(!1),u=!0,d=!1,h=void 0;try{for(var m,p=e.errors[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var f=m.value,g=E(e.text,f.start.column-1);if(void 0===g)return null;var v=f.start.line===f.end.line?E(e.text,f.end.column-1):g+1;if(void 0===v)return null;for(var b=g;b<v;b++)c[b]=!0}}catch(f){d=!0,h=f}finally{try{u||null==p.return||p.return()}finally{if(d)throw h}}for(var _=function(e){var t=void 0,n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;t!==l?(t=l,n.push({code:t,count:1})):n[n.length-1].count++}}catch(f){r=!0,i=f}finally{try{a||null==s.return||s.return()}finally{if(r)throw i}}return n}(c),C=[],w=0;w<_.length;w++){var R=_[w];R.code?C.push(r.a.createElement("pre",{key:w,style:{display:"inline-block"},className:y.a.highlightError}," ".repeat(R.count))):C.push(r.a.createElement("pre",{key:w,style:{display:"inline-block"}}," ".repeat(R.count)))}return r.a.createElement(a.Fragment,null,C)}var w=r.a.forwardRef(function(e,t){for(var n=[],a=e.startRow;a<e.startRow+e.numRows+2;a++){var i=a===e.currentLine&&y.a.textareaHighlightRowCurrent,o=e.lineToErrors.get(a);if(o){var s=e.textLines[a];n.push(r.a.createElement("div",{className:v()(y.a.textareaHighlightRow,i),key:a},r.a.createElement(C,{text:s,errors:o})))}else n.push(r.a.createElement("div",{className:v()(y.a.textareaHighlightRow,i),key:a}))}return r.a.createElement("div",{ref:t,className:y.a.textareaHighlightOverlay},n)}),R=r.a.forwardRef(function(e,t){for(var n=[],a=e.startRow;a<e.startRow+e.numRows+2;a++){var i="".concat(a+1),o=a===e.currentLine&&y.a.gutterRowSelected,s=a>=0&&a<e.numTextRows?i.padStart(4," "):"";n.push(r.a.createElement("div",{className:v()(y.a.gutterRow,o),key:a},s))}return r.a.createElement("div",{ref:t,className:y.a.gutter},n)}),j=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).editorLineHeight=0,n.numEditorCharRows=0,n.textareaRef=r.a.createRef(),n.gutterRef=r.a.createRef(),n.highlighterRef=r.a.createRef(),n.handleScroll=function(e){var t=e.nativeEvent.target.scrollTop;n.setState({scrollTop:t})},n.handleSourceChanged=function(e){n.props.onSourceChanged(e.target.value),n.setState({textLines:e.target.value.split("\n")})},n.updateCursorState=function(){if(n.textareaRef&&n.textareaRef.current){var e=n.textareaRef.current;if(e.selectionStart===e.selectionEnd){var t=e.selectionStart,a=function(e,t){for(var n=e.split("\n"),a=0,r=0;r<n.length;r++)if(t<(a+=n[r].length+1))return r}(n.textareaRef.current.value,t);n.setState({currentLine:a})}else n.setState({currentLine:void 0})}},n.handleSelect=function(e){n.updateCursorState()},n.handleKeyDown=function(e){n.updateCursorState()},n.handleKeyUp=function(e){n.updateCursorState()},n.handleMouseDown=function(e){if(n.textareaRef&&n.textareaRef.current){var t=e.nativeEvent.offsetY+n.state.scrollTop;n.setState({currentLine:Math.min(n.state.textLines.length-1,Math.floor(t/n.editorLineHeight))})}},n.state={scrollTop:0,currentLine:void 0,textLines:[]};var a=getComputedStyle(document.documentElement).getPropertyValue("--code-window-line-height"),i=_(/^[ ]*([0-9]+)px$/,{height:1}).exec(a);if(!i)throw new Error("failed querying css var --code-window-line-height"+a);n.editorLineHeight=parseInt(i.groups.height);var o=getComputedStyle(document.documentElement).getPropertyValue("--code-window-num-lines");if(!(i=_(/^[ ]*([0-9]+)$/,{lines:1}).exec(o)))throw new Error("failed querying css var --code-window-num-lines");return n.numEditorCharRows=parseInt(i.groups.lines),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.textareaRef&&this.textareaRef.current&&(f.a.watch(this.textareaRef.current),this.textareaRef.current.spellcheck=!1,this.textareaRef.current.focus())}},{key:"componentDidUpdate",value:function(e,t){if(this.textareaRef&&this.textareaRef.current&&void 0!==this.props.errorCharOffset&&(this.textareaRef.current.focus(),this.textareaRef.current.setSelectionRange(this.props.errorCharOffset,this.props.errorCharOffset)),t.scrollTop!==this.state.scrollTop){var n=this.state.scrollTop%this.editorLineHeight;this.gutterRef&&this.gutterRef.current&&(this.gutterRef.current.scrollTop=n),this.highlighterRef&&this.highlighterRef.current&&(this.highlighterRef.current.scrollTop=n)}}},{key:"render",value:function(){var e=new Map;this.props.diagnostics.forEach(function(t){var n=t.loc,a=n.start.line-1,r=e.has(a)?e.get(a):[];r.push(n),e.set(a,r)});var t=Math.floor(this.state.scrollTop/this.editorLineHeight);return r.a.createElement("div",{className:y.a.layoutContainer},r.a.createElement("div",{className:y.a.heading},"Assembly"),r.a.createElement("div",{className:y.a.editorContainer},r.a.createElement(R,{ref:this.gutterRef,startRow:t,numRows:this.numEditorCharRows,numTextRows:this.state.textLines.length,currentLine:this.state.currentLine}),r.a.createElement("div",{className:y.a.textContainer,onMouseDown:this.handleMouseDown},r.a.createElement(w,{ref:this.highlighterRef,startRow:t,numRows:this.numEditorCharRows,currentLine:this.state.currentLine,textLines:this.state.textLines,lineToErrors:e}),r.a.createElement("textarea",{wrap:"off",onKeyUp:this.handleKeyUp,onKeyDown:this.handleKeyDown,onSelect:this.handleSelect,onScroll:this.handleScroll,ref:this.textareaRef,onChange:this.handleSourceChanged,className:y.a.textarea}))))}}]),t}(r.a.Component),k=n(15),O=n.n(k),S=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:O.a.layoutContainer},r.a.createElement("div",{className:O.a.heading},"Disassembly"),r.a.createElement("div",{className:O.a.disasmContainer},r.a.createElement("pre",null,this.props.disassembly.join("\n"))))}}]),t}(r.a.Component),D=n(8),I=n.n(D),N=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).itemRef=r.a.createRef(),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t,n){this.itemRef&&this.itemRef.current&&this.props.selected&&this.itemRef.current.scrollIntoView({behavior:"smooth",block:"center"})}},{key:"render",value:function(){var e=this,t=this.props.error,n=t.loc,a=t.msg,i=this.props.selected?" ".concat(I.a.selected):"";return r.a.createElement("div",{ref:this.itemRef,className:"".concat(I.a.diagItem).concat(i),onClick:function(){return e.props.onClickItem(e.props.index)}},r.a.createElement("span",{className:"".concat(I.a.error).concat(i)},"main.asm:",n.start.line,":",n.start.column,": error:")," ",a)}}]),t}(r.a.Component),L=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleOnClickItem=function(e){n.props.onClickItem(e)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.diagnostics;return r.a.createElement("div",{className:I.a.layoutContainer},r.a.createElement("div",{className:I.a.heading},"Diagnostics"),r.a.createElement("div",{className:I.a.diagnostics},r.a.createElement("div",{className:I.a.diagnosticsBox},t.map(function(t,n){return r.a.createElement(N,{key:JSON.stringify(t.loc),index:n,error:t,selected:n===e.props.selectedIndex,onClickItem:e.handleOnClickItem})}))))}}]),t}(r.a.Component),H=n(17),M=n.n(H);function T(e){return r.a.createElement("div",{className:M.a.buttonContainer},r.a.createElement("a",{title:"Close Help",href:"/",target:"_blank",className:M.a.close,onClick:function(t){t.preventDefault(),e.onClose()}}))}var W=n(7),K=n.n(W),B=document.getElementById("modal-root"),U=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).el=void 0,n.el=document.createElement("div"),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){B.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){B.removeChild(this.el)}},{key:"render",value:function(){return o.a.createPortal(this.props.children,this.el)}}]),t}(r.a.Component);function A(e){return r.a.createElement("pre",{className:K.a.asm},function(e){var t,n,a=e.split("\n");for(t=0;t<a.length&&0===a[t].trim().length;t++);for(n=a.length-1;n>=0&&0===a[n].trim().length;n--);return a.slice(t,n+1).join("\n")}(e.text))}var $=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:v()(K.a.helpContents,K.a.maxWidth)},r.a.createElement("div",{className:K.a.headingContainer},r.a.createElement("div",{className:K.a.closeButtonContainer},r.a.createElement(T,{onClose:this.props.onClose})),r.a.createElement("h1",null,"c64jasm online ")),r.a.createElement("p",null,r.a.createElement("a",{href:"https://nurpax.github.io/c64jasm/"},"c64jasm")," is a 6502 assembler written in JavaScript. You can run it either on the command line using Node or link it into a web app."),r.a.createElement("p",null,r.a.createElement("a",{href:"https://nurpax.github.io/c64jasm-browser/"},"c64jasm online")," is an interactive assembler demo site where you can write 6502 assembly with live error reporting and disassembly."),r.a.createElement("h3",null,"Examples"),r.a.createElement("p",null,"Simple instructions and expressions:"),r.a.createElement(A,{text:"\n    lda #2+2  ; expression in an immediate field\n    sta $d020 ; set border color\n        "}),r.a.createElement("p",null,"Labels:"),r.a.createElement(A,{text:"\nentry: {\n    jsr func\n\n    ldx #8\nloop: ; label local to 'entry' scope\n    dex\n    bpl loop\n}\n\nfunc: {\n    ldx #7\nloop: ; label local to 'func' scope\n    sta buf, x   ; store to buf\n    dex\n    bpl loop\n    rts\n\nbuf: !fill 8, 0    ; 8 byte array\n}\n        "}),r.a.createElement("p",null,"Declaring and using variables:"),r.a.createElement(A,{text:"\n!let num_sprites = 4\n!let sprite_mask = (1<<num_sprites)-1\n\n    lda #sprite_mask\n    sta $d015 ; enable sprites 0-3\n        "}),r.a.createElement("p",null,"Conditional compilation and repetition:"),r.a.createElement(A,{text:"\n!let num_sprites = 4\n    lda #13  ; ptr to sprite data 1 (==address/64)\n    ldx #14  ; ptr to sprite data 2\n\n!for i in range(num_sprites) {\n    !if (i < 2) {\n        sta $07f8+i   ; sprite data 1 from A\n    } else {\n        stx $07f8+i   ; sprite data 2 from X\n    }\n}\n        "}),r.a.createElement("p",null,"Define and use macro macro:"),r.a.createElement(A,{text:"\n!macro set_border(color) {\n    lda #color\n    sta $d020\n}\n\n+set_border(13)  ; expand\n        "}))}}]),t}(r.a.Component),V=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.visible;return r.a.createElement(U,null,r.a.createElement("div",{className:v()(e?K.a.helpModalContainer:K.a.hidden)},r.a.createElement("div",{className:K.a.circleReveal},r.a.createElement($,{onClose:this.props.onClose}))))}}]),t}(r.a.Component),F=n(18),Y=n.n(F);var X={useWebWorkers:!0};function G(e){return r.a.createElement("span",{"aria-label":"emoji",role:"img"},e.emoji)}var J=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).assemblerWorker=void 0,n.state={sourceCode:"",disassembly:[],diagnosticsIndex:0,diagnostics:[],helpVisible:!1},n.handleWorkerMessage=function(e){0===e.data.diagnostics.length?n.setState({disassembly:e.data.disassembly,diagnostics:e.data.diagnostics}):n.setState({diagnostics:e.data.diagnostics})},n.handleKeyDown=function(e){"F4"===e.key&&(n.setState(function(t){return 0===t.diagnostics.length?{diagnosticsIndex:0}:void 0===t.diagnosticsIndex?{diagnosticsIndex:0}:e.shiftKey?{diagnosticsIndex:Math.max(0,t.diagnosticsIndex-1)}:{diagnosticsIndex:Math.min(t.diagnostics.length-1,t.diagnosticsIndex+1)}}),e.preventDefault()),"Escape"===e.key&&(n.setState({diagnosticsIndex:void 0,helpVisible:!1}),e.preventDefault())},n.handleOnClickDiagnostic=function(e){n.setState({diagnosticsIndex:e})},n.debouncedCompile=function(e,t){var n=void 0;return function(){for(var a=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];clearTimeout(n),n=window.setTimeout(function(){return e.apply(a,i)},t)}}(function(e){X.useWebWorkers&&n.assemblerWorker&&n.assemblerWorker.postMessage(e)},250),n.handleSetSource=function(e){if(X.useWebWorkers&&n.assemblerWorker)n.debouncedCompile({source:e}),n.setState({sourceCode:e,diagnosticsIndex:void 0});else{var t={readFileSync:function(t){return e}},a=Object(h.assemble)("foo.asm",t);0===a.errors.length?n.setState({sourceCode:e,disassembly:Object(h.disassemble)(a.prg),diagnostics:[],diagnosticsIndex:void 0}):n.setState({sourceCode:e,diagnostics:a.errors,diagnosticsIndex:void 0})}},n.handleClearDiagnosticsSelectionOnKey=function(e){"F4"!==e.key&&"Shift"!==e.key&&void 0!==n.state.diagnosticsIndex&&n.setState({diagnosticsIndex:void 0})},n.handleClearDiagnosticsSelectionOnMouse=function(e){void 0!==n.state.diagnosticsIndex&&n.setState({diagnosticsIndex:void 0})},n.handleClickHelp=function(e){e.preventDefault(),n.setState({helpVisible:!0})},n.handleCloseHelp=function(){n.setState({helpVisible:!1})},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.handleKeyDown),this.assemblerWorker=new Worker("worker.js"),null!==this.assemblerWorker&&this.assemblerWorker.addEventListener("message",function(t){e.handleWorkerMessage(t)})}},{key:"render",value:function(){var e=this.state.diagnostics,t=void 0;if(0!==e.length&&void 0!==this.state.diagnosticsIndex){var n=e[this.state.diagnosticsIndex];t=function(e,t){for(var n=e.split("\n"),a=0,r=0;r<t.start.line-1;r++)a+=n[r].length+1;return a+t.start.column-1}(this.state.sourceCode,n.loc)}return r.a.createElement("div",{id:"root"},r.a.createElement("nav",{id:"mainNav"},r.a.createElement("div",{className:Y.a.navContainer},r.a.createElement("div",{className:Y.a.appTitle},r.a.createElement("a",{href:"https://nurpax.github.io/c64jasm/"},"c64jasm")," online"),r.a.createElement("p",null,"A little experimental 6502 assembler for the C64"),r.a.createElement("p",null,r.a.createElement(G,{emoji:"\ud83d\udc49"})," ",r.a.createElement("a",{onClick:this.handleClickHelp,href:"/",target:"_blank"},"help")),r.a.createElement("p",null,r.a.createElement(G,{emoji:"\ud83d\udc49"})," ",r.a.createElement("a",{href:"https://github.com/nurpax/c64jasm-browser"},"source code")))),r.a.createElement("div",{onKeyDown:this.handleClearDiagnosticsSelectionOnKey,onMouseDown:this.handleClearDiagnosticsSelectionOnMouse,onMouseUp:this.handleClearDiagnosticsSelectionOnMouse,id:"mainCode"},r.a.createElement(j,{onSourceChanged:this.handleSetSource,diagnostics:this.state.diagnostics,errorCharOffset:t})),r.a.createElement("div",{id:"siteDisasm"},r.a.createElement(S,{disassembly:this.state.disassembly})),r.a.createElement("div",{id:"mainDiag"},r.a.createElement(L,{onClickItem:this.handleOnClickDiagnostic,diagnostics:this.state.diagnostics,selectedIndex:this.state.diagnosticsIndex})),r.a.createElement(V,{visible:this.state.helpVisible,onClose:this.handleCloseHelp}))}}]),t}(r.a.Component);o.a.render(r.a.createElement(J,null),document.getElementById("viewport_root"))},7:function(e,t,n){e.exports={helpModalContainer:"Help_helpModalContainer__10bLm",helpContents:"Help_helpContents__3Cbr8",headingContainer:"Help_headingContainer__jN87w",emph:"Help_emph__29_7I",hidden:"Help_hidden__2fGZK",circleReveal:"Help_circleReveal__2igbG",circle:"Help_circle__2jpkq",maxWidth:"Help_maxWidth__3MUy2",closeButtonContainer:"Help_closeButtonContainer__1TIMT",asm:"Help_asm__1yYjY"}},8:function(e,t,n){e.exports={layoutContainer:"DiagnosticsList_layoutContainer__3Yxfa",diagnostics:"DiagnosticsList_diagnostics__U_t5K",heading:"DiagnosticsList_heading__f0lgX",diagnosticsBox:"DiagnosticsList_diagnosticsBox__NbaZi",diagItem:"DiagnosticsList_diagItem__3otDW",selected:"DiagnosticsList_selected__jbDsD",error:"DiagnosticsList_error__1cDSO"}}},[[27,1,2]]]);
//# sourceMappingURL=main.b742afb3.chunk.js.map