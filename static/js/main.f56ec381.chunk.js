(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,n){e.exports={layoutContainer:"DiagnosticsList_layoutContainer__3Yxfa",diagnostics:"DiagnosticsList_diagnostics__U_t5K",diagnosticsBox:"DiagnosticsList_diagnosticsBox__NbaZi",diagItem:"DiagnosticsList_diagItem__3otDW",selected:"DiagnosticsList_selected__jbDsD",error:"DiagnosticsList_error__1cDSO"}},14:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r});var a="\nmodule.exports = {\n  sintab: ({}, len, scale) => {\n      const res = Array(len).fill(0).map((v,i) => Math.sin(i/len * Math.PI * 2.0) * scale);\n      return res;\n  }\n}\n",r="\n!filescope c64\n!macro basic_start(addr) {\n* = $801\n    !byte $0c, $08, $00, $00, $9e\n    !for d in [10000, 1000, 100, 10, 1] {\n        !if (addr >= d) {\n            !byte $30 + (addr/d)%10\n        }\n    }\n    !byte 0, 0, 0\n}\n"},18:function(e,t,n){"use strict";function a(e){return e.slice(2+(e.lastIndexOf(".")-1>>>0))}n.d(t,"a",function(){return a})},2:function(e,t,n){e.exports={layoutContainer:"Editor_layoutContainer__2bFri",editorContainer:"Editor_editorContainer__1wXnR",overlayCommon:"Editor_overlayCommon__36_O2",textarea:"Editor_textarea__28EdL",textareaHighlightOverlay:"Editor_textareaHighlightOverlay__1opTU",textareaHighlightRow:"Editor_textareaHighlightRow__1R6Ia",textareaHighlightRowCurrent:"Editor_textareaHighlightRowCurrent__25KL2",highlightError:"Editor_highlightError__1YeA5",gutter:"Editor_gutter__3CDcX",gutterRow:"Editor_gutterRow__1DNMN",gutterRowSelected:"Editor_gutterRowSelected__3GiGf",textareaSyntaxHighlightOverlay:"Editor_textareaSyntaxHighlightOverlay__31QUS",textareaSyntaxHighlightRow:"Editor_textareaSyntaxHighlightRow__2NLii",hiliteNormal:"Editor_hiliteNormal__3ZDsF",hiliteComment:"Editor_hiliteComment__1s7LO"}},25:function(e,t,n){"use strict";function a(e,t){for(var n=e.split("\n"),a=0,r=0;r<t.start.line-1;r++)a+=n[r].length+1;return a+t.start.column-1}function r(e,t){for(var n=e.split("\n"),a=0,r=0;r<n.length;r++)if(t<(a+=n[r].length+1))return r}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r})},35:function(e,t,n){e.exports={layoutContainer:"Disasm_layoutContainer__36ehI",disasmContainer:"Disasm_disasmContainer__2QplX"}},37:function(e,t,n){e.exports={buttonContainer:"CloseButton_buttonContainer__28ZWo",close:"CloseButton_close__1cumB"}},38:function(e,t,n){e.exports={headerContainer:"App_headerContainer__qCdWC",appTitle:"App_appTitle__2SEQk"}},47:function(e,t,n){"use strict";(function(e){var a=n(5),r=n(1),i=n(6),s=n(10),o=n(3),c=n(4),l=n(0),u=n.n(l),d=n(33),h=n(34),m=n.n(h),f=n(18),p=n(14),g=n(25),v=n(53),b=n(50),x=n(51),C=n(52),E=n(54),y=n(38),_=n.n(y),S={useWebWorkers:!0};var O=function(){function e(){Object(o.a)(this,e),this.cache={}}return Object(c.a)(e,[{key:"update",value:function(e){var t,n=!1,a=Object(s.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;this.cache[r.name]!==r.text&&(this.cache[r.name]=r.text,n=!0),this.cache[r.name]=r.text}}catch(i){a.e(i)}finally{a.f()}return{sourceFileMap:this.cache,changed:n}}}]),e}(),w=[{name:"main.asm",text:e.from(""),cursorOffset:0},{name:"c64.asm",text:e.from(p.a),cursorOffset:0},{name:"plugin.js",text:e.from(p.b),cursorOffset:0}],j=function(t){Object(r.a)(l,t);var n=Object(i.a)(l);function l(){var t;Object(o.a)(this,l);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(t=n.call.apply(n,[this].concat(i))).sourceFileMapCache=new O,t.assemblerWorker=void 0,t.state={gist:{id:"",loadCount:0,loading:!1},sourceFiles:{selected:0,files:w},disassembly:[],prg:e.from([]),diagnosticsIndex:0,diagnostics:[],helpVisible:!1},t.setGistLoadingStatus=function(e){t.setState(function(t){return{gist:Object(a.a)(Object(a.a)({},t.gist),{},{loading:e})}})},t.loadGist=function(n){if(null===n)return window.history.replaceState({},"",decodeURIComponent("".concat(window.location.pathname))),void t.setState(function(t){return{gist:Object(a.a)(Object(a.a)({},t.gist),{},{gistId:n,loadCount:t.gist.loadCount+1}),sourceFiles:{files:w,selected:0},disassembly:[],prg:e.from([]),diagnosticsIndex:0,diagnostics:[]}});t.setGistLoadingStatus(!0),fetch("https://api.github.com/gists/".concat(n),{headers:{Accept:"application/vnd.github.v3.base64"}}).then(function(e){if(200!==e.status)throw new Error("Gist load failed with HTTP status code ".concat(e.status,": ").concat(e.statusText));return e}).then(function(e){return e.json()}).then(function(r){t.setGistLoadingStatus(!1),function(e,t){var n=new URLSearchParams(window.location.search);n.set(e,t),window.history.replaceState({},"",decodeURIComponent("".concat(window.location.pathname,"?").concat(n)))}("gist_id",n),t.setState(function(t){var i,o=[],c=0,l=!1,u=Object(s.a)(Object.values(r.files));try{for(u.s();!(i=u.n()).done;){var d=i.value;"c64.asm"===d.filename&&(l=!0),o.push({name:d.filename,text:e.from(d.content,"base64"),cursorOffset:0}),"main.asm"===d.filename&&(c=o.length-1)}}catch(h){u.e(h)}finally{u.f()}return l||o.push({name:"c64.asm",text:e.from(p.a),cursorOffset:0}),{gist:Object(a.a)(Object(a.a)({},t.gist),{},{gistId:n,loadCount:t.gist.loadCount+1}),sourceFiles:{files:o,selected:c}}},function(){return t.recompile()})}).catch(function(e){console.log(e),t.setState(function(e){return{gist:Object(a.a)(Object(a.a)({},e.gist),{},{loading:!1})}})})},t.getCurrentSource=function(){return t.state.sourceFiles.files[t.state.sourceFiles.selected]},t.updateCurrentSourceFile=function(e,t){return Object(a.a)(Object(a.a)({},e),{},{files:e.files.map(function(n,a){return a===e.selected?t(n):n})})},t.handleWorkerMessage=function(e){0===e.data.diagnostics.length?t.setState({prg:e.data.prg,disassembly:e.data.disassembly,diagnostics:e.data.diagnostics}):t.setState({diagnostics:e.data.diagnostics})},t.handleKeyDown=function(e){"F4"===e.key&&(t.setState(function(n){if(0===n.diagnostics.length)return t.updateDiagnosticsIndexState(n,0);if(void 0===n.diagnosticsIndex)return t.updateDiagnosticsIndexState(n,0);if(e.shiftKey){var a=Math.max(0,n.diagnosticsIndex-1);return t.updateDiagnosticsIndexState(n,a)}var r=Math.min(n.diagnostics.length-1,n.diagnosticsIndex+1);return t.updateDiagnosticsIndexState(n,r)}),e.preventDefault()),"Escape"===e.key&&(t.setState({diagnosticsIndex:void 0,helpVisible:!1}),e.preventDefault())},t.findSourceForDiagnostic=function(e){var n=t.state.sourceFiles.selected;if(void 0===e)return n;for(var a=t.state.sourceFiles.files,r=0;r<a.length;r++){a[r].name===e.loc.source&&(n=r)}return n},t.updateDiagnosticsIndexState=function(e,n){var r=t.state.diagnostics[n],i=t.findSourceForDiagnostic(r);return e.sourceFiles.selected!==i?{diagnosticsIndex:n,sourceFiles:Object(a.a)(Object(a.a)({},e.sourceFiles),{},{selected:i})}:{diagnosticsIndex:n,sourceFiles:e.sourceFiles}},t.handleOnClickDiagnostic=function(e){t.setState(function(n){return t.updateDiagnosticsIndexState(n,e)})},t.debouncedCompile=function(e,t){var n=void 0;return function(){for(var a=this,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];clearTimeout(n),n=window.setTimeout(function(){return e.apply(a,i)},t)}}(function(e){S.useWebWorkers&&t.assemblerWorker&&t.assemblerWorker.postMessage(e)},250),t.recompile=function(){var e=t.sourceFileMapCache.update(t.state.sourceFiles.files),n=e.sourceFileMap;if(e.changed)if(S.useWebWorkers&&t.assemblerWorker)t.debouncedCompile({sourceFileMap:n}),t.setState({diagnosticsIndex:void 0});else{var a={readFileSync:function(e){if(e in n)return n[e];throw new Error("File not found ".concat(e))}},r=Object(d.assemble)("main.asm",a);if(0===r.errors.length){var i={showCycles:!0,showLabels:!0,isInstruction:r.debugInfo.info().isInstruction};t.setState({prg:r.prg,disassembly:Object(d.disassemble)(r.prg,r.labels,i),diagnostics:[],diagnosticsIndex:void 0})}else t.setState({diagnostics:r.errors,diagnosticsIndex:void 0})}},t.handleSetSource=function(n){t.setState(function(r){return{sourceFiles:t.updateCurrentSourceFile(r.sourceFiles,function(t){return Object(a.a)(Object(a.a)({},t),{},{text:e.from(n)})})}},function(){return t.recompile()})},t.handleSetSourcePosition=function(e){t.setState(function(n){return{sourceFiles:t.updateCurrentSourceFile(n.sourceFiles,function(t){return Object(a.a)(Object(a.a)({},t),{},{cursorOffset:e})})}})},t.handleClearDiagnosticsSelectionOnKey=function(e){"F4"!==e.key&&"Shift"!==e.key&&void 0!==t.state.diagnosticsIndex&&t.setState({diagnosticsIndex:void 0})},t.handleClearDiagnosticsSelectionOnMouse=function(e){void 0!==t.state.diagnosticsIndex&&t.setState({diagnosticsIndex:void 0})},t.handleClickHelp=function(){t.setState({helpVisible:!0})},t.handleCloseHelp=function(){t.setState({helpVisible:!1})},t.handleDownloadPRG=function(){var e=new Blob([t.state.prg]);m.a.saveAs(e,"c64jasm-online.prg")},t.handleDownloadDisasm=function(){var e=new Blob([t.state.disassembly.join("\n")],{type:"text/plain;charset=utf-8"});m.a.saveAs(e,"c64jasm-online.s")},t.handleSourceTabSelected=function(e){t.setState(function(t){return{sourceFiles:Object(a.a)(Object(a.a)({},t.sourceFiles),{},{selected:e})}})},t}return Object(c.a)(l,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.handleKeyDown),this.assemblerWorker=new Worker("worker.js"),null!==this.assemblerWorker&&this.assemblerWorker.addEventListener("message",function(t){e.handleWorkerMessage(t)});var t=new URLSearchParams(window.location.search).get("gist_id");null!==t&&this.loadGist(t)}},{key:"render",value:function(){var e=this,t=this.state.diagnostics,n=void 0;if(0!==t.length&&void 0!==this.state.diagnosticsIndex){var a=t[this.state.diagnosticsIndex];if(void 0!==a){var r=this.findSourceForDiagnostic(a),i=this.state.sourceFiles.files[r];n=Object(g.a)(i.text.toString(),a.loc)}}var s=this.state.diagnostics.filter(function(t){return t.loc.source===e.getCurrentSource().name});return u.a.createElement("div",{id:"root"},u.a.createElement("div",{id:"mainHeader"},u.a.createElement("div",{className:_.a.headerContainer},u.a.createElement("div",null,u.a.createElement("div",{className:_.a.appTitle},u.a.createElement("a",{href:"https://nurpax.github.io/c64jasm/"},"c64jasm")," online")))),u.a.createElement("div",{onKeyDown:this.handleClearDiagnosticsSelectionOnKey,onMouseDown:this.handleClearDiagnosticsSelectionOnMouse,onMouseUp:this.handleClearDiagnosticsSelectionOnMouse,id:"mainCode"},u.a.createElement(v.a,{key:"".concat(this.state.gist.id,"/").concat(this.state.gist.loadCount,"/").concat(this.getCurrentSource().name),defaultValue:this.getCurrentSource().text.toString(),defaultCursorOffset:this.getCurrentSource().cursorOffset,onSourceChanged:this.handleSetSource,onSourcePositionChanged:this.handleSetSourcePosition,diagnostics:s,errorCharOffset:n,sourceFileExt:Object(f.a)(this.getCurrentSource().name)})),u.a.createElement("div",{id:"siteDisasm"},u.a.createElement(b.a,{disassembly:this.state.disassembly})),u.a.createElement("div",{id:"mainSourceTabs"},u.a.createElement(C.a,{key:this.state.gist.loadCount,setSelected:this.handleSourceTabSelected,selected:this.state.sourceFiles.selected,files:this.state.sourceFiles.files,onLoadGist:this.loadGist,loadingGist:this.state.gist.loading,renderExtras:function(t){var n=t.Button;return u.a.createElement(u.a.Fragment,null,u.a.createElement(n,{text:"Reset Workspace",title:"Reset the workspace.  Cannot be undone.",onClick:function(){return e.loadGist(null)}}),u.a.createElement(n,{text:"Save PRG",title:"Download compiled binary as C64 .prg",yMargin:!0,onClick:e.handleDownloadPRG}),u.a.createElement(n,{text:"Save Disasm",title:"Download the output disassemble file",onClick:e.handleDownloadDisasm}),u.a.createElement(n,{text:"Help",title:"C64jasm online help",yMargin:!0,onClick:e.handleClickHelp}))}})),u.a.createElement("div",{id:"mainDiag"},u.a.createElement(x.a,{onClickItem:this.handleOnClickDiagnostic,diagnostics:this.state.diagnostics,selectedIndex:this.state.diagnosticsIndex})),u.a.createElement(E.a,{visible:this.state.helpVisible,onClose:this.handleCloseHelp}))}}]),l}(u.a.Component);t.a=j}).call(this,n(28).Buffer)},50:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var a=n(3),r=n(4),i=n(1),s=n(6),o=n(0),c=n.n(o),l=n(35),u=n.n(l),d=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return c.a.createElement("div",{className:u.a.layoutContainer},c.a.createElement("div",{className:"heading"},c.a.createElement("div",{className:"heading-pad"},"Disassembly")),c.a.createElement("div",{className:u.a.disasmContainer},c.a.createElement("pre",null,this.props.disassembly.join("\n"))))}}]),n}(c.a.PureComponent)},51:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n(3),r=n(4),i=n(1),s=n(6),o=n(0),c=n.n(o),l=n(11),u=n.n(l),d=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).itemRef=c.a.createRef(),e}return Object(r.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){this.itemRef&&this.itemRef.current&&this.props.selected&&this.itemRef.current.scrollIntoView({behavior:"smooth",block:"center"})}},{key:"render",value:function(){var e=this,t=this.props.error,n=t.loc,a=t.msg,r=this.props.selected?" ".concat(u.a.selected):"";return c.a.createElement("div",{ref:this.itemRef,className:"".concat(u.a.diagItem).concat(r),onClick:function(){return e.props.onClickItem(e.props.index)}},c.a.createElement("span",{className:"".concat(u.a.error).concat(r)},n.source,":",n.start.line,":",n.start.column,": error:")," ",a)}}]),n}(c.a.Component),h=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).handleOnClickItem=function(t){e.props.onClickItem(t)},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props.diagnostics;return c.a.createElement("div",{className:u.a.layoutContainer},c.a.createElement("div",{className:"heading"},c.a.createElement("div",{className:"heading-pad"},"Diagnostics")),c.a.createElement("div",{className:u.a.diagnostics},c.a.createElement("div",{className:u.a.diagnosticsBox},t.map(function(t,n){return c.a.createElement(d,{key:JSON.stringify(t.loc),index:n,error:t,selected:n===e.props.selectedIndex,onClickItem:e.handleOnClickItem})}))))}}]),n}(c.a.PureComponent)},52:function(e,t,n){"use strict";n.d(t,"a",function(){return E});var a=n(27),r=n(3),i=n(4),s=n(1),o=n(6),c=n(0),l=n.n(c),u=n(8),d=n.n(u),h=n(7),m=n.n(h),f=n(36),p=n(18),g=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={gistIdOrUrl:""},e.handleSubmit=function(t){t.preventDefault();var n=e.state.gistIdOrUrl.split("/");n.length>0&&e.props.onSubmit(n[n.length-1])},e.handleInputChange=function(t){e.setState({gistIdOrUrl:t.target.value})},e.handlePreventBlur=function(e){e.preventDefault()},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return l.a.createElement("form",{onSubmit:this.handleSubmit,onBlur:function(){return e.props.onCancel()},className:m()(d.a.gist,d.a.gistInputContainer)},l.a.createElement("input",{placeholder:"Gist ID or URL",onChange:this.handleInputChange,value:this.state.gistIdOrUrl,onKeyDown:function(t){"Escape"===t.key&&e.props.onCancel()},autoFocus:!0,spellCheck:!1,type:"text"}),l.a.createElement("button",{onMouseDown:this.handlePreventBlur,type:"submit"},"Go!"))}}]),n}(l.a.Component),v=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={editing:!1},e.handleOpenLoadInput=function(){e.setState(function(e){return{editing:!e.editing}})},e.handleResetWorkspace=function(){e.props.onLoadGist(null)},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return this.props.loadingGist?l.a.createElement("div",{className:d.a.gistContainer},l.a.createElement("div",{className:d.a.loadingText},"Loading gist..")):l.a.createElement("div",{className:d.a.gistContainer},this.state.editing&&l.a.createElement(g,{onCancel:function(){return e.setState({editing:!1})},onSubmit:function(t){e.setState({editing:!1}),""!==t&&e.props.onLoadGist(t)}}),!this.state.editing&&l.a.createElement("div",{className:m()(d.a.gist,d.a.gistLoadButtonContainer)},l.a.createElement("button",{onClick:this.handleOpenLoadInput,title:"Load source files from a GitHub public Gist"},"Load Gist")))}}]),n}(l.a.PureComponent),b=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).handleTabClick=function(t,n){e.props.setSelected(n)},e}return Object(i.a)(n,[{key:"render",value:function(){var e=this,t=this.props.sortIdx.map(function(t){var n=e.props.filenames[t];return l.a.createElement("div",{key:n,className:m()(d.a.tab,t===e.props.selected?d.a.active:""),onClick:function(n){return e.handleTabClick(n,t)}},n)});return l.a.createElement("div",{className:d.a.tabContainer},t)}}]),n}(l.a.PureComponent);function x(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=e[0],a=t[0],r=0;r<n.length;r++)if(n[r]!==a[r])return!1;return!0}function C(e){return l.a.createElement("div",{className:m()(d.a.gist,e.yMargin&&d.a.extraYMargin)},l.a.createElement("div",{className:d.a.gistResetButtonContainer},l.a.createElement("button",{onClick:e.onClick,title:e.title},e.text)))}var E=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(r.a)(this,n);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).getFilenames=Object(f.a)(function(e){return e},x),e.getSortOrder=Object(f.a)(function(e){return function(e){for(var t=[],n=0;n<e.length;n++)t.push([e[n],n]);return t.sort(function(e,t){var n=Object(a.a)(e,2),r=n[0],i=(n[1],Object(a.a)(t,2)),s=i[0],o=(i[1],Object(p.a)(r)),c=Object(p.a)(s);return o===c?r.localeCompare(s):o.localeCompare(c)}),t.map(function(e){var t=Object(a.a)(e,2);return t[0],t[1]})}(e)}),e}return Object(i.a)(n,[{key:"render",value:function(){var e=this.getFilenames(this.props.files.map(function(e){return e.name})),t=this.getSortOrder(e);return l.a.createElement("div",{className:d.a.container},l.a.createElement("div",{className:"heading"},l.a.createElement("div",{className:"heading-pad"},"Source files")),l.a.createElement(b,{filenames:e,sortIdx:t,selected:this.props.selected,setSelected:this.props.setSelected}),l.a.createElement(v,{onLoadGist:this.props.onLoadGist,loadingGist:this.props.loadingGist}),this.props.renderExtras&&this.props.renderExtras({Button:function(e){return l.a.createElement(C,e)}}))}}]),n}(l.a.Component)},53:function(e,t,n){"use strict";var a=n(19),r=n(3),i=n(4),s=n(1),o=n(6),c=n(10),l=n(0),u=n.n(l),d=n(48),h=n.n(d),m=n(7),f=n.n(m),p=n(49),g=n(25);function v(e){var t=[],n=Object(a.a)(/^((?:(?!;)[\s\S])*)(;.*)?$/,{code:1,comment:2}).exec(e);if(!n)throw new Error("internal error");var r=n.groups.code,i=n.groups.comment;return void 0!==r&&t.push({text:r,color:"normal"}),void 0!==i&&t.push({text:i,color:"comment"}),t}function b(e){var t=[],n=Object(a.a)(/^(.*)(\/\/.*)$/,{code:1,comment:2}).exec(e);if(!n)return[{text:e,color:"normal"}];var r=n.groups.code,i=n.groups.comment;return void 0!==r&&t.push({text:r,color:"normal"}),void 0!==i&&t.push({text:i,color:"comment"}),t}function x(e,t){var n={asm:v,inc:v,js:b}[e];return void 0!==n?n(t):[{text:t,color:"normal"}]}var C=n(2),E=n.n(C);n.d(t,"a",function(){return R});var y=4;function _(e,t){for(var n=0,a=0;a<t;a++){if(e.length<a)return;"\t"===e[a]?n+=y:n++}return n}function S(e){var t=0;if(!e.text)return null;var n,a=Object(c.a)(e.text);try{for(a.s();!(n=a.n()).done;){"\t"===n.value?t+=y:t++}}catch(o){a.e(o)}finally{a.f()}var r,i=Array(t).fill(!1),s=Object(c.a)(e.errors);try{for(s.s();!(r=s.n()).done;){var o=r.value,d=_(e.text,o.start.column-1);if(void 0===d)return null;var h=o.start.line===o.end.line?_(e.text,o.end.column-1):d+1;if(void 0===h)return null;for(var m=d;m<h;m++)i[m]=!0}}catch(o){s.e(o)}finally{s.f()}for(var f=function(e){var t,n=void 0,a=[],r=Object(c.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n!==i?(n=i,a.push({code:n,count:1})):a[a.length-1].count++}}catch(o){r.e(o)}finally{r.f()}return a}(i),p=[],g=0;g<f.length;g++){var v=f[g];v.code?p.push(u.a.createElement("pre",{key:g,style:{display:"inline-block"},className:E.a.highlightError}," ".repeat(v.count))):p.push(u.a.createElement("pre",{key:g,style:{display:"inline-block"}}," ".repeat(v.count)))}return u.a.createElement(l.Fragment,null,p)}var O=u.a.forwardRef(function(e,t){for(var n=[],a=e.startRow;a<e.startRow+e.numRows+2;a++){var r=a===e.currentLine&&E.a.textareaHighlightRowCurrent,i=e.lineToErrors.get(a);if(i){var s=e.textLines[a];n.push(u.a.createElement("div",{className:f()(E.a.textareaHighlightRow,r),key:a},u.a.createElement(S,{text:s,errors:i})))}else n.push(u.a.createElement("div",{className:f()(E.a.textareaHighlightRow,r),key:a}))}return u.a.createElement("div",{ref:t,className:f()(E.a.overlayCommon,E.a.textareaHighlightOverlay)},n)}),w=u.a.forwardRef(function(e,t){for(var n=[],a={normal:E.a.hiliteNormal,comment:E.a.hiliteComment},r=e.startRow;r<e.startRow+e.numRows+2;r++){var i=[];if(r<e.textLines.length)for(var s=e.textLines[r],o=x(e.sourceFileExt,s),c=0;c<o.length;c++){var l=o[c],d=l.text,h=l.color;i.push(u.a.createElement("pre",{key:c,className:a[h],style:{display:"inline-block"}},d))}n.push(u.a.createElement("div",{className:E.a.textareaSyntaxHighlightRow,key:r},i))}return u.a.createElement("div",{ref:t,className:f()(E.a.overlayCommon,E.a.textareaSyntaxHighlightOverlay),style:{width:"".concat(e.fixedDims.width,"px"),height:"".concat(e.fixedDims.height,"px")}},u.a.createElement("div",{style:{marginLeft:"-".concat(e.scrollLeft,"px")}},n))}),j=u.a.forwardRef(function(e,t){for(var n=[],a=e.startRow;a<e.startRow+e.numRows+2;a++){var r="".concat(a+1),i=a===e.currentLine&&E.a.gutterRowSelected,s=a>=0&&a<e.numTextRows?r.padStart(4," "):"";n.push(u.a.createElement("div",{className:f()(E.a.gutterRow,i),key:a},s))}return u.a.createElement("div",{ref:t,className:E.a.gutter,style:{height:"".concat(e.height,"px")}},n)}),R=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var i;Object(r.a)(this,n),(i=t.call(this,e)).editorLineHeight=0,i.resizeObserver=void 0,i.textareaRef=u.a.createRef(),i.gutterRef=u.a.createRef(),i.highlighterRef=u.a.createRef(),i.syntaxHighlighterRef=u.a.createRef(),i.handleScroll=function(e){var t=e.nativeEvent.target,n=t.scrollTop,a=t.scrollLeft;i.setState({scrollTop:n,scrollLeft:a})},i.handleSourceChanged=function(e){i.props.onSourceChanged(e.target.value),i.setState({textLines:e.target.value.split("\n")})},i.updateCursorState=function(){if(i.textareaRef.current){var e=i.textareaRef.current;if(e.selectionStart===e.selectionEnd){var t=e.selectionStart,n=Object(g.b)(i.textareaRef.current.value,t);i.setState({currentLine:n})}else i.setState({currentLine:void 0});i.props.onSourcePositionChanged(e.selectionStart)}},i.handleSelect=function(e){i.updateCursorState()},i.handleKeyDown=function(e){i.updateCursorState()},i.handleKeyUp=function(e){i.updateCursorState()},i.handleMouseDown=function(e){if(i.textareaRef.current){var t=e.nativeEvent.offsetY+i.state.scrollTop;i.setState({currentLine:Math.min(i.state.textLines.length-1,Math.floor(t/i.editorLineHeight))})}},i.state={scrollTop:0,scrollLeft:0,currentLine:0,textLines:i.props.defaultValue.split("\n"),textareaDims:{width:0,height:0}};var s=getComputedStyle(document.documentElement).getPropertyValue("--code-window-line-height"),o=Object(a.a)(/^ *([0-9]+)px$/,{height:1}).exec(s);if(!o)throw new Error("failed querying css var --code-window-line-height"+s);return i.editorLineHeight=parseInt(o.groups.height),i.resizeObserver=new p.a(function(e){var t=e[0];i.setState({textareaDims:{width:t.contentRect.width,height:t.contentRect.height}})}),i}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.textareaRef.current&&(h.a.watch(this.textareaRef.current),this.textareaRef.current.spellcheck=!1,this.textareaRef.current.selectionStart=this.props.defaultCursorOffset,this.textareaRef.current.selectionEnd=this.props.defaultCursorOffset,this.resizeObserver.observe(this.textareaRef.current),this.textareaRef.current.blur(),this.textareaRef.current.focus())}},{key:"componentWillUnmount",value:function(){this.textareaRef.current&&this.resizeObserver.unobserve(this.textareaRef.current)}},{key:"componentDidUpdate",value:function(e,t){if(this.textareaRef.current&&void 0!==this.props.errorCharOffset&&(this.textareaRef.current.setSelectionRange(this.props.errorCharOffset,this.props.errorCharOffset),this.textareaRef.current.blur(),this.textareaRef.current.focus()),t.scrollTop!==this.state.scrollTop){var n=this.state.scrollTop%this.editorLineHeight;this.gutterRef.current&&(this.gutterRef.current.scrollTop=n),this.highlighterRef.current&&(this.highlighterRef.current.scrollTop=n),this.syntaxHighlighterRef.current&&(this.syntaxHighlighterRef.current.scrollTop=n)}}},{key:"render",value:function(){var e=new Map;this.props.diagnostics.forEach(function(t){var n=t.loc,a=n.start.line-1,r=e.has(a)?e.get(a):[];r.push(n),e.set(a,r)});var t=Math.floor(this.state.scrollTop/this.editorLineHeight),n=0!==this.state.textareaDims.height?Math.ceil(this.state.textareaDims.height/this.editorLineHeight):1;return u.a.createElement("div",{className:E.a.layoutContainer},u.a.createElement("div",{className:"heading"},u.a.createElement("div",{className:"heading-pad"},"Assembly")),u.a.createElement("div",{className:E.a.editorContainer},u.a.createElement(j,{ref:this.gutterRef,startRow:t,numRows:n,numTextRows:this.state.textLines.length,currentLine:this.state.currentLine,height:this.state.textareaDims.height}),u.a.createElement("div",{className:E.a.textContainer,onMouseDown:this.handleMouseDown},u.a.createElement(O,{ref:this.highlighterRef,startRow:t,numRows:n,currentLine:this.state.currentLine,textLines:this.state.textLines,lineToErrors:e}),u.a.createElement("textarea",{className:f()(E.a.overlayCommon,E.a.textarea),defaultValue:this.props.defaultValue,wrap:"off",onKeyUp:this.handleKeyUp,onKeyDown:this.handleKeyDown,onSelect:this.handleSelect,onScroll:this.handleScroll,ref:this.textareaRef,onChange:this.handleSourceChanged}),u.a.createElement(w,{ref:this.syntaxHighlighterRef,startRow:t,fixedDims:this.state.textareaDims,scrollLeft:this.state.scrollLeft,numRows:n,textLines:this.state.textLines,sourceFileExt:this.props.sourceFileExt}))))}}]),n}(u.a.Component)},54:function(e,t,n){"use strict";var a=n(3),r=n(4),i=n(1),s=n(6),o=n(0),c=n.n(o),l=n(22),u=n.n(l),d=n(7),h=n.n(d),m=n(37),f=n.n(m);function p(e){return c.a.createElement("div",{className:f.a.buttonContainer},c.a.createElement("a",{title:"Close Help",href:"/",target:"_blank",className:f.a.close,onClick:function(t){t.preventDefault(),e.onClose()}}))}var g=n(9),v=n.n(g),b=n(14),x=document.getElementById("modal-root"),C=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).el=void 0,r.el=document.createElement("div"),r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){x.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){x.removeChild(this.el)}},{key:"render",value:function(){return u.a.createPortal(this.props.children,this.el)}}]),n}(c.a.Component);function E(e){return c.a.createElement("pre",{className:v.a.asm},function(e){var t,n,a=e.split("\n");for(t=0;t<a.length&&0===a[t].trim().length;t++);for(n=a.length-1;n>=0&&0===a[n].trim().length;n--);return a.slice(t,n+1).join("\n")}(e.text))}var y=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=function(e){return c.a.createElement(o.Fragment,null,c.a.createElement("a",{href:"".concat("/c64jasm-browser","/?gist_id=").concat(e.id)},e.text),"\xa0(",c.a.createElement("a",{href:"https://gist.github.com/nurpax/".concat(e.id)},"view on GitHub"),")")};return c.a.createElement("div",{className:h()(v.a.helpContents,v.a.maxWidth)},c.a.createElement("div",{className:v.a.headingContainer},c.a.createElement("div",{className:v.a.closeButtonContainer},c.a.createElement(p,{onClose:this.props.onClose})),c.a.createElement("h1",null,"c64jasm online ")),c.a.createElement("p",null,c.a.createElement("a",{href:"https://nurpax.github.io/c64jasm/"},"c64jasm")," is a 6502 assembler written in JavaScript. You can run it either on the command line using Node or link it into a web app."),c.a.createElement("p",null,c.a.createElement("a",{href:"https://nurpax.github.io/c64jasm-browser/"},"c64jasm online")," is an interactive assembler demo site where you can write 6502 assembly with live error reporting and disassembly."),c.a.createElement("p",null,"Developed by Janne Hellsten, contact me through ",c.a.createElement("a",{href:"https://twitter.com/nurpax"},"@nurpax")),c.a.createElement("h3",null,"Example projects"),c.a.createElement("p",null,"C64jasm online supports loading source files from GitHub gists. Here's a list of example projects (click on the links to load):"),c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement(e,{id:"4996160f290fa1b9470520d7be0ca25e",text:"Sine sprites"}))),c.a.createElement("h3",null,"Examples"),c.a.createElement("p",null,"Simple instructions and expressions:"),c.a.createElement(E,{text:"\n    lda #2+2  ; expression in an immediate field\n    sta $d020 ; set border color\n        "}),c.a.createElement("p",null,"Labels:"),c.a.createElement(E,{text:"\nentry: {\n    jsr func\n\n    ldx #8\nloop: ; label local to 'entry' scope\n    dex\n    bpl loop\n}\n\nfunc: {\n    ldx #7\nloop: ; label local to 'func' scope\n    sta buf, x   ; store to buf\n    dex\n    bpl loop\n    rts\n\nbuf: !fill 8, 0    ; 8 byte array\n}\n        "}),c.a.createElement("p",null,"Declaring and using variables:"),c.a.createElement(E,{text:"\n!let num_sprites = 4\n!let sprite_mask = (1<<num_sprites)-1\n\n    lda #sprite_mask\n    sta $d015 ; enable sprites 0-3\n        "}),c.a.createElement("p",null,"Conditional compilation and repetition:"),c.a.createElement(E,{text:"\n!let num_sprites = 4\n    lda #13  ; ptr to sprite data 1 (==address/64)\n    ldx #14  ; ptr to sprite data 2\n\n!for i in range(num_sprites) {\n    !if (i < 2) {\n        sta $07f8+i   ; sprite data 1 from A\n    } else {\n        stx $07f8+i   ; sprite data 2 from X\n    }\n}\n        "}),c.a.createElement("p",null,"Define and use macro macro:"),c.a.createElement(E,{text:"\n!macro set_border(color) {\n    lda #color\n    sta $d020\n}\n\n+set_border(13)  ; expand\n        "}),c.a.createElement("p",null,"A complete C64 program.  To compile a C64 ",c.a.createElement("code",null,".prg")," you need to insert a BASIC startup sequence at the beginning of your output ",c.a.createElement("code",null,".prg")," -- you can use the ",c.a.createElement("code",null,"c64::basic_entry")," macro to do this. The source code to these macros is shown in a later section."),c.a.createElement(E,{text:'\n!include "c64.asm"\n\n+c64::basic_start(entry)\n\nentry: {\n    lda #0\n}\n        '}),c.a.createElement("h3",null,"Built-in support macros"),c.a.createElement("p",null,"The c64jasm online site includes a small built in macro library.  You can find its source code below."),c.a.createElement("p",null,"The builtin ",c.a.createElement("code",null,"c64.asm")," contents:"),c.a.createElement(E,{text:b.a}))}}]),n}(c.a.Component),_=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props.visible;return c.a.createElement(C,null,c.a.createElement("div",{className:h()(e?v.a.helpModalContainer:v.a.hidden)},c.a.createElement("div",{className:v.a.circleReveal},c.a.createElement(y,{onClose:this.props.onClose}))))}}]),n}(c.a.Component);t.a=_},55:function(e,t,n){e.exports=n(56)},56:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(22),s=n.n(i),o=(n(61),n(47));s.a.render(r.a.createElement(o.a,null),document.getElementById("viewport_root"))},61:function(e,t,n){},77:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=77},8:function(e,t,n){e.exports={container:"SourceTabs_container__2NQsa",tabContainer:"SourceTabs_tabContainer__2X9q3",gistContainer:"SourceTabs_gistContainer__1hQke",gistInputContainer:"SourceTabs_gistInputContainer__fGFjd",tab:"SourceTabs_tab__2FK_a",active:"SourceTabs_active__1mZcV",gist:"SourceTabs_gist__3Emgh",extraYMargin:"SourceTabs_extraYMargin__1uDab",gistLoadButtonContainer:"SourceTabs_gistLoadButtonContainer__3NcSa",gistResetButtonContainer:"SourceTabs_gistResetButtonContainer__3PwhC",loadingText:"SourceTabs_loadingText__3UiVE"}},9:function(e,t,n){e.exports={helpModalContainer:"Help_helpModalContainer__10bLm",helpContents:"Help_helpContents__3Cbr8",headingContainer:"Help_headingContainer__jN87w",emph:"Help_emph__29_7I",hidden:"Help_hidden__2fGZK",circleReveal:"Help_circleReveal__2igbG",circle:"Help_circle__2jpkq",maxWidth:"Help_maxWidth__3MUy2",closeButtonContainer:"Help_closeButtonContainer__1TIMT",asm:"Help_asm__1yYjY"}}},[[55,1,2]]]);
//# sourceMappingURL=main.f56ec381.chunk.js.map