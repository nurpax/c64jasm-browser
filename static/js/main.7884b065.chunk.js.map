{"version":3,"sources":["Editor.module.css","SourceTabs.module.css","Help.module.css","DiagnosticsList.module.css","asmBuiltins.ts","Disasm.module.css","editing.ts","CloseButton.module.css","App.module.css","App.tsx","Editor.tsx","Disasm.tsx","DiagnosticsList.tsx","SourceTabs.tsx","CloseButton.tsx","Help.tsx","index.tsx","../node_modules/import-fresh sync"],"names":["module","exports","heading","layoutContainer","editorContainer","textarea","textareaHighlightOverlay","textareaHighlightRow","textareaHighlightRowCurrent","highlightError","gutter","gutterRow","gutterRowSelected","container","tabContainer","gistContainer","gistInputContainer","tab","active","gistLoadButtonContainer","loadingText","helpModalContainer","helpContents","headingContainer","emph","hidden","circleReveal","circle","maxWidth","closeButtonContainer","asm","diagnostics","diagnosticsBox","diagItem","selected","error","__webpack_require__","d","__webpack_exports__","c64","disasmContainer","downloadButton","findCharOffset","source","loc","lines","split","offset","i","start","line","length","column","findLine","charOffset","buttonContainer","close","navContainer","appTitle","config","useWebWorkers","Emoji","props","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","aria-label","role","emoji","App","assemblerWorker","undefined","state","gist","id","loadCount","loading","sourceFiles","files","name","text","cursorOffset","asmBuiltins","disassembly","prg","Buffer","from","diagnosticsIndex","helpVisible","setGistLoadingStatus","_this2","setState","prevState","Object","_home_janne_dev_c64jasm_browser_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","loadGist","gistId","fetch","concat","then","resp","status","Error","statusText","json","value","params","URLSearchParams","window","location","search","set","history","replaceState","decodeURIComponent","pathname","setQueryStringParameter","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","values","Symbol","iterator","next","done","file","push","filename","content","err","recompile","console","log","getCurrentSource","updateCurrentSource","map","e","idx","handleWorkerMessage","data","handleKeyDown","key","shiftKey","Math","max","min","preventDefault","handleOnClickDiagnostic","debouncedCompile","fn","delay","timeoutID","_this","this","_len","arguments","args","Array","_key","clearTimeout","setTimeout","apply","debounce","asmArgs","postMessage","sourceFileMap","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","options","readFileSync","fname","res","assemble","errors","disasmOptions","isInstruction","debugInfo","info","disassemble","handleSetSource","handleClearDiagnosticsSelectionOnKey","handleClearDiagnosticsSelectionOnMouse","handleClickHelp","handleCloseHelp","handleSourceTabSelected","_this3","document","addEventListener","Worker","msg","get","diags","editorErrorLoc","className","styles","href","onClick","target","onKeyDown","onMouseDown","onMouseUp","_Editor__WEBPACK_IMPORTED_MODULE_10__","defaultValue","defaultCursorOffset","onSourceChanged","errorCharOffset","_Disasm__WEBPACK_IMPORTED_MODULE_11__","_SourceTabs__WEBPACK_IMPORTED_MODULE_13__","setSelected","onLoadGist","loadingGist","_DiagnosticsList__WEBPACK_IMPORTED_MODULE_12__","onClickItem","selectedIndex","_Help__WEBPACK_IMPORTED_MODULE_14__","visible","onClose","React","Component","tabLength","computeColumn","charIndex","col","ErrorSpans","lineLength","buf","fill","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","end","x","rled","cur","out","v","code","count","groupSame","spans","span","style","display","repeat","react__WEBPACK_IMPORTED_MODULE_6__","Highlighter","forwardRef","ref","rows","startRow","numRows","currentLine","lineToErrors","textLines","cn","Gutter","str","numStr","numTextRows","padStart","_default","_home_janne_dev_c64jasm_browser_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","_home_janne_dev_c64jasm_browser_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_home_janne_dev_c64jasm_browser_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","editorLineHeight","numEditorCharRows","textareaRef","createRef","gutterRef","highlighterRef","handleScroll","scrollTop","nativeEvent","handleSourceChanged","current","selectionStart","updateCursorState","r","selectionEnd","handleSelect","handleKeyUp","handleMouseDown","yoffs","offsetY","floor","cssVarLineHeight","getComputedStyle","documentElement","getPropertyValue","match","_wrapRegExp","height","exec","parseInt","groups","cssNumLines","indentTextarea","watch","spellcheck","focus","prevProps","setSelectionRange","vscroll","lineToErrorsMap","Map","forEach","_ref2","lst","has","startCharRow","textContainer","wrap","onKeyUp","onSelect","onScroll","onChange","DownloadButton","react__WEBPACK_IMPORTED_MODULE_5___default","handleDownloadPRG","blob","Blob","FileSaver","saveAs","join","Diagnostic","itemRef","snapshot","scrollIntoView","behavior","block","_this$props$error","selectedClass","index","DiagnosticsList","handleOnClickItem","_this4","JSON","stringify","LoadGistInput","gistIdOrUrl","handleSubmit","parts","onSubmit","handleInputChange","handlePreventBlur","onBlur","onCancel","placeholder","autoFocus","spellCheck","type","LoadGist","editing","handleOpenLoadInput","title","handleTabClick","_this5","_this6","tabs","_ref","CloseButton","react_default","modalRoot","getElementById","Modal","classCallCheck","possibleConstructorReturn","getPrototypeOf","el","appendChild","removeChild","ReactDOM","createPortal","children","AsmBlock","s","trim","slice","trimLineFeeds","HelpContents","react","process","HelpModal","Help_Modal","Help_HelpContents","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","react_dom__WEBPACK_IMPORTED_MODULE_1__","react_dom__WEBPACK_IMPORTED_MODULE_1___default","_App__WEBPACK_IMPORTED_MODULE_3__","render","webpackEmptyContext","req","keys","resolve"],"mappings":"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","file":"static/js/main.7884b065.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"Editor_heading__3jsuC\",\"layoutContainer\":\"Editor_layoutContainer__2bFri\",\"editorContainer\":\"Editor_editorContainer__1wXnR\",\"textarea\":\"Editor_textarea__28EdL\",\"textareaHighlightOverlay\":\"Editor_textareaHighlightOverlay__1opTU\",\"textareaHighlightRow\":\"Editor_textareaHighlightRow__1R6Ia\",\"textareaHighlightRowCurrent\":\"Editor_textareaHighlightRowCurrent__25KL2\",\"highlightError\":\"Editor_highlightError__1YeA5\",\"gutter\":\"Editor_gutter__3CDcX\",\"gutterRow\":\"Editor_gutterRow__1DNMN\",\"gutterRowSelected\":\"Editor_gutterRowSelected__3GiGf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SourceTabs_container__2NQsa\",\"tabContainer\":\"SourceTabs_tabContainer__2X9q3\",\"gistContainer\":\"SourceTabs_gistContainer__1hQke\",\"gistInputContainer\":\"SourceTabs_gistInputContainer__fGFjd\",\"tab\":\"SourceTabs_tab__2FK_a\",\"active\":\"SourceTabs_active__1mZcV\",\"gistLoadButtonContainer\":\"SourceTabs_gistLoadButtonContainer__3NcSa\",\"loadingText\":\"SourceTabs_loadingText__3UiVE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"helpModalContainer\":\"Help_helpModalContainer__10bLm\",\"helpContents\":\"Help_helpContents__3Cbr8\",\"headingContainer\":\"Help_headingContainer__jN87w\",\"emph\":\"Help_emph__29_7I\",\"hidden\":\"Help_hidden__2fGZK\",\"circleReveal\":\"Help_circleReveal__2igbG\",\"circle\":\"Help_circle__2jpkq\",\"maxWidth\":\"Help_maxWidth__3MUy2\",\"closeButtonContainer\":\"Help_closeButtonContainer__1TIMT\",\"asm\":\"Help_asm__1yYjY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layoutContainer\":\"DiagnosticsList_layoutContainer__3Yxfa\",\"diagnostics\":\"DiagnosticsList_diagnostics__U_t5K\",\"heading\":\"DiagnosticsList_heading__f0lgX\",\"diagnosticsBox\":\"DiagnosticsList_diagnosticsBox__NbaZi\",\"diagItem\":\"DiagnosticsList_diagItem__3otDW\",\"selected\":\"DiagnosticsList_selected__jbDsD\",\"error\":\"DiagnosticsList_error__1cDSO\"};","\nexport const c64 = `\n!filescope c64\n!macro basic_start(addr) {\n* = $801\n    !byte $0c, $08, $00, $00, $9e\n    !for d in [10000, 1000, 100, 10, 1] {\n        !if (addr >= d) {\n            !byte $30 + (addr/d)%10\n        }\n    }\n    !byte 0, 0, 0\n}\n`;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"Disasm_heading__2ZRjL\",\"layoutContainer\":\"Disasm_layoutContainer__36ehI\",\"disasmContainer\":\"Disasm_disasmContainer__2QplX\",\"downloadButton\":\"Disasm_downloadButton__3MkkT\"};","\nimport { SourceLoc } from 'c64jasm';\n\nexport function findCharOffset(source: string, loc: SourceLoc) {\n  const lines = source.split('\\n');\n  let offset = 0;\n  for (let i = 0; i < loc.start.line - 1; i++) {\n    offset += lines[i].length + 1;\n  }\n  return offset + loc.start.column - 1;\n}\n\nexport function findLine(source: string, charOffset: number) {\n  const lines = source.split('\\n');\n  let offset = 0;\n  for (let i = 0; i < lines.length; i++) {\n    offset += lines[i].length + 1;\n    if (charOffset < offset) {\n        return i;\n    }\n  }\n  return undefined;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttonContainer\":\"CloseButton_buttonContainer__28ZWo\",\"close\":\"CloseButton_close__1cumB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navContainer\":\"App_navContainer__32B3M\",\"appTitle\":\"App_appTitle__2SEQk\"};","import React from 'react';\n\nimport { assemble, disassemble } from 'c64jasm';\n\nimport { Diag, SourceFile } from './types';\nimport * as asmBuiltins from './asmBuiltins';\nimport { findCharOffset }  from './editing';\n\nimport Editor from './Editor';\nimport Disasm from './Disasm';\nimport DiagnosticsList from './DiagnosticsList';\nimport SourceTabs from './SourceTabs';\nimport Help from './Help';\n\nimport styles from './App.module.css';\n\nconst config = { useWebWorkers: true };\n\nfunction setQueryStringParameter(name: string, value: string) {\n  const params = new URLSearchParams(window.location.search);\n  params.set(name, value);\n  window.history.replaceState({}, \"\", decodeURIComponent(`${window.location.pathname}?${params}`));\n}\n\nexport function debounce<F extends (...params: any[]) => void>(fn: F, delay: number) {\n  let timeoutID: number|undefined = undefined;\n  return function(this: any, ...args: any[]) {\n    clearTimeout(timeoutID);\n    timeoutID = window.setTimeout(() => fn.apply(this, args), delay);\n  } as F;\n}\n\n\nfunction Emoji(props: {emoji: string}) {\n  return <span aria-label='emoji' role='img'>{props.emoji}</span>\n}\n\ninterface SourceFiles {\n  selected: number;\n  files: SourceFile[];\n};\n\ninterface AppState {\n  gist: {\n    id: string;\n    loadCount: number;\n    loading: boolean;\n  };\n  sourceFiles: SourceFiles;\n  disassembly: string[];\n  prg: Buffer;\n  diagnosticsIndex: number | undefined;\n  diagnostics: Diag[];\n  helpVisible: boolean;\n};\n\nclass App extends React.Component<{}, AppState> {\n\n  assemblerWorker: Worker | undefined = undefined;\n\n  state = {\n    gist: {\n      id: '',\n      loadCount: 0,\n      loading: false\n    },\n    sourceFiles: {\n      selected: 0,\n      files: [\n        { name: 'main.asm', text: '', cursorOffset: 0 },\n        { name: 'c64.asm', text: asmBuiltins.c64, cursorOffset: 0 }\n      ]\n    },\n    disassembly: [],\n    prg: Buffer.from([]),\n    diagnosticsIndex: 0,\n    diagnostics: [],\n    helpVisible: false\n  }\n\n  componentDidMount () {\n    document.addEventListener('keydown', this.handleKeyDown);\n\n    this.assemblerWorker = new Worker('worker.js');\n    if (this.assemblerWorker !== null) {\n      this.assemblerWorker.addEventListener('message', (msg: MessageEvent) => {\n        this.handleWorkerMessage(msg);\n      });\n    }\n\n    const urlParams = new URLSearchParams(window.location.search);\n    const gistId = urlParams.get('gist_id');\n    if (gistId !== null) {\n      this.loadGist(gistId);\n    }\n  }\n\n  setGistLoadingStatus = (loading: boolean) => {\n    this.setState(prevState => {\n      return {\n        gist: {\n          ...prevState.gist,\n          loading\n        }\n      }\n    });\n  }\n\n  loadGist = (gistId: string) => {\n    this.setGistLoadingStatus(true);\n    fetch(`https://api.github.com/gists/${gistId}`)\n      .then(resp => {\n        if (resp.status !== 200) {\n          throw new Error(`Gist load failed with HTTP status code ${resp.status}: ${resp.statusText}`);\n        }\n        return resp;\n      })\n      .then(resp => resp.json())\n      .then(json => {\n        this.setGistLoadingStatus(false);\n\n        // Stick gist_id into the current browser URL\n        setQueryStringParameter('gist_id', gistId);\n\n        this.setState(prevState => {\n          const files: SourceFile[] = [];\n          let selected = 0;\n          for (const file of Object.values(json.files) as any) {\n            files.push({\n              name: file.filename,\n              text: file.content,\n              cursorOffset: 0\n            })\n            if (file.filename === 'main.asm') {\n              selected = files.length-1;\n            }\n          }\n          files.push({ name: 'c64.asm', text: asmBuiltins.c64, cursorOffset: 0 });\n          return {\n            gist: {\n              ...prevState.gist,\n              gistId,\n              loadCount: prevState.gist.loadCount+1\n            },\n            sourceFiles: {\n              files,\n              selected\n            }\n          }\n        }, () => this.recompile());\n      })\n      .catch(err => {\n        console.log(err);\n        // TODO show error in GUI.  The below code just\n        // recovers enough to make the UI usable\n        this.setState(prevState => {\n          return {\n            gist: {\n              ...prevState.gist,\n              loading: false\n            }\n          }\n        });\n      });\n  }\n\n  getCurrentSource = () => {\n    return this.state.sourceFiles.files[this.state.sourceFiles.selected];\n  }\n\n  updateCurrentSource = (sourceFiles: SourceFiles, text: string, cursorOffset: number) => {\n    return {\n      ...sourceFiles,\n      files: sourceFiles.files.map((e, idx) => {\n        if (idx === sourceFiles.selected) {\n          return {\n            ...e,\n            text,\n            cursorOffset\n          }\n        }\n        return e;\n      })\n    }\n  }\n\n  handleWorkerMessage = (e: any) => {\n    if (e.data.diagnostics.length === 0) {\n      this.setState({\n        prg: e.data.prg,\n        disassembly: e.data.disassembly,\n        diagnostics: e.data.diagnostics,\n      });\n    } else {\n      this.setState({\n        diagnostics: e.data.diagnostics,\n      });\n    }\n  };\n\n  handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'F4') {\n      this.setState((prevState) => {\n        if (prevState.diagnostics.length === 0) {\n          return { diagnosticsIndex: 0 };\n        }\n        if (prevState.diagnosticsIndex === undefined) {\n          return { diagnosticsIndex: 0 };\n        }\n        if (e.shiftKey) {\n          return {\n            diagnosticsIndex: Math.max(0, prevState.diagnosticsIndex - 1)\n          }\n        } else {\n          return {\n            diagnosticsIndex: Math.min(prevState.diagnostics.length - 1, prevState.diagnosticsIndex + 1)\n          }\n        }\n      })\n      e.preventDefault();\n    }\n    if (e.key === 'Escape') {\n      // Clear focus from diagnostics list and\n      // exit help if it happens to be visible.\n      this.setState({\n        diagnosticsIndex: undefined,\n        helpVisible: false\n      });\n      e.preventDefault();\n    }\n  }\n\n  handleOnClickDiagnostic = (idx: number) => {\n    this.setState({\n      diagnosticsIndex: idx\n    })\n  }\n\n  debouncedCompile = debounce((asmArgs: any) => {\n    if (config.useWebWorkers && this.assemblerWorker) {\n      this.assemblerWorker.postMessage(asmArgs);\n    }\n  }, 250);\n\n  recompile = () => {\n    const sourceFileMap: {[ndx: string]: string} = {};\n    for (let source of this.state.sourceFiles.files) {\n      sourceFileMap[source.name] = source.text;\n    }\n    // TODO shouldn't recompile if only cursorOffset changed\n    if (config.useWebWorkers && this.assemblerWorker) {\n      this.debouncedCompile({ sourceFileMap });\n      this.setState({ diagnosticsIndex: undefined });\n    } else {\n      const options = {\n        readFileSync: (fname: string) => {\n          if (fname in sourceFileMap) {\n            return sourceFileMap[fname];\n          }\n          throw new Error(`File not found ${fname}`);\n        }\n      }\n      const res = assemble(\"main.asm\", options);\n      if (res.errors.length === 0) {\n        const disasmOptions = {\n          isInstruction: res.debugInfo.info().isInstruction\n        };\n        this.setState({\n          prg: res.prg,\n          disassembly: disassemble(res.prg, disasmOptions),\n          diagnostics: [],\n          diagnosticsIndex: undefined\n        });\n      } else {\n        this.setState({\n          diagnostics: res.errors,\n          diagnosticsIndex: undefined\n        });\n      }\n    }\n  }\n\n  handleSetSource = (text: string, cursorOffset: number) => {\n    this.setState(prevState => {\n      return {\n        sourceFiles: this.updateCurrentSource(prevState.sourceFiles, text, cursorOffset),\n      }\n    }, () => this.recompile());\n  }\n\n  // If typing in the editor, clear any diagnostics selection\n  handleClearDiagnosticsSelectionOnKey = (e: React.KeyboardEvent) => {\n    if (e.key === 'F4' || e.key === 'Shift') {\n      return;\n    }\n    if (this.state.diagnosticsIndex !== undefined) {\n      this.setState({ diagnosticsIndex: undefined });\n    }\n  }\n\n  // If typing in the editor, clear any diagnostics selection\n  handleClearDiagnosticsSelectionOnMouse = (e: React.MouseEvent) => {\n    if (this.state.diagnosticsIndex !== undefined) {\n      this.setState({ diagnosticsIndex: undefined });\n    }\n  }\n\n  handleClickHelp = (e: React.MouseEvent) => {\n    e.preventDefault();\n    this.setState({ helpVisible: true });\n  }\n\n  handleCloseHelp = () => {\n    this.setState({ helpVisible: false });\n  }\n\n  handleSourceTabSelected = (idx: number) => {\n    this.setState(prevState => {\n      return {\n        sourceFiles: {\n          ...prevState.sourceFiles,\n          selected: idx\n        }\n      }\n    });\n  }\n  render () {\n    const diags: Diag[] = this.state.diagnostics;\n    let editorErrorLoc = undefined;\n    if (diags.length !== 0 && this.state.diagnosticsIndex !== undefined) {\n      const d = diags[this.state.diagnosticsIndex];\n      editorErrorLoc = findCharOffset(this.getCurrentSource().text, d.loc);\n    }\n    return (\n      <div id='root'>\n        <nav id=\"mainNav\">\n          <div className={styles.navContainer}>\n            <div className={styles.appTitle}><a href='https://nurpax.github.io/c64jasm/'>c64jasm</a> online</div>\n            <p>A little experimental 6502 assembler for the C64</p>\n            <p><Emoji emoji='ðŸ‘‰' /> <a onClick={this.handleClickHelp} href='/' target='_blank'>help</a></p>\n            <p><Emoji emoji='ðŸ‘‰' /> <a href='https://github.com/nurpax/c64jasm-browser'>source code</a></p>\n          </div>\n        </nav>\n        <div\n          onKeyDown={this.handleClearDiagnosticsSelectionOnKey}\n          onMouseDown={this.handleClearDiagnosticsSelectionOnMouse}\n          onMouseUp={this.handleClearDiagnosticsSelectionOnMouse}\n          id=\"mainCode\"\n        >\n          <Editor // Note: key is reset for name and counter to force update editor on tab switches or gist loads\n            key={`${this.state.gist.id}/${this.state.gist.loadCount}/${this.getCurrentSource().name}`}\n            defaultValue={this.getCurrentSource().text}\n            defaultCursorOffset={this.getCurrentSource().cursorOffset}\n            onSourceChanged={this.handleSetSource}\n            diagnostics={this.state.diagnostics}\n            errorCharOffset={editorErrorLoc}\n          />\n        </div>\n        <div id=\"siteDisasm\">\n          <Disasm disassembly={this.state.disassembly} prg={this.state.prg} />\n        </div>\n        <div id=\"mainSourceTabs\">\n          <SourceTabs\n            setSelected={this.handleSourceTabSelected}\n            selected={this.state.sourceFiles.selected}\n            files={this.state.sourceFiles.files}\n            onLoadGist={this.loadGist}\n            loadingGist={this.state.gist.loading}\n          />\n        </div>\n        <div id=\"mainDiag\">\n          <DiagnosticsList\n            onClickItem={this.handleOnClickDiagnostic}\n            diagnostics={this.state.diagnostics}\n            selectedIndex={this.state.diagnosticsIndex} />\n        </div>\n        <Help visible={this.state.helpVisible} onClose={this.handleCloseHelp} />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","\nimport React, { Fragment } from 'react';\nimport indentTextarea from 'indent-textarea';\nimport cn from 'classnames';\n\nimport { findLine } from './editing';\nimport { SourceLoc } from 'c64jasm';\nimport styles from './Editor.module.css';\n\nconst tabLength = 4;\n\n// RLE compress a list of T's\nfunction groupSame<T>(values: T[]): { count: number, code: T }[] {\n  let cur = undefined;\n  let out = [];\n\n  for (let v of values) {\n      // Start new run\n      if (cur !== v) {\n          cur = v;\n          out.push({code: cur, count: 1});\n      } else {\n          // Keep growing current group\n          out[out.length-1].count++;\n      }\n  }\n  return out;\n}\n\n// Count the actual screen char column offset\n// based on a character index and the source code\n// line contents.\nfunction computeColumn(line: string, charIndex: number) {\n  let col = 0;\n  for (let i = 0; i < charIndex; i++) {\n    if (line.length < i) {\n      return undefined;\n    }\n    if (line[i] === '\\t') {\n      col += tabLength;\n    } else {\n      col++;\n    }\n  }\n  return col;\n}\n\n// This function can return null if it can't find the diagnostic\n// column from the source code.  This can happen if the\n// diagnostics are matched on a different version of diagnostics\n// vs. source code.  This can happen as the compiler\n// runs in a separate thread while text editing happens\n// in the main thread without syncing to compiler\n// results.\nfunction ErrorSpans(props: {\n  text: string,\n  errors: SourceLoc[]\n}) {\n  let lineLength = 0;\n  if (!props.text) {\n    return null;\n  }\n  for (let c of props.text) {\n    if (c === '\\t') {\n      lineLength += tabLength;\n    } else {\n      lineLength++;\n    }\n  }\n  const buf: boolean[] = Array(lineLength).fill(false);\n\n  for (const err of props.errors) {\n    const start = computeColumn(props.text, err.start.column - 1);\n    if (start === undefined) {\n      return null;\n    }\n    const end = err.start.line === err.end.line ? computeColumn(props.text, err.end.column - 1) : start + 1;\n    if (end === undefined) {\n      return null;\n    }\n    for (let x = start; x < end; x++) {\n      buf[x] = true;\n    }\n  }\n  const rled = groupSame(buf);\n  const spans = [];\n  for (let i = 0; i < rled.length; i++) {\n    const span = rled[i];\n    if (!span.code) {\n      spans.push(<pre key={i} style={{display: 'inline-block'}}>{' '.repeat(span.count)}</pre>);\n    } else {\n      spans.push(<pre key={i} style={{display: 'inline-block'}} className={styles.highlightError}>{' '.repeat(span.count)}</pre>);\n    }\n  }\n  return <Fragment>{spans}</Fragment>;\n}\n\ninterface HighlighterProps {\n  startRow: number;\n  numRows: number;\n  currentLine: number | undefined;\n  textLines: string[];\n  lineToErrors: Map<number, SourceLoc[]>;\n}\n\nconst Highlighter = React.forwardRef((props: HighlighterProps, ref: React.Ref<HTMLDivElement>) => {\n  const rows = [];\n  // Pad rows is required for smooth scrolling (so that there is overflow-y to scroll)\n  const padRows = 2;\n  for (let i = props.startRow; i < props.startRow + props.numRows + padRows; i++) {\n    const selected = i === props.currentLine && styles.textareaHighlightRowCurrent;\n    const errors = props.lineToErrors.get(i);\n    if (errors) {\n      const text = props.textLines[i];\n      rows.push(<div className={cn(styles.textareaHighlightRow, selected)} key={i}><ErrorSpans text={text} errors={errors} /></div>);\n    } else {\n      rows.push(<div className={cn(styles.textareaHighlightRow, selected)} key={i}></div>);\n    }\n  }\n  return (\n    <div ref={ref} className={styles.textareaHighlightOverlay}>\n      {rows}\n    </div>\n  );\n})\n\ninterface GutterProps {\n  startRow: number;\n  numRows: number;\n  numTextRows: number;\n  currentLine: number | undefined;\n}\n\nconst Gutter = React.forwardRef((props: GutterProps, ref: React.Ref<HTMLDivElement>) => {\n  const rows = [];\n  const padRows = 2;\n  for (let i = props.startRow; i < props.startRow + props.numRows + padRows; i++) {\n    const str = `${i+1}`;\n    const selected = i === props.currentLine && styles.gutterRowSelected;\n    const numStr = (i >= 0 && i < props.numTextRows) ? str.padStart(4, ' ') : '';\n    rows.push(<div className={cn(styles.gutterRow, selected)} key={i}>{numStr}</div>);\n  }\n  return (\n    <div ref={ref} className={styles.gutter}>\n      {rows}\n    </div>\n  );\n});\n\ninterface EditorProps {\n  defaultValue: string;\n  defaultCursorOffset: number;\n  onSourceChanged: (text: string, cursorOffset: number) => void;\n  diagnostics: { loc: SourceLoc, msg: string }[];\n  errorCharOffset: number | undefined;\n}\n\ninterface EditorState {\n  scrollTop: number;\n  currentLine: number | undefined;\n  textLines: string[];\n}\n\nexport default class extends React.Component<EditorProps, EditorState> {\n\n  private editorLineHeight = 0;\n  private numEditorCharRows = 0;\n\n  constructor (props: EditorProps) {\n    super(props);\n\n    this.state = {\n      scrollTop: 0,\n      currentLine: 0,\n      textLines: this.props.defaultValue.split('\\n')\n    }\n\n    const cssVarLineHeight = getComputedStyle(document.documentElement).getPropertyValue('--code-window-line-height');\n    let match = /^[ ]*(?<height>[0-9]+)px$/.exec(cssVarLineHeight);\n    if (!match) {\n      throw new Error('failed querying css var --code-window-line-height' + cssVarLineHeight);\n    }\n    this.editorLineHeight = parseInt((match as any).groups.height);\n    const cssNumLines = getComputedStyle(document.documentElement).getPropertyValue('--code-window-num-lines');\n    match = /^[ ]*(?<lines>[0-9]+)$/.exec(cssNumLines);\n    if (!match) {\n      throw new Error('failed querying css var --code-window-num-lines');\n    }\n    this.numEditorCharRows = parseInt((match as any).groups.lines);\n  }\n\n  textareaRef = React.createRef<HTMLTextAreaElement>();\n  gutterRef = React.createRef<HTMLDivElement>();\n  highlighterRef = React.createRef<HTMLDivElement>();\n\n  handleScroll = (e: React.UIEvent<HTMLTextAreaElement>) => {\n    const { scrollTop } = e.nativeEvent.target as any;\n    this.setState({ scrollTop })\n  }\n\n  handleSourceChanged = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    let cursorOffset = 0;\n    if (this.textareaRef && this.textareaRef.current) {\n      cursorOffset = this.textareaRef.current.selectionStart;\n    }\n    this.props.onSourceChanged(e.target.value, cursorOffset);\n    this.setState({\n      textLines: e.target.value.split('\\n')\n    })\n  }\n\n  updateCursorState = () => {\n    if (this.textareaRef && this.textareaRef.current) {\n      const r = this.textareaRef.current;\n      if (r.selectionStart === r.selectionEnd) {\n        const loc = r.selectionStart;\n        const line = findLine(this.textareaRef.current.value, loc);\n        this.setState({ currentLine: line });\n      } else {\n        this.setState({ currentLine: undefined });\n      }\n      this.props.onSourceChanged(r.value, r.selectionStart);\n    }\n  }\n\n  // Update cursor position when keys are pressed or selection changes on mouse click\n  handleSelect = (e: React.SyntheticEvent<HTMLTextAreaElement>) => {\n    this.updateCursorState();\n  }\n  handleKeyDown = (e: React.KeyboardEvent) => {\n    this.updateCursorState();\n  }\n  handleKeyUp = (e: React.KeyboardEvent) => {\n    this.updateCursorState();\n  }\n\n  componentDidMount () {\n    if (this.textareaRef && this.textareaRef.current) {\n      indentTextarea.watch(this.textareaRef.current);\n      this.textareaRef.current.spellcheck = false;\n      this.textareaRef.current.selectionStart = this.props.defaultCursorOffset;\n      this.textareaRef.current.selectionEnd = this.props.defaultCursorOffset;\n      this.textareaRef.current.focus();\n    }\n  }\n\n  componentDidUpdate (prevProps: EditorProps, prevState: EditorState) {\n    if (this.textareaRef && this.textareaRef.current) {\n      if (this.props.errorCharOffset !== undefined) {\n        this.textareaRef.current.focus();\n        this.textareaRef.current.setSelectionRange(this.props.errorCharOffset, this.props.errorCharOffset);\n      }\n    }\n\n    if (prevState.scrollTop !== this.state.scrollTop) {\n      const scrollTop = this.state.scrollTop;\n      const vscroll = scrollTop % this.editorLineHeight;\n      if (this.gutterRef && this.gutterRef.current) {\n        this.gutterRef.current.scrollTop = vscroll;\n      }\n      if (this.highlighterRef && this.highlighterRef.current) {\n        this.highlighterRef.current.scrollTop = vscroll;\n      }\n    }\n  }\n\n  handleMouseDown = (e: React.MouseEvent) => {\n    if (this.textareaRef && this.textareaRef.current) {\n      const yoffs = e.nativeEvent.offsetY + this.state.scrollTop;\n      this.setState({\n        currentLine: Math.min(this.state.textLines.length - 1, Math.floor(yoffs / this.editorLineHeight))\n      });\n    }\n  }\n\n  render () {\n    const lineToErrorsMap = new Map<number, SourceLoc[]>();\n    this.props.diagnostics.forEach(({loc}) => {\n      const line = loc.start.line - 1;\n      const lst = lineToErrorsMap.has(line) ? lineToErrorsMap.get(line)! : [];\n      lst.push(loc);\n      lineToErrorsMap.set(line, lst);\n    })\n    const startCharRow = Math.floor(this.state.scrollTop / this.editorLineHeight);\n    return (\n      <div className={styles.layoutContainer}>\n        <div className={styles.heading}>Assembly</div>\n        <div className={styles.editorContainer}>\n          <Gutter\n            ref={this.gutterRef}\n            startRow={startCharRow}\n            numRows={this.numEditorCharRows}\n            numTextRows={this.state.textLines.length}\n            currentLine={this.state.currentLine}\n          />\n          <div className={styles.textContainer} onMouseDown={this.handleMouseDown}>\n            <Highlighter\n              ref={this.highlighterRef}\n              startRow={startCharRow}\n              numRows={this.numEditorCharRows}\n              currentLine={this.state.currentLine}\n              textLines={this.state.textLines}\n              lineToErrors={lineToErrorsMap}\n            />\n            <textarea\n              defaultValue={this.props.defaultValue}\n              wrap='off'\n              onKeyUp={this.handleKeyUp}\n              onKeyDown={this.handleKeyDown}\n              onSelect={this.handleSelect}\n              onScroll={this.handleScroll}\n              ref={this.textareaRef}\n              onChange={this.handleSourceChanged} className={styles.textarea}></textarea>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","\nimport React from 'react';\nimport FileSaver from 'file-saver';\nimport styles from './Disasm.module.css';\n\nfunction DownloadButton(props: { onClick: (e: React.MouseEvent) => void}) {\n  return (\n    <div>\n      <a\n        onClick={props.onClick}\n        className={styles.downloadButton}\n        href='/' target='_blank'>\n          Download .PRG\n      </a>\n    </div>\n  )\n}\ninterface DisasmProps {\n  disassembly: string[];\n  prg: Buffer;\n}\n\nexport default class extends React.Component<DisasmProps> {\n  handleDownloadPRG = (e: React.MouseEvent) => {\n    e.preventDefault();\n    const blob = new Blob([this.props.prg]);\n    FileSaver.saveAs(blob, \"c64jasm-online.prg\");\n  }\n\n  render () {\n    return (\n      <div className={styles.layoutContainer}>\n        <div className={styles.heading}>\n          <div>Disassembly</div>\n          <DownloadButton onClick={this.handleDownloadPRG} />\n        </div>\n        <div className={styles.disasmContainer}>\n            <pre>{this.props.disassembly.join('\\n')}</pre>\n        </div>\n      </div>\n    )\n  }\n}\n","\nimport React from 'react'\n\nimport { SourceLoc } from 'c64jasm';\n\nimport { Diag } from './types'\n\nimport styles from './DiagnosticsList.module.css'\n\ninterface DiagnosticProps {\n  error: { loc: SourceLoc, msg: string };\n  index: number;\n  selected: boolean;\n  onClickItem: (idx: number) => void;\n}\n\nclass Diagnostic extends React.Component<DiagnosticProps> {\n  itemRef = React.createRef<HTMLDivElement>();\n\n  componentDidUpdate (prevProps: DiagnosticProps, prevState: {}, snapshot: DiagnosticProps) {\n    if (this.itemRef && this.itemRef.current && this.props.selected) {\n      this.itemRef.current.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center'\n      })\n    }\n  }\n\n  render() {\n    const { loc, msg } = this.props.error;\n    const selectedClass = this.props.selected ? ` ${styles.selected}` : '';\n    return (\n      <div\n        ref={this.itemRef}\n        className={`${styles.diagItem}${selectedClass}`}\n        onClick={() => this.props.onClickItem(this.props.index)}\n      >\n        <span className={`${styles.error}${selectedClass}`}>main.asm:{loc.start.line}:{loc.start.column}: error:</span> {msg}\n      </div>\n    )\n  }\n}\n\ninterface DiagnosticsListProps {\n  diagnostics: Diag[];\n  selectedIndex: number | undefined;\n  onClickItem: (idx: number) => void;\n}\n\nexport default class DiagnosticsList extends React.Component<DiagnosticsListProps> {\n  handleOnClickItem = (idx: number) => {\n    this.props.onClickItem(idx);\n  }\n\n  render() {\n    const diags = this.props.diagnostics;\n    return (\n      <div className={styles.layoutContainer}>\n        <div className={styles.heading}>Diagnostics</div>\n        <div className={styles.diagnostics}>\n          <div className={styles.diagnosticsBox}>\n            {diags.map((d: Diag, idx) => {\n              return (\n                <Diagnostic\n                  key={JSON.stringify(d.loc)}\n                  index={idx}\n                  error={d} selected={idx === this.props.selectedIndex}\n                  onClickItem={this.handleOnClickItem}\n                />\n              )\n            })}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}","\nimport React from 'react';\nimport styles from './SourceTabs.module.css';\nimport cn from 'classnames';\n\nimport { SourceFile } from './types';\n\ninterface LoadGistInputProps {\n  onCancel: () => void;\n  onSubmit: (gistId: string) => void;\n}\n\nclass LoadGistInput extends React.Component<LoadGistInputProps, { gistIdOrUrl: string }> {\n\n  state = {\n    gistIdOrUrl: ''\n  }\n\n  handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    // Either grab ID from a URL like:\n    //\n    // https://gist.github.com/nurpax/58a3a6105946bb64346fad7428ec86b4\n    //\n    // or if the user just provided the ID directly, use that.\n    const parts = this.state.gistIdOrUrl.split('/');\n    if (parts.length > 0) {\n      this.props.onSubmit(parts[parts.length-1]);\n    }\n  }\n\n  handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    this.setState({ gistIdOrUrl: e.target.value });\n  }\n\n  handlePreventBlur = (e: React.MouseEvent) => {\n    e.preventDefault();\n  }\n\n  render () {\n    return (\n      <form\n        onSubmit={this.handleSubmit}\n        onBlur={() => this.props.onCancel()}\n        className={styles.gistInputContainer}>\n        <input\n          placeholder='Gist ID or URL'\n          onChange={this.handleInputChange}\n          value={this.state.gistIdOrUrl}\n          onKeyDown={(e: React.KeyboardEvent) => {\n            if (e.key === 'Escape') {\n              this.props.onCancel();\n            }\n          }}\n          autoFocus\n          spellCheck={false}\n          type='text'\n        />\n        <button onMouseDown={this.handlePreventBlur} type='submit'>Go!</button>\n      </form>\n    )\n  }\n}\n\ninterface LoadGistProps {\n  loadingGist: boolean;\n  onLoadGist: (gistId: string) => void;\n}\n\ninterface LoadGistState {\n  editing: boolean;\n}\n\nclass LoadGist extends React.Component<LoadGistProps, LoadGistState> {\n  state = {\n    editing: false\n  }\n\n  handleOpenLoadInput = () => {\n    this.setState(prevState => {\n      return { editing: !prevState.editing };\n    });\n  }\n  render () {\n    if (this.props.loadingGist) {\n      return (\n        <div className={styles.gistContainer}>\n          <div className={styles.loadingText}>\n            Loading gist..\n          </div>\n        </div>\n      );\n    }\n    return (\n      <div className={styles.gistContainer}>\n        {this.state.editing &&\n          <LoadGistInput\n            onCancel={() => this.setState({ editing: false })}\n            onSubmit={(gistId) => {\n              this.setState({ editing: false });\n              this.props.onLoadGist(gistId);\n            }}\n          />\n        }\n        {!this.state.editing &&\n          <div className={styles.gistLoadButtonContainer}>\n            <button\n              onClick={this.handleOpenLoadInput}\n              title='Load source files from a GitHub public Gist'\n            >\n              Load Gist\n            </button>\n          </div>\n        }\n      </div>\n    );\n  }\n}\n\ninterface SourceTabsProps {\n  setSelected: (idx: number) => void;\n  selected: number;\n  files: SourceFile[];\n\n  loadingGist: boolean;\n  onLoadGist: (gistId: string) => void;\n}\n\nexport default class extends React.Component<SourceTabsProps> {\n  handleTabClick = (e: React.MouseEvent, idx: number) => {\n    this.props.setSelected(idx);\n  }\n  render () {\n    const tabs = this.props.files.map(({name}, idx: number) => {\n      return (\n        <div\n          key={name}\n          className={cn(styles.tab, idx === this.props.selected ? styles.active : '')}\n          onClick={e => this.handleTabClick(e, idx)}\n        >\n          {name}\n        </div>\n      );\n    })\n    return (\n      <div className={styles.container}>\n        <div className={styles.tabContainer}>\n          {tabs}\n        </div>\n        <LoadGist\n          onLoadGist={this.props.onLoadGist}\n          loadingGist={this.props.loadingGist}\n        />\n      </div>\n    )\n  }\n}\n","import React from 'react';\n\nimport styles from './CloseButton.module.css';\n\nexport default function CloseButton(props: { onClose: () => void}) {\n  return (\n    <div className={styles.buttonContainer}>\n      <a title='Close Help' href='/' target='_blank' className={styles.close} onClick={e => {\n          e.preventDefault();\n          props.onClose();\n        }}>\n      </a>\n    </div>\n  );\n}\n\n","import React, { Fragment } from 'react';\nimport ReactDOM from 'react-dom';\nimport cn from 'classnames';\n\nimport CloseButton from './CloseButton'\nimport styles from './Help.module.css';\nimport * as asmBuiltins from './asmBuiltins';\n\nconst modalRoot = document.getElementById('modal-root')!;\n\ninterface ModalProps {\n  children: JSX.Element;\n}\n\nclass Modal extends React.Component {\n  private el: HTMLDivElement;\n\n  constructor(props: ModalProps) {\n    super(props);\n    this.el = document.createElement('div');\n  }\n\n  componentDidMount() {\n    // The portal element is inserted in the DOM tree after\n    // the Modal's children are mounted, meaning that children\n    // will be mounted on a detached DOM node. If a child\n    // component requires to be attached to the DOM tree\n    // immediately when mounted, for example to measure a\n    // DOM node, or uses 'autoFocus' in a descendant, add\n    // state to Modal and only render the children when Modal\n    // is inserted in the DOM tree.\n    modalRoot.appendChild(this.el);\n  }\n\n  componentWillUnmount() {\n    modalRoot.removeChild(this.el);\n  }\n\n  render() {\n    return ReactDOM.createPortal(\n      this.props.children,\n      this.el,\n    );\n  }\n}\n\n// Remove leading and trailing line feeds from a string.\n// This is to prevent unnecessary line feeds in\n// assembly code written in string literals.\nfunction trimLineFeeds(str: string): string {\n  const lines = str.split('\\n');\n  let s;\n  for (s = 0; s < lines.length; s++) {\n    const line = lines[s].trim();\n    if (line.length !== 0) {\n      break;\n    }\n  }\n  let e;\n  for (e = lines.length - 1; e >= 0; e--) {\n    const line = lines[e].trim();\n    if (line.length !== 0) {\n      break;\n    }\n  }\n  return lines.slice(s, e + 1).join('\\n');\n}\n\nfunction AsmBlock(props: { text: string }) {\n  return (\n    <pre className={styles.asm}>{trimLineFeeds(props.text)}</pre>\n  )\n}\nclass HelpContents extends React.Component<{onClose: () => void}> {\n  render () {\n      const GistLink = (props: {id: string, text: string}) => {\n        return (\n          <Fragment>\n            <a href={`${process.env.PUBLIC_URL}/?gist_id=${props.id}`}>{props.text}</a>\n            &nbsp;(<a href={`https://gist.github.com/nurpax/${props.id}`}>view on GitHub</a>)\n          </Fragment>\n        )\n      }\n      return (\n      <div className={cn(styles.helpContents, styles.maxWidth)}>\n        <div className={styles.headingContainer}>\n          <div className={styles.closeButtonContainer}>\n            <CloseButton onClose={this.props.onClose} />\n          </div>\n          <h1>c64jasm online </h1>\n        </div>\n        <p>\n          <a href='https://nurpax.github.io/c64jasm/'>c64jasm</a> is a 6502 assembler written in JavaScript.\n          You can run it either on the command line using Node or link it into a web app.\n        </p>\n        <p>\n          <a href='https://nurpax.github.io/c64jasm-browser/'>c64jasm online</a> is an interactive assembler demo site\n          where you can write 6502 assembly with live error reporting and disassembly.\n        </p>\n\n        <p>Developed by Janne Hellsten, contact me through <a href='https://twitter.com/nurpax'>@nurpax</a></p>\n\n        <h3>Example projects</h3>\n\n        <p>C64jasm online supports loading source files from GitHub gists.\n          Here's a list of example projects (click on the links to load):\n        </p>\n        <ul>\n          <li><GistLink id='4996160f290fa1b9470520d7be0ca25e' text='Sine sprites' /></li>\n        </ul>\n\n        <h3>Examples</h3>\n\n        <p>Simple instructions and expressions:</p>\n        <AsmBlock text={`\n    lda #2+2  ; expression in an immediate field\n    sta $d020 ; set border color\n        `} />\n\n        <p>Labels:</p>\n        <AsmBlock text={`\nentry: {\n    jsr func\n\n    ldx #8\nloop: ; label local to 'entry' scope\n    dex\n    bpl loop\n}\n\nfunc: {\n    ldx #7\nloop: ; label local to 'func' scope\n    sta buf, x   ; store to buf\n    dex\n    bpl loop\n    rts\n\nbuf: !fill 8, 0    ; 8 byte array\n}\n        `} />\n\n        <p>Declaring and using variables:</p>\n        <AsmBlock text={`\n!let num_sprites = 4\n!let sprite_mask = (1<<num_sprites)-1\n\n    lda #sprite_mask\n    sta $d015 ; enable sprites 0-3\n        `} />\n\n        <p>Conditional compilation and repetition:</p>\n        <AsmBlock text={`\n!let num_sprites = 4\n    lda #13  ; ptr to sprite data 1 (==address/64)\n    ldx #14  ; ptr to sprite data 2\n\n!for i in range(num_sprites) {\n    !if (i < 2) {\n        sta $07f8+i   ; sprite data 1 from A\n    } else {\n        stx $07f8+i   ; sprite data 2 from X\n    }\n}\n        `} />\n\n        <p>Define and use macro macro:</p>\n        <AsmBlock text={`\n!macro set_border(color) {\n    lda #color\n    sta $d020\n}\n\n+set_border(13)  ; expand\n        `} />\n\n        <p>A complete C64 program.  To compile a C64 <code>.prg</code> you need\n        to insert a BASIC startup sequence at the beginning of your output <code>.prg</code> --\n        you can use the <code>c64::basic_entry</code> macro to do this.\n        The source code to these macros is shown in a later section.\n        </p>\n\n        <AsmBlock text={`\n!include \"c64.asm\"\n\n+c64::basic_start(entry)\n\nentry: {\n    lda #0\n}\n        `} />\n\n        <h3>Built-in support macros</h3>\n\n        <p>The c64jasm online site includes a small built in macro library.  You can find its source code below.</p>\n\n        <p>The builtin <code>c64.asm</code> contents:</p>\n        <AsmBlock text={asmBuiltins.c64} />\n\n      </div>\n    )\n  }\n}\n\ninterface HelpProps {\n  visible: boolean;\n  onClose: () => void;\n}\n\nclass HelpModal extends React.Component<HelpProps> {\n  render () {\n    const { visible } = this.props;\n    return (\n      <Modal>\n        <div className={cn(visible ? styles.helpModalContainer : styles.hidden)}>\n          <div className={styles.circleReveal}>\n            <HelpContents onClose={this.props.onClose}/>\n          </div>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default HelpModal;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('viewport_root'));\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 64;"],"sourceRoot":""}